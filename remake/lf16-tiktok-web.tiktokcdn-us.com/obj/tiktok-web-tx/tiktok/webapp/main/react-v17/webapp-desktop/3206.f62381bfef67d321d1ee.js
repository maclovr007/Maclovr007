"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[3206],{66458:(n,e,t)=>{t.d(e,{JE:()=>o,K:()=>l});var a=t(31209);const i=(0,t(43723).p)("captionInfoAtom@tiktok/webapp-atoms",{isCaptionModalOn:!1,currentCaption:"",captionModalEnterMethod:"click_cc_indicator"}),{useAtomService:o,useServiceState:s,useServiceDispatchers:l,getStaticApi:r}=(0,a.i)(i,((n,e)=>({setIsCaptionModalOn(n){e(i,(e=>Object.assign(Object.assign({},e),{isCaptionModalOn:n})))},setCurrentCaption(n){e(i,(e=>Object.assign(Object.assign({},e),{currentCaption:n})))},setCaptionModalEnterMethod(n){e(i,(e=>Object.assign(Object.assign({},e),{captionModalEnterMethod:n})))},setCaptionModalRoot(n){e(i,(e=>Object.assign(Object.assign({},e),{captionModalRoot:n})))}})))},49568:(n,e,t)=>{t.d(e,{PU:()=>a,ku:()=>r,u8:()=>d});var a,i=t(31209),o=t(43723);!function(n){n.Notice="notice",n.Error="error",n.CTA="cta"}(a||(a={}));const s=(0,o.p)("toastAtom@tiktok/webapp-atoms",{});let l=0;const{useAtomService:r,useServiceDispatchers:c,useServiceState:u,getStaticApi:d}=(0,i.i)(s,((n,e)=>({addToast(n){const t=`${Number(new Date).toString(36)}_${l++}`;e(s,(e=>Object.assign(Object.assign({},e),{[t]:Object.assign({id:t},n)})))},removeToast(...t){const a=n(s);t.forEach((n=>{n in a&&delete a[n]})),e(s,a)}})))},67416:(n,e,t)=>{t.d(e,{l:()=>s});var a=t(60484),i=t(60072),o=t(92502);const s=n=>{var e;const t=(0,i.F3)((e=>e[n])),{video:s}=(0,a.L$)(t),{claInfo:l}=(0,a.L$)(s),{selectedTranslationLanguage:r,translationDisableLanguages:c,isForeignCaptionOn:u,isNativeCaptionOn:d,isCaptionOn:g}=(null===(e=null==l?void 0:l.originalLanguageInfo)||void 0===e||e.languageCode,(0,o.RD)());return g}},92502:(n,e,t)=>{t.d(e,{$F:()=>_,RD:()=>L});var a=t(31209),i=t(43723),o=t(57431),s=t(58305);t(60484);const l="enableMasterTranslation",r="selectedTranslationLanguage",c="translationDisableLanguages",u="enableCaption";var d=t(90535),g=t(71281),v=function(n,e,t,a){return new(t||(t=Promise))((function(i,o){function s(n){try{r(a.next(n))}catch(n){o(n)}}function l(n){try{r(a.throw(n))}catch(n){o(n)}}function r(n){var e;n.done?i(n.value):(e=n.value,e instanceof t?e:new t((function(n){n(e)}))).then(s,l)}r((a=a.apply(n,e||[])).next())}))};const p=n=>v(void 0,void 0,void 0,(function*(){var e,t;return(null!==(t=null===(e=(yield(0,d.h)()).claConfig)||void 0===e?void 0:e.isoToSubtitleLanguageCode)&&void 0!==t?t:{})[n]||n}));t(46747),t(60072);var b=t(49568),f=function(n,e,t,a){return new(t||(t=Promise))((function(i,o){function s(n){try{r(a.next(n))}catch(n){o(n)}}function l(n){try{r(a.throw(n))}catch(n){o(n)}}function r(n){var e;n.done?i(n.value):(e=n.value,e instanceof t?e:new t((function(n){n(e)}))).then(s,l)}r((a=a.apply(n,e||[])).next())}))};const h=(0,i.p)("languageAtom@tiktok/webapp-atoms",{isMasterTranslationOn:!1,isForeignCaptionOn:!1,isNativeCaptionOn:!1,isCaptionOn:!1,selectedTranslationLanguage:"",translationDisableLanguages:[],enableMasterTranslation:0,enableForeignCaption:0,enableNativeCaption:0,isReady:!1}),{useAtomService:_,useServiceState:L,useServiceDispatchers:O,getStaticApi:T}=(0,a.i)(h,((n,e)=>({setLanguageSetting(n){return f(this,void 0,void 0,(function*(){const{user:n}=(0,o.x)();let t;t=yield function(){var n;return v(this,void 0,void 0,(function*(){const e=null!==(n=(0,g.d)("enable_post_translation"))&&void 0!==n?n:"v0",t="v1"===e||"v3"===e&&"1"===(0,s._S)(u,"0"),a=1..toString(),i="1"===(0,s._S)(u,"0"),p=(0,s._S)(l,t?a:"")===a;let b=[],f=(()=>{const{language:n}=(0,o.x)();let e=n;return"zh-Hant-TW"===n?e="zh-Hant":"zh-Hans"!==n&&(e=n.split("-")[0]),e})();try{b=JSON.parse((0,s._S)(c,"[]")),f=yield(h=JSON.parse((0,s._S)(r,"")),v(void 0,void 0,void 0,(function*(){var n,e;return(null!==(e=null===(n=(yield(0,d.h)()).claConfig)||void 0===n?void 0:n.subtitleToIsoLanguageCode)&&void 0!==e?e:{})[h]||h})))}catch(n){}var h;return{isCaptionOn:i,isMasterTranslationOn:p,selectedTranslationLanguage:f,translationDisableLanguages:b}}))}(),e(h,(n=>Object.assign(Object.assign(Object.assign({},n),t),{isReady:!0})))}))},setSelectedTranslationLanguage(t){return f(this,void 0,void 0,(function*(){const a=n(h),i=yield p(t);e(h,(n=>Object.assign(Object.assign({},n),{selectedTranslationLanguage:t}))),yield this.updateLanguageSettings(r,i,a)}))},setTranslationDisableLanguages(t){return f(this,void 0,void 0,(function*(){const a=n(h);e(h,(n=>Object.assign(Object.assign({},n),{translationDisableLanguages:t}))),yield this.updateLanguageSettings(c,t,a)}))},setIsMasterTranslationOn(t){return f(this,void 0,void 0,(function*(){const a=n(h),i=t?1:3;e(h,(n=>Object.assign(Object.assign({},n),{isMasterTranslationOn:t,enableMasterTranslation:i}))),yield this.updateLanguageSettings(l,i,a)}))},setIsCaptionOn(n,t){return f(this,void 0,void 0,(function*(){return(0,s.AP)(u,n?"1":"0"),void e(h,(e=>Object.assign(Object.assign({},e),{isCaptionOn:n})))}))},updateLanguageSettings(e,t,a){return f(this,void 0,void 0,(function*(){const{user:a}=(0,o.x)(),{enableForeignCaption:i,enableMasterTranslation:l,enableNativeCaption:r,selectedTranslationLanguage:c,translationDisableLanguages:u}=n(h);yield p(c),(0,b.u8)(),(0,s.AP)(e,JSON.stringify(t))}))}})))},46747:(n,e,t)=>{t.d(e,{Dq:()=>c,Ze:()=>s,ph:()=>r,zB:()=>l});var a=t(56070),i=t(26325),o=function(n,e,t,a){return new(t||(t=Promise))((function(i,o){function s(n){try{r(a.next(n))}catch(n){o(n)}}function l(n){try{r(a.throw(n))}catch(n){o(n)}}function r(n){var e;n.done?i(n.value):(e=n.value,e instanceof t?e:new t((function(n){n(e)}))).then(s,l)}r((a=a.apply(n,e||[])).next())}))};const s=n=>o(void 0,void 0,void 0,(function*(){return a.h.get("/tiktok/cla/subtitle_translation/get/v1/",{query:n,baseUrlType:2})})),l=n=>o(void 0,void 0,void 0,(function*(){return a.h.get("/aweme/v1/translation/description/",{query:n,baseUrlType:2})})),r=n=>o(void 0,void 0,void 0,(function*(){return a.h.get("/aweme/v1/translation/title/",{query:n,baseUrlType:2})})),c=n=>{const{languageSettings:e,secUid:t}=n;return a.h.post("/api/user/settings/update/",{query:{languageSettings:JSON.stringify(e),secUid:t},tt_csrf_token:a.h.csrfToken,baseUrlType:2,headers:{[i.nk]:a.h.csrfToken}})}},11072:(n,e,t)=>{t.d(e,{M:()=>O,Oh:()=>T,RA:()=>C,Vk:()=>_,ik:()=>L,sX:()=>S,xJ:()=>f,xL:()=>h,xr:()=>p});var a=t(31209),i=t(32125),o=t(43723),s=t(46747),l=t(60484),r=t(60072),c=t(92502),u=function(n,e,t,a){return new(t||(t=Promise))((function(i,o){function s(n){try{r(a.next(n))}catch(n){o(n)}}function l(n){try{r(a.throw(n))}catch(n){o(n)}}function r(n){var e;n.done?i(n.value):(e=n.value,e instanceof t?e:new t((function(n){n(e)}))).then(s,l)}r((a=a.apply(n,e||[])).next())}))};const d=(0,o.p)("translationAtom@tiktok/webapp-atoms",{}),{useAtomService:g,useServiceState:v,useServiceDispatchers:p,getStaticApi:b}=(0,a.i)(d,((n,e)=>({getSubtitleTranslation(n){return u(this,void 0,void 0,(function*(){const{target_language:t,item_id:a}=n;try{const i=yield(0,s.Ze)(n);0===i.status_code&&e(d,(n=>Object.assign(Object.assign({},n),{[a]:Object.assign(Object.assign({},n[a]),{subtitle:{stringContent:i.webvtt_subtitle,language:t,id:"999"}})})))}catch(n){}}))},getDescriptionTranslation(n){return u(this,void 0,void 0,(function*(){const{item_id:t}=n;if(t)try{const a=yield(0,s.zB)(n);0===a.status_code&&e(d,(n=>Object.assign(Object.assign({},n),{[t]:Object.assign(Object.assign({},n[t]),{description:a.translated_content})})))}catch(n){}}))},getPhotoTitleTranslation(n){return u(this,void 0,void 0,(function*(){const{item_id:t}=n;if(t)try{const a=yield(0,s.ph)(n);0===a.status_code&&e(d,(n=>Object.assign(Object.assign({},n),{[t]:Object.assign(Object.assign({},n[t]),{title:a.translated_content})})))}catch(n){}}))},setShowTranslation(n,t){e(d,(e=>Object.assign(Object.assign({},e),{[n]:Object.assign(Object.assign({},e[n]),{showTranslation:t})})))}}))),f=n=>v((e=>{var t;return null===(t=e[n])||void 0===t?void 0:t.subtitle})),h=n=>{const e=(0,r.F3)((e=>e[n])),{video:t}=(0,l.L$)(e),{claInfo:a}=(0,l.L$)(t),{originalLanguageInfo:o}=(0,l.L$)(a),{languageCode:s,canTranslateRealTimeNoCheck:u}=(0,l.L$)(o),{selectedTranslationLanguage:d,isReady:g}=(0,c.RD)((n=>({selectedTranslationLanguage:n.selectedTranslationLanguage,isReady:n.isReady})),i.bN);return Boolean(s!==d&&u&&g)},_=n=>{var e;const t=(0,r.F3)((e=>e[n])),{video:a}=(0,l.L$)(t),{claInfo:i}=(0,l.L$)(a),o=null===(e=null==i?void 0:i.originalLanguageInfo)||void 0===e?void 0:e.languageCode,{isMasterTranslationOn:s,translationDisableLanguages:u}=(0,c.RD)(),d=h(n);return Boolean(d&&s&&o&&!u.includes(o))},L=n=>v((e=>{var t;return null===(t=e[n])||void 0===t?void 0:t.description})),O=n=>{const e=(0,r.F3)((e=>e[n])),{textLanguage:t,textTranslatable:a}=(0,l.L$)(e),{selectedTranslationLanguage:o,isReady:s}=(0,c.RD)((n=>({selectedTranslationLanguage:n.selectedTranslationLanguage,isReady:n.isReady})),i.bN);return Boolean(t!==o&&a&&s)},T=n=>{const e=(0,r.F3)((e=>e[n])),{textLanguage:t}=(0,l.L$)(e),{isMasterTranslationOn:a,translationDisableLanguages:i}=(0,c.RD)(),o=O(n);return Boolean(o&&a&&t&&!i.includes(t))},C=n=>v((e=>{var t;return null===(t=e[n])||void 0===t?void 0:t.title})),S=n=>v((e=>{var t;return!!(null===(t=e[n])||void 0===t?void 0:t.showTranslation)}))},99282:(n,e,t)=>{t.d(e,{vN:()=>h,WH:()=>O,ck:()=>L,MQ:()=>_});var a=t(60484),i=t(58305),o=t(71281),s=t(49057),l=t(66458),r=t(92502),c=t(11072),u=t(67416),d=t(60072),g=t(45347),v=t(40099),p=t(20362),b=t(57431),f=t(32125);const h=()=>{var n;const{abTestVersion:e}=(0,a.L$)((0,s.W)((()=>["abTestVersion"]),[])),t=null!==(n=(0,o.qt)(e,"video_closed_caption"))&&void 0!==n?n:"v0",l="v0"!==t,r="v1"===t||"v2"===t;return"v0"===t&&(0,i.sc)("caption"),{enabledClosedCaption:l,isEntranceInMoreMenu:r}},_=()=>{var n;const{abTestVersion:e}=(0,a.L$)((0,s.W)((()=>["abTestVersion"]),[]));return"v0"!==(null!==(n=(0,o.qt)(e,"enable_post_translation"))&&void 0!==n?n:"v0")},L=(n,e)=>{var t;const{id:i="",video:o}=(0,a.L$)(n),{claInfo:s}=(0,a.L$)(o),{enabledClosedCaption:u}=h(),d=_(),p=(0,l.K)(),{selectedTranslationLanguage:b,isReady:f}=(0,r.RD)((n=>({selectedTranslationLanguage:n.selectedTranslationLanguage,isReady:n.isReady}))),L=(0,c.xr)(),O=(0,c.sX)(i),T=(0,c.xL)(i),C=(0,c.Vk)(i),S=(0,c.xJ)(i),y=null===(t=null==s?void 0:s.originalLanguageInfo)||void 0===t?void 0:t.languageCode,j=O?b:y,m=(0,v.useMemo)((()=>{if(!s||!s.captionInfos)return[];const n=s.captionInfos.map((n=>{var e,t,a,i;return{id:null!==(e=n.languageID)&&void 0!==e?e:"",language:null!==(t=n.languageCode)&&void 0!==t?t:"",url:null!==(a=n.urlList)&&void 0!==a?a:[],urlExpire:null!==(i=n.expire)&&void 0!==i?i:""}}));return S&&n.push(S),n}),[s,S]),D=(0,v.useMemo)((()=>m.filter((n=>n.language===j))),[m,j]),w=(0,v.useMemo)((()=>{var n,e;return null===(e=null===(n=null==s?void 0:s.captionInfos)||void 0===n?void 0:n.filter((n=>n.isOriginalCaption))[0])||void 0===e?void 0:e.claSubtitleID}),[s]),M=(0,v.useMemo)((()=>0===m.length?null:D[0]),[m,D]),k=(0,v.useCallback)((n=>{const{type:t,texts:a=[],error:o}=n;if("update"===t)if(a.length>0){const{text:n}=a[0];p.setCurrentCaption(n.join(""))}else p.setCurrentCaption("");else o&&g.lN.handleCaptionError({error_msg:o.message,group_id:i,play_mode:e,caption_url:null==M?void 0:M.url})}),[p,i,e,M]);return(0,v.useEffect)((()=>{d&&T&&C&&0===D.length&&w&&f&&L.getSubtitleTranslation({target_language:b,item_id:i,subtitle_id:w})}),[d,T,C,D,w,i,L,b,f]),u||d?{subtitleList:m,curSubtitle:M,handleSubtitleCallback:k}:{}},O=n=>{const e=(0,u.l)(n),t=(0,d.F3)((e=>e[n])),{language:a}=(0,b.x)(),{captionOptions:i,captionLanguage:o}=(0,p.g)(t),{translationDisableLanguages:s,selectedTranslationLanguage:l,isMasterTranslationOn:g,isReady:v}=(0,r.RD)((n=>({translationDisableLanguages:n.translationDisableLanguages,selectedTranslationLanguage:n.selectedTranslationLanguage,isMasterTranslationOn:n.isMasterTranslationOn,isReady:n.isReady})),f.bN),h=(0,c.sX)(n),_=(0,c.M)(n);return{caption_mode:e?"on":"off",caption_options:i,caption_language:o,always_translate_post_mode:g?"on":"off",do_not_translate_mode:0===s.length?"no_selection":"has_selection",translate_into_mode:l===a?"default_language":"user_selected_language",see_original_show:h&&_&&v?"yes":"no",see_translation_show:!h&&_&&v?"yes":"no"}}},20362:(n,e,t)=>{t.d(e,{g:()=>i});var a=t(60484);const i=n=>{var e,t,i,o,s;const{video:l}=(0,a.L$)(n),{claInfo:r}=(0,a.L$)(l);let c="show captions";return!(null==r?void 0:r.captionInfos)&&(c="show captions (unavailable)"),(null===(t=null===(e=null==r?void 0:r.captionInfos)||void 0===e?void 0:e[0])||void 0===t?void 0:t.isAutoGen)&&(c="show captions auto generate"),{captionOptions:c,captionLanguage:null!==(s=null===(o=null===(i=null==r?void 0:r.captionInfos)||void 0===i?void 0:i[0])||void 0===o?void 0:o.language)&&void 0!==s?s:""}}},79395:(n,e,t)=>{t.d(e,{$:()=>s,k:()=>o});var a=t(60072),i=t(32125);function o(n){return(0,a.F3)((e=>e[n]),i.bN)}function s(n,e){return(0,a.F3)((t=>e(t[n])),i.bN)}},45347:(n,e,t)=>{t.d(e,{lN:()=>l});var a,i,o,s=t(93608);!function(n){n.Hidden="hidden",n.Captions="captions",n.Icon="icon"}(a||(a={})),function(n){n.HasSelection="has_selection",n.NoSelection="no_selection"}(i||(i={})),function(n){n.Default="default_language",n.UserSelected="user_selected_language"}(o||(o={}));const l={handleCaptionButtonShow:n=>{s.f.sendEvent("show_captions_button",n)},handleCaptionButtonClick:n=>{s.f.sendEvent("click_captions_button",n)},handleCaptionPopupShow:n=>{s.f.sendEvent("show_captions_popup",n)},handleCaptionPopupClose:n=>{s.f.sendEvent("close_captions_popup",n)},handleCaptionSwitch:n=>{s.f.sendEvent("switch_captions",n)},handleCaptionError:n=>{s.f.sendEvent("caption_error",n)},handleClickSubtitle:n=>{s.f.sendEvent("click_subtitle",n)},handleExpandSubtitle:n=>{s.f.sendEvent("expand_subtitle",n)},handleHideSubtitle:n=>{s.f.sendEvent("hide_subtitle",n)},handleSeeMoreShow:n=>{s.f.sendEvent("see_more_show",n)},handleDescriptionUnfolded:n=>{s.f.sendEvent("descriptions_unfolded",n)},handleDescriptionFolded:n=>{s.f.sendEvent("descriptions_folded",n)}}}}]);