"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[3072],{53701:(e,t,r)=>{r.d(t,{a:()=>a,k:()=>i});var n=r(93608);const i=e=>{n.f.event("video_data_size",e)},a=e=>{n.f.event("basic_player_cdn_cost",e)}},96462:(e,t,r)=>{r.d(t,{bp:()=>g,OK:()=>c,O5:()=>h,he:()=>f,sK:()=>b,SO:()=>k,vb:()=>v,Ck:()=>P,rX:()=>p,vk:()=>T});var n,i,a,o,l,s,d=r(44137);!function(e){e[e.HaveNothing=0]="HaveNothing",e[e.HaveMetaData=1]="HaveMetaData",e[e.HaveCurrentData=2]="HaveCurrentData",e[e.HaveFutureData=3]="HaveFutureData",e[e.HaveEnoughData=4]="HaveEnoughData"}(n||(n={})),function(e){e[e.Public=0]="Public",e[e.Self=1]="Self",e[e.Friend=2]="Friend"}(i||(i={})),function(e){e[e.PlayStop=0]="PlayStop",e[e.ResumePlaying=1]="ResumePlaying"}(a||(a={})),function(e){e.FeedRequest="feed_request",e.FeedRequestResponse="feed_request_response"}(o||(o={})),function(e){e.LoadMore="load_more"}(l||(l={})),function(e){e.PlayQuality="video_play_quality",e.PlayEnded="video_play_end",e.PlayFailed="video_play_failed",e.BlockStart="video_block_start",e.Block="video_block",e.Request="video_request",e.RequestResponse="video_request_response",e.FirstFrame="first_feed_show_time"}(s||(s={}));const u={0:"one_column",1:"three_column",2:"browser_mode",3:"swiper_mode",4:"video_detail",6:"pip",5:"fullscreen",7:"creator_tab",8:"mini_player",9:"immersive_player"},c=e=>e&&Array.isArray(e)?e.map((e=>{var t;return null!==(t=e.GearName)&&void 0!==t?t:"unknown"})):null,p=e=>e&&Array.isArray(e)?e.map((e=>`${e.QualityType}:${e.Bitrate}`)):null,v=()=>({cpu_core:"undefined"==typeof navigator?0:navigator.hardwareConcurrency,memory_size:"undefined"==typeof navigator?0:navigator.deviceMemory,HEVC_supported:(0,d.X)()?1:0}),h=e=>void 0!==e&&e.length>0?1e3*Math.round(e.end(0)-e.start(0)):0,y=(e,t)=>e?2:t?1:0,m=(e="")=>{if(!e)return"";const t=e.match(/https?:\/\/([^/]+)\//i);let r="";return(null==t?void 0:t[1])&&(r=t[1]),r},g=e=>{if(!e||"string"!=typeof e)return 0;let t=0;try{const r=new RegExp("(\\?|&)expire=([^&]*)(&|$)"),n=e.match(r);if(null!==n)t=parseInt(n[2],10);else{const r=e.split("/");r.length>5&&8===r[4].length&&(t=parseInt(r[4],16))}return t>0?t<parseInt(String((new Date).getTime()/1e3),10)?1:2:0}catch(e){return 0}},f=e=>{var t;const{id:r,authorId:n,playMode:i,forFriend:a=!1,secret:o=!1,play_url:l,awemeType:s,picCnt:d,playlist_id:c="",popup_type:p="",size:v=-1}=e;return{group_id:r,author_id:n,play_mode:null!==(t=u[i])&&void 0!==t?t:"others",logo_type:"",item_status:y(a,o),play_url:l,host:m(l),aweme_type:null!=s?s:0,pic_cnt:d,playlist_id:c,popup_type:p,size:v}},_=(e,t)=>{const r=(e=>!e||/^(\d)*p$/i.test(`${e}`))(t);return r?e&&t?`${e}_${t}`:`unknownQuality_fromServer_${e}_${t}`:t},b=e=>{const{bitrate:t=-1,format:r="",codecType:n="",encodedType:i="",videoQuality:a="",definition:o="",encodeUserTag:l="",originalDefinition:s=""}=e;return{video_bitrate:t,video_format:r,codec_format:n,encoded_type:i,bitrate_quality:a,video_quality:String(_(a,o)),video_encodeUserTag:l,original_definition:s}},k=e=>{const{preload_size:t=-1,preload_time:r=-1,video_type:n="mp4",player_type:i="defaultPlayer"}=e;return{preload_size:t,preload_time:r,player_type:i,video_type:n}},P=e=>{const{totalWatchCount:t,foruWatchCount:r}=e;return{watch_count_total:t,watch_count_foru:r}};let S="-1";const C=["avc1.42E01E, mp4a.40.2","avc1.58A01E, mp4a.40.2","avc1.4D401E, mp4a.40.2","avc1.64001E, mp4a.40.2","avc1.42E01E","mp4v.20.8","avc1.42E01E, mp4a.40.2","avc1.58A01E, mp4a.40.2","avc1.4D401E, mp4a.40.2","avc1.64001E, mp4a.40.2","mp4v.20.8, mp4a.40.2","mp4v.20.240, mp4a.40.2"];function T(){try{const e={isSupport:!1,mime:""};if("undefined"==typeof document)return"0";if("-1"!==S&&"-2"!==S)return S;let t=document.createElement("video");"function"==typeof t.canPlayType&&C.map((r=>{"probably"===(null==t?void 0:t.canPlayType(`video/mp4; codecs="${r}"`))&&(e.isSupport=!0,e.mime+=`||${r}`)}));const r=e.isSupport?"1":"0";return S=r,t=null,r}catch(e){return"-2"}}},96959:(e,t,r)=>{r.d(t,{Cd:()=>c,re:()=>p});var n=r(93608),i=r(38739),a=r(96462);const o={isPause:null,isVideoLoaded:!1,isFirstPlayReported:!1,isFirstPlayEndReported:!1,isInPlaybackStage:!1,triggerPlayTimestamp:0,firstTriggerPlayTimestamp:0,loadStartTimestamp:0,blockStartTimestamp:0,blockStartProgress:0,playingStartTimestamp:0,pauseStartTimestamp:0,totalPauseDuration:0,volume:0,muted:!0,mutedStateChange:!1,videoSourceLoadTime:0,cacheDuration:0,cacheSize:0,dataPlayerType:0,playSize:0,cdnSizeVideo:0,frameInfo:{drop_frame:0,total_play_frame:-1,drop_frame_rate:-1,drop_frame_duration:0}},l={currentSrc:"",duration:0,error:null,currentTime:0,readyState:0,buffered:{start:()=>0,end:()=>0,length:0},volume:0,muted:!0,mutedStateChange:!1};let s=1,d="",u="";const c=e=>{d=e};class p{constructor(){this.innerStates=Object.assign({},o),this.innerVideoAttributeStates=Object.assign({},l),this.isFirstFrameReported=!1,this.resetState=()=>{this.innerStates=Object.assign({},o),d="",this.isFirstFrameReported=!1,this.innerVideoAttributeStates=Object.assign({},l)},this.resetStateWhenSlideChange=()=>{this.innerStates=Object.assign({},o),this.innerVideoAttributeStates=Object.assign({},l)},this.reset=(e,t)=>{d!==e&&(this.playEndEvent(t),this.blockEndEvent(Object.assign(Object.assign({},t),{endType:0})),this.innerStates=Object.assign({},o))},this.resetWhenSlideChange=e=>{this.playEndEvent(Object.assign(Object.assign({},e),this.innerVideoAttributeStates)),this.blockEndEvent(Object.assign(Object.assign(Object.assign({},e),{endType:0}),this.innerVideoAttributeStates)),this.innerVideoAttributeStates=Object.assign({},l)},this.updateFrameInfo=e=>{this.innerStates.frameInfo=e},this.handlePlay=()=>{this.innerStates.triggerPlayTimestamp=Date.now();const{firstTriggerPlayTimestamp:e}=this.innerStates;e||(this.innerStates.firstTriggerPlayTimestamp=Date.now())},this.handlePause=e=>{const{id:t}=e,{playingStartTimestamp:r,isPause:n}=this.innerStates;t&&r&&!n&&(this.innerStates.pauseStartTimestamp=Date.now()),this.innerStates.isPause=!0},this.handleTimeUpdate=e=>{const{triggerPlayTimestamp:t,isFirstPlayReported:r,pauseStartTimestamp:i,videoSourceLoadTime:o,loadStartTimestamp:l}=this.innerStates,{currentTime:s=0,duration:c=0,codecType:p,volume:v=0,muted:h=!0,bitrateInfo:y,buffered:m,currentSrc:g,error:f,readyState:_}=e;if(this.innerVideoAttributeStates.duration=c,this.innerVideoAttributeStates.currentTime=s,this.innerVideoAttributeStates.buffered=m,this.innerVideoAttributeStates.currentSrc=g,this.innerVideoAttributeStates.error=f,this.innerVideoAttributeStates.readyState=_,!(s<=0)){if(!r&&0!==t){const r=Date.now()-t-1e3*s,i=Date.now()-l,m=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},(0,a.he)(e)),(0,a.sK)(e)),(0,a.SO)(e)),(0,a.Ck)(e)),(0,a.vb)()),{duration:r>0?Math.round(r):0,video_duration:Math.round(1e3*c),is_bytevc1:(null!=p?p:"").indexOf("h265")>-1?1:0,muted:h?1:0,bitrate_set:(0,a.OK)(y),quality_bitrate:(0,a.rX)(y),duration_from_load:Math.round(i),duration_with_load:Math.round(r+o),is_same:d===u?1:0});n.f.event("video_play_quality",m),u=d,this.innerStates.isFirstPlayReported=!0,this.innerStates.playingStartTimestamp=Date.now(),this.innerStates.volume=v,this.innerStates.muted=h}if(this.innerStates.mutedStateChange=this.innerStates.mutedStateChange||this.innerStates.muted!==h,this.innerStates.muted=h,!this.isFirstFrameReported&&performance&&this.firstFrameEvent(),this.innerStates.isPause){const e=i?Date.now()-i:0;this.innerStates.totalPauseDuration+=e}this.blockEndEvent(Object.assign(Object.assign({},e),{endType:1})),this.innerStates.isInPlaybackStage=!0,this.innerStates.isPause=!1}},this.handleEnded=()=>{this.innerStates.isInPlaybackStage=!1},this.handleError=e=>{const{isVideoLoaded:t,isInPlaybackStage:r}=this.innerStates,{error:i,codecType:o="",duration:l,play_url:s}=e,{code:d=0,message:u=""}=null!=i?i:{},c=s?(0,a.bp)(s):-1,p=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},(0,a.he)(e)),(0,a.sK)(e)),(0,a.Ck)(e)),(0,a.vb)()),{error_code:String(d),error_info:u,is_bytevc1:o.indexOf("h265")>-1?1:0,duration:null!=l?l:0,isExpired:c,isSupportMP4:(0,a.vk)(),is_before:t&&r?0:1});n.f.event("video_play_failed",p)},this.handleWaiting=e=>{const{currentTime:t=0,duration:r=0}=e,{isInPlaybackStage:i,blockStartTimestamp:o,isPause:l}=this.innerStates;if(0!==t&&t!==r&&i&&!1===l&&0===o){const r=Object.assign(Object.assign(Object.assign({},(0,a.he)(e)),(0,a.Ck)(e)),(0,a.vb)());n.f.event("video_block_start",r),this.innerStates.blockStartTimestamp=Date.now(),this.innerStates.blockStartProgress=1e3*t}},this.handleLoadStart=e=>{const t=Object.assign(Object.assign(Object.assign(Object.assign({},(0,a.he)(e)),(0,a.Ck)(e)),(0,a.vb)()),(0,i.Mp)(e));n.f.event("video_request",t),this.innerStates.loadStartTimestamp=Date.now()},this.handleLoadedData=e=>{this.responseEvent(e),this.innerStates.isVideoLoaded=!0},this.firstFrameEvent=()=>{const e=performance.timeOrigin,t={feed_total:e?Math.round(Date.now()-e):-1};n.f.event("first_feed_show_time",t),this.isFirstFrameReported=!0}}updateNativePlayerCDNCache(e,t){this.innerStates.cacheDuration=e,this.innerStates.cacheSize=t}msePlayerCacheUpdate(e){void 0!==e&&(this.innerStates.cdnSizeVideo+=e)}updatePlayerType(e){this.innerStates.dataPlayerType=e}blockEndEvent(e){const{currentTime:t=0,codecType:r,endType:i,should_filter:o=!1,droppedRate:l}=e,{blockStartTimestamp:s,blockStartProgress:d,isInPlaybackStage:u,isVideoLoaded:c}=this.innerStates;if(c&&u&&0!==s&&(1e3*t!==d||0===i)){const u=Date.now()-s-(1e3*t-d),c=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},(0,a.he)(e)),(0,a.sK)(e)),(0,a.SO)(e)),(0,a.vb)()),{duration:u>=0?Math.round(u):0,is_bytevc1:(null!=r?r:"").indexOf("h265")>-1?1:0,end_type:i,position:Math.round(1e3*t),should_filter:o?"1":"0",droppedRate:l});n.f.event("video_block",c),this.innerStates.blockStartTimestamp=0}}responseEvent(e){const{loadStartTimestamp:t}=this.innerStates,{error:r,videoQuality:o,definition:l,play_url:s,codecType:d}=e,u=s?(0,a.bp)(s):-1,c=Date.now()-t;this.innerStates.videoSourceLoadTime=c;const p=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},(0,a.he)(e)),(0,a.vb)()),(0,a.Ck)(e)),{error_code:String(null==r?void 0:r.code),duration:c,is_success:r?"0":"1",video_quality:o&&l?`${o}_${l}`:""}),(0,i.Mp)(e)),{isExpired:u,isSupportMP4:(0,a.vk)(),is_bytevc1:(null!=d?d:"").indexOf("h265")>-1?1:0});n.f.event("video_request_response",p)}playEndEvent(e){const{isFirstPlayReported:t,isFirstPlayEndReported:r,playingStartTimestamp:i,totalPauseDuration:o,firstTriggerPlayTimestamp:l,volume:d,frameInfo:u}=this.innerStates,{bitrate:c}=e;if(!r&&i){const{buffered:r,duration:p=0,currentTime:v=0,readyState:h,volume:y=0,muted:m,codecType:g}=e,f=i?Date.now()-i-o:0,_=c?c/8*((f>1e3*p?1e3*p:f)/1e3):-1,b=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},(0,a.he)(e)),(0,a.sK)(e)),(0,a.SO)(e)),(0,a.vb)()),{is_success:t?"1":"0",video_duration:isNaN(p)?0:Math.round(1e3*p),play_duration:Math.round(1e3*v),buffering:(null!=h?h:0)<=2?1:0,duration:f>=0?Math.round(f):0,wait_duration:i>0?0:Date.now()-l,cur_cache_duration:(0,a.O5)(r),local_time_ms:Date.now(),volume_level:Number(y.toFixed(4)),volume_change:t?Number((y-d).toFixed(4)):0,muted:m?1:0,click_mute:this.innerStates.mutedStateChange?m?2:1:0,session_order:s++,play_size:Math.round(_),data_player_type:this.innerStates.dataPlayerType,cache_size:1===this.innerStates.dataPlayerType?-10:Math.round(this.innerStates.cacheSize),cache_duration:1===this.innerStates.dataPlayerType?-10:Math.round(this.innerStates.cacheDuration),cdn_size_video:this.innerStates.cdnSizeVideo}),u),{is_bytevc1:(null!=g?g:"").indexOf("h265")>-1?1:0});n.f.event("video_play_end",b),this.innerStates.isFirstPlayEndReported=!0}}}},92701:(e,t,r)=>{r.d(t,{Hg:()=>n,cU:()=>i});const n=({hevcTest:e,bitrateInfo:t,videoOrder:r,downgradeUrl:n,backupDomain:i=!1,codec:a="h264"})=>{var o;const{h264:l=[],h265:s=[]}=((e,t)=>{const r={};let n=e;return t&&(n=((e,t)=>{try{const r=(t,r)=>t[e[0].property]!==r[e[0].property]?"Bitrate"===e[0].property?"desc"===e[0].order?r.Bitrate-t.Bitrate:t.Bitrate-r.Bitrate:e[0].detail.indexOf(t[e[0].property])>=0&&e[0].detail.indexOf(r[e[0].property])>=0?e[0].detail.indexOf(t[e[0].property])-e[0].detail.indexOf(r[e[0].property]):e[0].detail.indexOf(t[e[0].property])>=0?-1:1:t[e[1].property]!==r[e[1].property]?"Bitrate"===e[1].property?"desc"===e[1].order?r.Bitrate-t.Bitrate:t.Bitrate-r.Bitrate:e[1].detail.indexOf(t[e[1].property])>=0&&e[1].detail.indexOf(r[e[1].property])>=0?e[1].detail.indexOf(t[e[1].property])-e[1].detail.indexOf(r[e[1].property]):e[1].detail.indexOf(t[e[1].property])>=0?-1:1:1;return t&&t.length>0?[...t].sort(r):void 0}catch(e){return void console.error("bitrateInfo is empty")}})(t,e)),n?(n.forEach((e=>{let{CodecType:t}=e;t.startsWith("h265")&&(t="h265"),r[t]||(r[t]=[]),r[t].push(e)})),r):r})(t,r),{qualityType:d=20,hevcQualityType:u=28}=e;let c=null,p="",v="h264";if(function(e,t,r){return e.length>0&&t&&"h265"===r}(s,e.open,a)&&(c=(({hevcQualityType:e,h265:t})=>{if(t){const r=e||28;t.sort(((e,t)=>e.Bitrate-t.Bitrate));const n=t.find((e=>e.QualityType===r));if(n)return n;if(t.length>0)return t[0]}return null})({hevcQualityType:u,h265:s})),c?v="h265":c=(({qualityType:e,h264:t})=>{if(t&&t.length>0){const r=e||20;t.sort(((e,t)=>e.Bitrate-t.Bitrate));let n=t.find((e=>e.QualityType===r));return n||(n=t[0]),n}return null})({qualityType:d,h264:l}),c){const e=(null===(o=c.PlayAddr)||void 0===o?void 0:o.UrlList)||[];if(e.length>0)return p=e.length>1&&i?e[1]:e[0],{src:p,bitrate:c.Bitrate||0,definition:c.GearName||"",codecType:v,finalBitrateInfo:[c]}}return{bitrate:0,definition:"",src:null!=n?n:"",codecType:"h264",finalBitrateInfo:void 0}},i=e=>{const t=[],r=[];return e&&e.forEach((e=>{const n={qualityType:e.QualityType,gearName:e.GearName};e.CodecType.indexOf("h265")>=0?r.push(n):t.push(n)})),{h264Set:t,h265Set:r}}},91021:(e,t,r)=>{r.d(t,{Ah:()=>p,JX:()=>o,ZQ:()=>c,as:()=>l});var n=r(58632),i=r(7672);let a=3,o=class{constructor(){this.preloadQueue=[],this.preloadStartIndex=-1,this.currentPage="",this.preloadUrlsPool=new Set,this.setPreloadQueue=e=>{e.length&&(this.preloadQueue=null!=e?e:[],e.forEach((({id:e})=>{e&&this.preloadUrlsPool.add(e)})))},this.setPreloadIndex=e=>{e>=0&&(this.preloadStartIndex=e)},this.getPreloadUrls=()=>{const{preloadStartIndex:e}=this;return this.preloadQueue.slice(e+1,e+a+1)},this.getPreloadedPool=()=>this.preloadUrlsPool,this.reset=()=>{this.preloadQueue=[],this.preloadStartIndex=-1,this.preloadUrlsPool.clear()},this.setCurrentPage=e=>{this.currentPage=e||"unknown"},this.clearAllVideoCaches=()=>{this.currentPage&&this.preloadUrlsPool.clear()}}};o=(0,n.__decorate)([(0,i._)()],o);const l=e=>{a=e},s={byteLength:-1,duration:-1,type:-1,vid:"unknown"};class d{constructor(){this.preloadVideoId="",this.preloadVideoCache=s,this.setPreloadCacheInfo=(e,t)=>{e&&t&&e!==this.preloadVideoId&&(this.preloadVideoId=e,this.preloadVideoCache=t)},this.getPreloadCacheInfo=e=>e&&this.preloadVideoId&&e===this.preloadVideoId?this.preloadVideoCache:s}}let u=null;const c=()=>(u||(u=new d),u),p={playerReuse:0,playerPreload:{vid:"v0",maxQueueCount:3,preloadMaxCacheCount:5,preloadTime:10,segmentMinDuration:10,minBufferLength:10,startPreloadControl:!1,startPreloadMinBuffer:0,startPreloadMinPosTime:0},hevcIgnoreEnv:0,hevcResultLocal:0,bitrateSelect:{vid:"v0",selector:"default",qualityType:20,hevcQualityType:14},playerUpgrade:{vid:"v0",playerType:"XG"},playerH265Soft:{vid:"v0",enableSoftwareH265:0},playerOpenMse:0}},63508:(e,t,r)=>{var n;r.d(t,{Az:()=>i,Wu:()=>o,uJ:()=>a}),function(e){e[e.NIL=-255]="NIL",e[e.UnknownError=-1]="UnknownError",e[e.Ok=0]="Ok",e[e.ReportLiveFailed=90002]="ReportLiveFailed",e[e.VerifyCode=1e4]="VerifyCode",e[e.VideoLikeFreq=2150]="VideoLikeFreq",e[e.VideoLikeFreq2=2210]="VideoLikeFreq2",e[e.VideoUnavailableDeleted=2054]="VideoUnavailableDeleted",e[e.AdVideoUnavailableChange=2752]="AdVideoUnavailableChange",e[e.CommentBanCode=22]="CommentBanCode",e[e.CommentLikePermissionDisable=3002043]="CommentLikePermissionDisable",e[e.SearchSensitiveCode=403]="SearchSensitiveCode",e[e.SearchYoungCode=203]="SearchYoungCode",e[e.SmsInvalidNumber=-1]="SmsInvalidNumber",e[e.SmsSlideVerify=-4]="SmsSlideVerify",e[e.FypVideoListLimit=10404]="FypVideoListLimit",e[e.ClientPageError=450]="ClientPageError",e[e.LiveNeedLogin=10119]="LiveNeedLogin",e[e.SharkBlock=10114]="SharkBlock",e[e.SharkSlide=10113]="SharkSlide",e[e.NetError=10111]="NetError",e[e.ServerErrorNot500=10101]="ServerErrorNot500",e[e.VideoRisk=10228]="VideoRisk",e[e.VideoRMask=10229]="VideoRMask",e[e.VideoRiskMask=10230]="VideoRiskMask",e[e.VideoNeedRecheck=10227]="VideoNeedRecheck",e[e.VideoUnshelveByMusic=10220]="VideoUnshelveByMusic",e[e.VideoNotExist=10204]="VideoNotExist",e[e.VideoAbnormal=10215]="VideoAbnormal",e[e.VideoLowAgeM=10213]="VideoLowAgeM",e[e.VideoLowAgeT=10214]="VideoLowAgeT",e[e.VideoFirstReviewUnshelve=10217]="VideoFirstReviewUnshelve",e[e.VideoPrivateByUser=10216]="VideoPrivateByUser",e[e.VideoGeofenceBlock=10231]="VideoGeofenceBlock",e[e.VideoPhoto=10239]="VideoPhoto",e[e.VideoFriendsOnly=10240]="VideoFriendsOnly",e[e.VideoDeleted=10241]="VideoDeleted",e[e.VideoUserBlockedByAuthor=10242]="VideoUserBlockedByAuthor",e[e.HashtagNotExist=10205]="HashtagNotExist",e[e.HashtagUnshelve=10212]="HashtagUnshelve",e[e.HashtagSensitivityWord=10211]="HashtagSensitivityWord",e[e.HashtagBlackList=10209]="HashtagBlackList",e[e.UserInboxFollowBan=24]="UserInboxFollowBan",e[e.UserNotExist=10202]="UserNotExist",e[e.UserBan=10221]="UserBan",e[e.UserPrivate=10222]="UserPrivate",e[e.UserNotLogin=10102]="UserNotLogin",e[e.UserFtc=10223]="UserFtc",e[e.UserUniqueSensitivity=10225]="UserUniqueSensitivity",e[e.QuestionNotAvailable=10236]="QuestionNotAvailable",e[e.MusicNotExist=10203]="MusicNotExist",e[e.MusicUnshelve=10218]="MusicUnshelve",e[e.MusicNoCopyright=10219]="MusicNoCopyright",e[e.MusicUnavailable=202001]="MusicUnavailable",e[e.GameNotExist=10224]="GameNotExist",e[e.LiveNotExist=10210]="LiveNotExist",e[e.GoLiveRoomBaned=10018]="GoLiveRoomBaned",e[e.GoLiveBaned=4003035]="GoLiveBaned",e[e.LiveRoomPrepare=30019]="LiveRoomPrepare",e[e.LiveRoomEnd=30003]="LiveRoomEnd",e[e.LiveRoomBan=30012]="LiveRoomBan",e[e.LiveNoGatedAuth=4003043]="LiveNoGatedAuth",e[e.LiveNoAgeGatedAuth=4003110]="LiveNoAgeGatedAuth",e[e.LivePaidEvent=4003072]="LivePaidEvent",e[e.LiveSubscriberOnly=4003135]="LiveSubscriberOnly",e[e.LiveSuicideCase=2403]="LiveSuicideCase",e[e.LiveSensitiveTitle=50004]="LiveSensitiveTitle",e[e.LiveRoomBaned=10018]="LiveRoomBaned",e[e.LiveEnterRoomNeedLogin=20003]="LiveEnterRoomNeedLogin",e[e.LiveAccountUnderRiskControl=20063]="LiveAccountUnderRiskControl",e[e.LiveHitBanStrategy=30009]="LiveHitBanStrategy",e[e.LiveOBSAccessRecalled=4003105]="LiveOBSAccessRecalled",e[e.EffectNotExist=10208]="EffectNotExist",e[e.PlaylistNotExist=10233]="PlaylistNotExist",e[e.PlaylistInTrill=10234]="PlaylistInTrill",e[e.VideoPlaylistUnavailable=10243]="VideoPlaylistUnavailable",e[e.VideoPlaylistIsEmpty=10244]="VideoPlaylistIsEmpty",e[e.PrivateAccountLimitByBC=3026002]="PrivateAccountLimitByBC"}(n||(n={}));const i=e=>{if(isNaN(e))return"00:00";const t=Math.floor(e/3600),r=(t<10?"0":"")+t.toString(),n=`0${Math.floor(e/60%60)}`.slice(-2),i=`0${Math.floor(e%60)}`.slice(-2);return 0===t?`${n}:${i}`:`${r}:${n}:${i}`},a=(new Map([[2,"adapt_lowest_1080p"],[3,"adapt_lower_1080p"],[4,"adapt_1080p"],[7,"adapt_lowest_1440p"],[10,"normal_720p"],[11,"low_720p"],[12,"adapt_high_720p"],[13,"adapt_higher_720p"],[14,"adapt_lower_720p"],[15,"adapt_lowest_720p"],[16,"higher_720p"],[17,"highest_720p"],[18,"adapt_720p"],[19,"adapt_low_720p"],[191,"lower_720p"],[20,"normal_540p"],[21,"adapt_lower_540p"],[22,"adapt_high_540p"],[23,"adapt_higher_540p"],[24,"lower_540p"],[25,"lowest_540p"],[26,"higher_540p"],[27,"highest_540p"],[28,"adapt_540p"],[29,"adapt_lowest_540p"],[291,"adapt_low_540p"],[30,"normal_480p"],[31,"low_480p"],[32,"high_480p"],[33,"medium_480p"],[34,"lower_480p"],[35,"lowest_480p"],[36,"higher_480p"],[37,"highest_480p"],[38,"adapt_480p"],[39,"adapt_lower_480p"],[391,"adapt_high_480p"],[40,"normal_360p"],[41,"low_360p"],[42,"high_360p"],[43,"medium_360p"],[44,"lower_360p"],[45,"lowest_360p"],[46,"higher_360p"],[47,"highest_360p"],[48,"adapt_360p"],[49,"adapt_lowest_360p"],[50,"adapt_high_360p"]]),"use-credentials"),o="PRELOAD_INFO"},72263:(e,t,r)=>{r.d(t,{A:()=>n});var n=new(r(85135).A)},40650:(e,t,r)=>{r.d(t,{R:()=>a});var n=r(40099);const i=300;function a(e,t){const{onClick:r,onDoubleClick:a,onIntervalAction:o}=e(),l=(0,n.useRef)(0),s=(0,n.useRef)(!1);return(0,n.useCallback)((e=>{l.current&&window.clearTimeout(l.current),s.current?null==a||a(e):(null==o||o(),s.current=!0,window.setTimeout((()=>{s.current=!1}),i),l.current=window.setTimeout((()=>{null==r||r(e)}),i))}),t)}},30662:(e,t,r)=>{r.d(t,{tG:()=>s});var n,i,a=r(58632),o=r(7672),l=r(93608);!function(e){e.Share="livesdk_share",e.Report="livesdk_live_user_report",e.ReportSuccess="livesdk_report_success",e.ChatClose="livesdk_comment_close",e.HoverUserCardShow="livesdk_user_card_show",e.Follow="livesdk_follow",e.Take="livesdk_live_action",e.SetupPopShow="livesdk_live_tab_popup_show",e.AnchorEnterRoom="livesdk_anchor_enter_room",e.Show="livesdk_live_show",e.ClickEntrance="livesdk_rec_live_play",e.Unfollow="livesdk_unfollow"}(n||(n={})),function(e){e.LiveCover="live_cover",e.SuggestedOthersPhoto="suggested_others_photo",e.NextIconClick="next_icon_click",e.Others="others",e.VideoHeadBrowser="video_head_browser",e.Creator="creator",e.VideoHead="video_head",e.LiveHead="live_head",e.OthersPhoto="others_photo",e.ClickOneColumnUser="click_main_btn",e.TopLiveCell="top_live_cell",e.VideoLiveCell="video_live_cell",e.FollowingTop="top_window",e.FollowingPreview="live_cover_preview"}(i||(i={}));let s=class{constructor(){this.handleLiveEntranceShow=e=>{l.f.event("livesdk_live_show",e)},this.handleLiveEntranceClick=e=>{l.f.event("livesdk_rec_live_play",e)},this.handleLiveStreamEntranceClick=e=>{l.f.event("livesdk_live_action",Object.assign({live_type:"third_party"},e))}}};s=(0,a.__decorate)([(0,o._)()],s)},64116:(e,t,r)=>{r.d(t,{Az:()=>i,Dr:()=>n,H4:()=>o});const n=e=>10229===e||10230===e,i=e=>{if(isNaN(e))return"00:00";const t=Math.floor(e/3600),r=(t<10?"0":"")+t.toString(),n=`0${Math.floor(e/60%60)}`.slice(-2),i=`0${Math.floor(e%60)}`.slice(-2);return 0===t?`${n}:${i}`:`${r}:${n}:${i}`},a=new Map([[2,"adapt_lowest_1080p"],[3,"adapt_lower_1080p"],[4,"adapt_1080p"],[7,"adapt_lowest_1440p"],[10,"normal_720p"],[11,"low_720p"],[12,"adapt_high_720p"],[13,"adapt_higher_720p"],[14,"adapt_lower_720p"],[15,"adapt_lowest_720p"],[16,"higher_720p"],[17,"highest_720p"],[18,"adapt_720p"],[19,"adapt_low_720p"],[191,"lower_720p"],[20,"normal_540p"],[21,"adapt_lower_540p"],[22,"adapt_high_540p"],[23,"adapt_higher_540p"],[24,"lower_540p"],[25,"lowest_540p"],[26,"higher_540p"],[27,"highest_540p"],[28,"adapt_540p"],[29,"adapt_lowest_540p"],[291,"adapt_low_540p"],[30,"normal_480p"],[31,"low_480p"],[32,"high_480p"],[33,"medium_480p"],[34,"lower_480p"],[35,"lowest_480p"],[36,"higher_480p"],[37,"highest_480p"],[38,"adapt_480p"],[39,"adapt_lower_480p"],[391,"adapt_high_480p"],[40,"normal_360p"],[41,"low_360p"],[42,"high_360p"],[43,"medium_360p"],[44,"lower_360p"],[45,"lowest_360p"],[46,"higher_360p"],[47,"highest_360p"],[48,"adapt_360p"],[49,"adapt_lowest_360p"],[50,"adapt_high_360p"]]),o=(e,t)=>{if(!e)return t;if(String(e).indexOf("xgpreload_config")>-1)return e;if(!a.has(Number(e))){const t=String(e).match(/^([a-zA-Z]*)+_([0-9]+)_0$/i);return t?`${t[1]}_${t[2]}p`:`unknown_${e}`}return a.get(Number(e))}},4538:(e,t,r)=>{r.d(t,{i:()=>_});var n,i=r(58632),a=r(24643),o=r(25616),l=r(75431),s=r(62186),d=r(72153),u=r(92846);!function(e){e[e.UserFeed=0]="UserFeed",e[e.Feed=1]="Feed",e[e.Browser=2]="Browser",e[e.List=3]="List",e[e.UserPage=4]="UserPage",e[e.Search=5]="Search",e[e.RecommendList=6]="RecommendList"}(n||(n={}));const c="1800ms",p=(0,l.i7)({"0%":{transform:"scale(.95)"},"50%":{transform:"scale(.9)"},"100%":{transform:"scale(.95)"}}),v=(0,l.i7)({"0%":{transform:"scale(1)"},"40%":{transform:"scale(1.15)"},"45%":{transform:"scale(1.16)"},"95%":{transform:"scale(1)"},"100%":{transform:"scale(1)"}}),h=(0,s.default)("svg",{target:"e1vl87hj0"})({position:"absolute"},"label:SvgRoundCircle;"),y=(0,s.default)("div",{target:"e1vl87hj1"})({position:"relative",display:"flex",alignItems:"center",justifyContent:"center"},(({isAnimating:e})=>e?{":after":{content:'""',position:"absolute",left:1,top:1,right:1,bottom:1,borderRadius:"50%",border:"1px solid rgba(255, 119, 146, .5)",animation:`${v} ${c} ease-out infinite`,boxShadow:"0 -0.5px 0.5px 0.5px rgba(255,119,146,.5)"}}:null),"label:DivContainer;"),m=(0,s.default)(u.e,{target:"e1vl87hj2"})((({enable:e,theme:{colors:t},isAnimating:r})=>[{borderColor:t.LineSecondary,borderWidth:"0.5px",cursor:e?"pointer":"unset",backgroundColor:"rgba(136, 136, 136, 0.5)"},r?{animation:`${p} ${c} ease-out infinite`,animationDelay:".9s"}:null]),"label:StyledAvatar;"),g=(0,s.default)("span",{target:"e1vl87hj3"})((({theme:e,isOnTop:t=!1,isBiggerBadge:r=!1})=>[(0,d.zy)({theme:e,typography:"P4",fontWeight:"bold",color:"ConstTextInverse"}),{position:"absolute",background:"linear-gradient(131.17deg, #FF1764 0%, #ED3495 94.15%)",top:t?"-6px":"unset",left:"50%",transform:"translateX(-50%)",wordBreak:"keep-all",zIndex:1},r?{height:"26px",lineHeight:"21px",padding:"1px 8px",bottom:t?"unset":"-8px",border:`2px solid ${e.colors.BGPrimary}`,borderRadius:"5px"}:{height:"15px",lineHeight:"16px",padding:"0 4px",bottom:t?"unset":"-2px",borderRadius:"2px"}]),"label:SpanLiveBadge;"),f=function({size:e=48}){return(0,a.jsxs)(h,{width:e,height:e,viewBox:`0 0 ${e} ${e}`,fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,a.jsx)("circle",{cx:e/2,cy:e/2,r:e/2-.75,stroke:"url(#paint0_linear)",strokeWidth:"1.5"}),(0,a.jsx)("defs",{children:(0,a.jsxs)("linearGradient",{id:"paint0_linear",x1:-20.9902*e/48,y1:24*e/48,x2:27.0098*e/48,y2:65.9805*e/48,gradientUnits:"userSpaceOnUse",children:[(0,a.jsx)("stop",{stopColor:"#FF1764"}),(0,a.jsx)("stop",{offset:"1",stopColor:"#ED3495"})]})})]})},_=function(e){var{className:t,needAnimation:r=!1,isShowLive:n=!0,size:l=32,isShowLiveTag:s=!0,isTagShowingOnTop:d=!1,e2eTag:u,isBiggerBadge:c}=e,p=(0,i.__rest)(e,["className","needAnimation","isShowLive","size","isShowLiveTag","isTagShowingOnTop","e2eTag","isBiggerBadge"]);const v=(0,o.s)(),h=n&&r,_=n?l-6:l,b=h?l-4:l;return(0,a.jsxs)(y,{isAnimating:h,className:t,"data-e2e":u,style:{width:l,height:l},children:[n&&(0,a.jsx)(f,{size:b}),(0,a.jsx)(m,Object.assign({isAnimating:h,enable:!0,size:_},p)),n&&s&&(0,a.jsx)(g,{isOnTop:d,isBiggerBadge:c,children:v("LIVE")})]})}},60492:(e,t,r)=>{r.d(t,{m:()=>y});var n=r(40099),i=r(18499),a=r(53764),o=r(24643),l=r(75431),s=r(62186),d=r(38017);const u=(0,s.default)("div",{target:"exhfy940"})({pointerEvents:"none",position:"fixed",zIndex:1e3},"label:DivDoubleTapContainer;"),c=(0,l.i7)({"0%":{opacity:"1",transform:"scale(1.18)"},"14%":{opacity:"1",transform:"scale(.9)"},"21%":{opacity:"1",transform:"scale(1)"},"58%":{opacity:"1",transform:"scale(1)"},"100%":{opacity:"0",transform:"scale(1.93)"}}),p=(0,s.default)(d.A,{target:"exhfy941"})({animation:`${c} 1400ms`,width:"120px",height:"120px"},"label:StyledLikeIcon;");var v=r(67518);const h=function({x:e,y:t,styledCache:r}){const n=Math.floor(61*Math.random()-30),i=(0,o.jsx)(u,{style:{left:e-60,top:t-60,transform:`rotate(${n}deg)`},children:(0,o.jsx)(p,{})});return r?(0,o.jsxs)(v.C,{value:r,children:[" ",i," "]}):i};class y{constructor(e,t,r=document,n=void 0){this.x=e,this.y=t,this.documentObj=r,this.styledCache=n,this.el=this.documentObj.createElement("div")}emit(){var e;try{(null!==(e=this.documentObj[null===a.e||void 0===a.e?void 0:a.e.fullscreenElement])&&void 0!==e?e:this.documentObj.body).appendChild(this.el),(0,i.render)((0,n.createElement)(h,{x:this.x,y:this.y,styledCache:this.styledCache}),this.el),window.setTimeout((()=>{this.destroy()}),1400)}catch(e){console.error(e)}}destroy(){var e;try{(0,i.unmountComponentAtNode)(this.el),(null!==(e=this.documentObj[null===a.e||void 0===a.e?void 0:a.e.fullscreenElement])&&void 0!==e?e:this.documentObj.body).removeChild(this.el)}catch(e){console.error(e)}}}},1096:(e,t,r)=>{r.d(t,{H:()=>s});var n=r(24643),i=r(57432),a=r.n(i),o=r(40099),l=r(61853);const s=({width:e=160,height:t=160,loop:r=!1,onComplete:i=a(),autoplay:s=!0,animationData:d,customStyle:u={}})=>{const c=(0,o.useMemo)((()=>({loop:r,autoplay:s,animationData:d,rendererSettings:{preserveAspectRatio:"xMidYMid slice"}})),[d,s,r]),p=(0,o.useMemo)((()=>[{eventName:"complete",callback:i}]),[i]);return(0,n.jsx)(l.J,{width:e,height:t,options:c,eventListeners:p,customStyle:u})}},61853:(e,t,r)=>{r.d(t,{J:()=>d});var n=r(24643),i=r(17715),a=r.n(i),o=r(40099);function l(e){let t;return t="number"==typeof e?`${e}px`:e||"100%",t}const s=(0,r(62186).default)("div",{target:"e1b0r8240"})((({width:e,height:t})=>({width:l(e),height:l(t),overflow:"hidden",margin:"0 auto",outline:"none"})),"label:DivContainer;"),d=(0,o.memo)((function(e){const{width:t,height:r,className:i,options:l,eventListeners:d=[],lottieRef:u,containerRef:c,customStyle:p={}}=e,v=(0,o.useRef)(null),h=(0,o.useRef)(null);return(0,o.useEffect)((()=>(h.current=a().loadAnimation(Object.assign({container:v.current,renderer:"svg"},l)),u&&(u.current=h.current),()=>{var e;null===(e=h.current)||void 0===e||e.destroy(),h.current=null,u&&(u.current=null)})),[l]),(0,o.useEffect)((()=>(d.forEach((({eventName:e,callback:t})=>{var r;null===(r=h.current)||void 0===r||r.addEventListener(e,t)})),()=>{d.forEach((({eventName:e,callback:t})=>{var r;null===(r=h.current)||void 0===r||r.removeEventListener(e,t)}))})),[d]),(0,n.jsx)(s,{width:t,height:r,className:i,style:p,ref:e=>{v.current=e,c&&(c.current=e)}})}))},51664:(e,t,r)=>{r.d(t,{AL:()=>v,Fu:()=>p,r$:()=>c});var n=r(58632),i=r(41271),a=r(73580),o=r(40099),l=r(93608),s=r(72688),d=r(30662),u=r(50970);function c(e){const t=(0,i.P)(u.L,{dependencies:[],selector:e=>{var t;return null===(t=e.appContext)||void 0===t?void 0:t.user}});return{isShowLive:(0,o.useMemo)((()=>Boolean((null==e?void 0:e.roomId)&&"0"!==(null==e?void 0:e.roomId)&&(null==t?void 0:t.uid)!==e.id)),[null==t?void 0:t.uid,null==e?void 0:e.id,null==e?void 0:e.roomId]),src:null==e?void 0:e.avatarThumb,uniqueId:null==e?void 0:e.uniqueId,pureLivePath:e?(0,s.G2o)({uniqueId:null==e?void 0:e.uniqueId,secUid:null==e?void 0:e.secUid}):""}}function p({reportTrigger:e,user:t,enterMethod:r,autoReport:n,reportValidator:i,once:s,liveExtraParams:u}){const c=(0,a.Nj)(d.tG),[p,h]=(0,o.useState)(!1),y=(0,o.useMemo)((()=>{var e,n;return Object.assign({anchor_id:null!==(e=null==t?void 0:t.id)&&void 0!==e?e:"",follow_status:null!==(n=null==t?void 0:t.relation)&&void 0!==n?n:-1,room_id:null==t?void 0:t.roomId,enter_from_merge:l.f.commonParams.page_name,enter_method:r,action_type:"click"},u)}),[r,u,null==t?void 0:t.id,null==t?void 0:t.relation,null==t?void 0:t.roomId]),m=(0,o.useCallback)((()=>{p&&s||(c.handleLiveEntranceShow(y),h(!0))}),[p,c,s,y]);return(0,o.useEffect)((()=>{n&&e&&i()&&m()}),[e]),{handleExposure:m,teaParams:v({user:t,enterMethod:r}),reportParams:y}}function v(e){var{user:t,enterMethod:r}=e,i=(0,n.__rest)(e,["user","enterMethod"]);return(0,o.useMemo)((()=>{var e,n,a;return Object.assign({anchor_id:null!==(e=null==t?void 0:t.id)&&void 0!==e?e:"",follow_status:null!==(n=null==t?void 0:t.relation)&&void 0!==n?n:-1,room_id:null==t?void 0:t.roomId,enter_from_merge:l.f.commonParams.page_name,enter_from:l.f.commonParams.page_name,action_type:"click",enter_method:r,to_user_id:null!==(a=null==t?void 0:t.id)&&void 0!==a?a:""},i)}),[t,r,i])}},80131:(e,t,r)=>{r.d(t,{r:()=>S,M:()=>P});var n=r(24643),i=r(41271),a=r(40099),o=r(25616),l=r(62047),s=r(57432),d=r.n(s);const u=JSON.parse('{"v":"5.9.6","fr":60,"ip":0,"op":35,"w":40,"h":20,"nm":"Lottie_ic_forward","ddd":0,"assets":[],"layers":[{"ddd":0,"ind":1,"ty":4,"nm":"“ic_forward","sr":1,"ks":{"o":{"a":1,"k":[{"i":{"x":[0.667],"y":[1]},"o":{"x":[0.333],"y":[0]},"t":4,"s":[90],"e":[90]},{"i":{"x":[0.667],"y":[1]},"o":{"x":[0.333],"y":[0]},"t":8,"s":[90],"e":[50]},{"t":19}],"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":1,"k":[{"i":{"x":0.2,"y":1},"o":{"x":0.4,"y":0},"t":0,"s":[25,10,0],"e":[32,10,0],"to":[1.167,0,0],"ti":[-1.167,0,0]},{"t":14}],"ix":2,"l":2},"a":{"a":0,"k":[4,7,0],"ix":1,"l":2},"s":{"a":0,"k":[100,100,100],"ix":6,"l":2}},"ao":0,"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[0.107,0],[0.081,0.081],[0,0],[-0.163,0.162],[0,0],[0,0],[-0.163,0.163],[0,0],[-0.107,0],[-0.082,-0.082],[0,0],[0.163,-0.163],[0,0]],"o":[[-0.107,0],[0,0],[-0.163,-0.162],[0,0],[0,0],[-0.163,-0.163],[0,0],[0.081,-0.082],[0.107,0],[0,0],[0.163,0.163],[0,0],[-0.082,0.081]],"v":[[-2.83,6.667],[-3.125,6.545],[-3.714,5.955],[-3.714,5.366],[1.651,0],[-3.714,-5.366],[-3.714,-5.955],[-3.125,-6.544],[-2.83,-6.667],[-2.536,-6.544],[3.714,-0.294],[3.714,0.295],[-2.536,6.545]],"c":true},"ix":2},"nm":"路径 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[1,0.999998743394,1,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"填充 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[3.836,7.333],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"变换"}],"nm":"组 1","np":4,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":35,"st":0,"ct":1,"bm":0},{"ddd":0,"ind":2,"ty":4,"nm":"“ic_forward”轮廓 3","sr":1,"ks":{"o":{"a":1,"k":[{"i":{"x":[0.833],"y":[1]},"o":{"x":[0.436],"y":[0]},"t":4,"s":[50],"e":[50]},{"i":{"x":[0.667],"y":[1]},"o":{"x":[0.333],"y":[0]},"t":14,"s":[50],"e":[90]},{"t":25}],"ix":11},"r":{"a":0,"k":0,"ix":10},"p":{"a":1,"k":[{"i":{"x":0.2,"y":1},"o":{"x":0.4,"y":0},"t":6,"s":[18,10,0],"e":[25,10,0],"to":[1.167,0,0],"ti":[-1.167,0,0]},{"t":20}],"ix":2,"l":2},"a":{"a":0,"k":[4,7,0],"ix":1,"l":2},"s":{"a":0,"k":[100,100,100],"ix":6,"l":2}},"ao":0,"shapes":[{"ty":"gr","it":[{"ind":0,"ty":"sh","ix":1,"ks":{"a":0,"k":{"i":[[0.107,0],[0.081,0.081],[0,0],[-0.163,0.162],[0,0],[0,0],[-0.163,0.163],[0,0],[-0.107,0],[-0.082,-0.082],[0,0],[0.163,-0.163],[0,0]],"o":[[-0.107,0],[0,0],[-0.163,-0.162],[0,0],[0,0],[-0.163,-0.163],[0,0],[0.081,-0.082],[0.107,0],[0,0],[0.163,0.163],[0,0],[-0.082,0.081]],"v":[[-2.83,6.667],[-3.125,6.545],[-3.714,5.955],[-3.714,5.366],[1.651,0],[-3.714,-5.366],[-3.714,-5.955],[-3.125,-6.544],[-2.83,-6.667],[-2.536,-6.544],[3.714,-0.294],[3.714,0.295],[-2.536,6.545]],"c":true},"ix":2},"nm":"路径 1","mn":"ADBE Vector Shape - Group","hd":false},{"ty":"fl","c":{"a":0,"k":[1,0.999998743394,1,1],"ix":4},"o":{"a":0,"k":100,"ix":5},"r":1,"bm":0,"nm":"填充 1","mn":"ADBE Vector Graphic - Fill","hd":false},{"ty":"tr","p":{"a":0,"k":[3.836,7.333],"ix":2},"a":{"a":0,"k":[0,0],"ix":1},"s":{"a":0,"k":[100,100],"ix":3},"r":{"a":0,"k":0,"ix":6},"o":{"a":0,"k":100,"ix":7},"sk":{"a":0,"k":0,"ix":4},"sa":{"a":0,"k":0,"ix":5},"nm":"变换"}],"nm":"组 1","np":4,"cix":2,"bm":0,"ix":1,"mn":"ADBE Vector Group","hd":false}],"ip":0,"op":35,"st":0,"ct":1,"bm":0}],"markers":[]}');var c=r(1096);const p=({width:e=40,height:t=20,loop:r=!0,onComplete:i=d(),autoplay:a=!0})=>(0,n.jsx)(c.H,{width:e,height:t,onComplete:i,autoplay:a,loop:r,animationData:u});var v=r(60445),h=r(75431),y=r(62186),m=r(72153);const g=(0,h.i7)({"0%":{opacity:0},"5%":{opacity:1},"100%":{opacity:1}}),f=(0,y.default)("div",{target:"e1jh5nxw0"})({position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:"144px",height:"144px",display:"flex",justifyContent:"center",alignItems:"center",zIndex:5},"label:DivAnimationIconWrapper;"),_=(0,y.default)(f,{target:"e1jh5nxw1"})((({theme:{colors:e},isBack:t})=>({width:"300px",top:"unset",bottom:"81px",transform:"translate(-50%, 0)",height:"40px",padding:"8px 16px",paddingInlineEnd:t?"16px":"8px",paddingInlineStart:t?"8px":"16px",display:"inline-flex",flexDirection:t?"row-reverse":"row",borderRadius:"8px",background:e.ConstBGInverse2,animation:`${g} 2000ms linear`})),"label:StyledAnimationWrapper;"),b=(0,y.default)("span",{target:"e1jh5nxw2"})((({theme:e})=>(0,m.zy)({theme:e,typography:"P3",fontFamily:"TikTokFont",fontWeight:"semiBold",color:"ConstTextInverse2"})),"label:SpanForwardText;"),k=(0,y.default)("div",{target:"e1jh5nxw3"})((({isBack:e=!1,theme:{direction:t}})=>({width:"40px",height:"20px",display:"flex",justifyContent:"center",alignItems:"center",transform:`rotateZ(${e?"rtl"===t?0:180:"rtl"===t?180:0}deg)`,marginInlineStart:e?"unset":"-8px",marginInlineEnd:e?"-8px":"unset"})),"label:DivSeekAnimationWrapper;");function P(e){const t=(0,o.s)(),r="backward"===e;return(0,a.useMemo)((()=>"none"!==e?(0,n.jsxs)(_,{isBack:r,children:[(0,n.jsx)(b,{children:t("forward"===e?"pc_web_skip_forward_5_sec":"pc_web_skip_backward_5_sec",{number:l.S})}),(0,n.jsx)(k,{isBack:r,children:(0,n.jsx)(p,{loop:!0})})]}):null),[r,e,t])}const S=()=>{const{seekType:e}=(0,i.P)(v.aL,{selector:e=>({seekType:e.seekType}),dependencies:[]});return{seekingTips:P(e)}}},42357:(e,t,r)=>{r.d(t,{e:()=>o});var n=r(38259),i=r(57432),a=r.n(i);const o=(0,n.$)("CoreContentContext@tiktok/fe-shared")({armCoreContentEvent:a()})},95628:(e,t,r)=>{r.d(t,{e:()=>m});var n,i=r(58632),a=r(24643),o=r(40099),l=r(67353),s=r(92701),d=r(53701),u=r(1967),c=r(14283),p=r(42983),v=r(75248),h=r(72263);!function(e){e.NoInteract="failed because the user didn't interact with the document first.",e.SafariNoInteract="The request is not allowed by the user agent or the platform in the current context"}(n||(n={}));const y=e=>({buffered:null==e?void 0:e.buffered,currentSrc:null==e?void 0:e.currentSrc,currentTime:null==e?void 0:e.currentTime,duration:null==e?void 0:e.duration,readyState:null==e?void 0:e.readyState,error:null==e?void 0:e.error,volume:null==e?void 0:e.volume,muted:null==e?void 0:e.muted}),m=(0,o.memo)((0,o.forwardRef)((function(e,t){var{src:r,playProgress:n,horizontal:m,muteSetting:g,onUnmount:f,onEnded:_,onWaiting:b,disableDownload:k=!0,itemMute:P=!1,metrics:S=null,bitrate:C,hevcTest:T,bitrateInfo:w}=e,x=(0,i.__rest)(e,["src","playProgress","horizontal","muteSetting","onUnmount","onEnded","onWaiting","disableDownload","itemMute","metrics","bitrate","hevcTest","bitrateInfo"]);const E=(0,o.useRef)(null),R=(0,o.useRef)(!1),{mute:M,volume:A,playing:I}=(0,p.O2)(g),{setMute:L}=(0,v.S4)(),j=(0,o.useRef)({time:-1,size:-1}),O=(0,o.useMemo)((()=>{if((0,c.f)())return{url:r,codecType:"h264"};const e=null===l.bt||void 0===l.bt?void 0:l.bt.useHevc("desktop"),t=null!=T?T:l.bt.hevcTest;if(t.open=e&&t.open,!w||0===(null==w?void 0:w.length))return{url:r,codecType:"h264"};const{src:n,codecType:i}=(0,s.Hg)({hevcTest:t,bitrateInfo:w,downgradeUrl:r,backupDomain:!0});return{url:n,codecType:i}}),[w,r]);(0,o.useImperativeHandle)(t,(()=>{const e=E.current;return{play:()=>(0,i.__awaiter)(this,void 0,void 0,(function*(){try{yield null==e?void 0:e.play()}catch(e){}})),pause:()=>{try{h.A.emit("video_pause",{itemId:null!=r?r:""}),null==e||e.pause()}catch(e){}},seek:t=>{if(e){h.A.emit("video_seek",{itemId:null!=r?r:""});const{duration:n}=e;e.currentTime=n*t}},seekTime:t=>{e&&(e.currentTime=t)},onSeeked:t=>{null==e||e.addEventListener("seeked",t)},onSeeking:t=>{null==e||e.addEventListener("seeking",t)},onTimeUpdate:t=>{null==e||e.addEventListener("timeupdate",(()=>{var r,n;const i=null!==(r=e.currentTime)&&void 0!==r?r:0,a=null!==(n=e.duration)&&void 0!==n?n:0;t(i/a,i,a)}))},onCanPlay:t=>{null==e||e.addEventListener("canplay",t)},getPlayerAttributes:()=>y(e)}}));const V=(0,o.useCallback)(((e=0)=>(0,i.__awaiter)(this,void 0,void 0,(function*(){var t,r,n;if(!(e>=3))try{yield null===(t=E.current)||void 0===t?void 0:t.play()}catch(t){const i=null!==(r=null==t?void 0:t.message)&&void 0!==r?r:"";(null!==(n=i.match("failed because the user didn't interact with the document first."))&&void 0!==n?n:i.match("The request is not allowed by the user agent or the platform in the current context"))?(L(!0),setTimeout((()=>{V(e+1)}),0)):V(e+1)}}))),[L]);(0,o.useEffect)((()=>{E.current&&(E.current.volume=A)}),[A]),(0,o.useEffect)((()=>{V(),E.current&&Math.abs(E.current.currentTime-n)>.2&&(E.current.currentTime=n)}),[n,V]),(0,o.useEffect)((()=>{var e;I?R.current&&(R.current=!1,V()):(R.current=!0,null===(e=E.current)||void 0===e||e.pause())}),[I,V]),(0,o.useEffect)((()=>{const e=E.current;return()=>{j.current.time>0&&j.current.size>0&&(0,d.a)({time:j.current.time,size:j.current.size}),null==f||f(y(e))}}),[]);const B=(0,o.useCallback)((e=>{e.preventDefault()}),[]);(0,o.useEffect)((()=>{const e=E.current;return k&&(null==e||e.addEventListener("contextmenu",B)),()=>{null==e||e.removeEventListener("contextmenu",B)}}),[E,B,k]);const D=(0,o.useCallback)((e=>{null==b||b(e)}),[b]),F=(0,o.useCallback)((e=>{null==_||_(e),V(),h.A.emit("video_replay",{itemId:null!=r?r:""})}),[_,V,r]),U=(0,o.useCallback)((()=>{if(E.current){const e=E.current;if(C&&C>0){let t=0;for(let r=0;r<e.buffered.length;r++)t+=e.buffered.end(r)-e.buffered.start(r);const r=t*C/8;j.current={time:t,size:r}}}}),[C]);return(0,a.jsx)(u.CZ,Object.assign({horizontal:m,ref:E,src:O.url},x,{muted:P||M,playsInline:!0,autoPlay:!0,onEnded:F,onWaiting:D,onProgress:U}))})))},32098:(e,t,r)=>{r.d(t,{K:()=>o});var n=r(93341),i=r(90341),a=r(40099);const o=e=>{const{updateGlobalVVCount:t}=(0,n.nr)(),r=(0,i.eu)(),o=(0,a.useCallback)((()=>{t(e)}),[t,e]),l=(0,a.useCallback)((()=>{(4===e||2===e&&r)&&t(e)}),[t,e]);return(0,a.useMemo)((()=>({handleBreakCount:o,handleVvCountOnEnd:l})),[e])}},48180:(e,t,r)=>{r.d(t,{o:()=>D});var n=r(24643),i=r(40099),a=r(73580),o=r(41271),l=r(34099),s=r(57431),d=r(38739),u=r(15343),c=r(27111),p=r(43485),v=r(90118),h=r(11654),y=r(63438),m=r(33805),g=r(90341),f=r(93341),_=r(75248),b=r(88920),k=r(35323),P=r(93987),S=r(97086),C=r(53438),T=r(67169),w=r(49057),x=r(42357),E=r(99282),R=r(32545),M=r(2853),A=r(52333),I=r(32098),L=r(72263),j=r(99147),O=r(26740);let V=null,B=null;const D=(0,i.memo)((0,i.forwardRef)((function({id:e,url:t,index:r,mode:D,horizontal:F,muted:U,duration:N,playbackRate:H=1,e2eTag:Q,bitrateInfo:$,bitrate:z,autoPlay:q=!0,autoReplay:W=!0,containerStyle:G,onVideoPause:K,onVideoPlaying:Y,onVideoPlay:J,onResolutionReady:Z,onVideoEnded:X,onVideoError:ee,onTimeUpdate:te,onVolumeChange:re,onVideoCanPlay:ne,posterConfig:ie,teaConfig:ae,videoQualityConfig:oe,fetchPriority:le="auto",subtitleList:se,curSubtitle:de,onSubtitleCallback:ue,renderState:ce=c.R.ACTIVE},pe){var ve,he,ye;const me=(0,i.useRef)(null),ge=(0,i.useRef)(!0),fe=(0,g.J3)(),{setMute:_e,setVolume:be,setCanAutoPlay:ke}=(0,_.S4)(),Pe=(0,_.ol)(),Se=null!==(ve=null==ae?void 0:ae.playMode)&&void 0!==ve?ve:D;V||(V=(0,l.V)()),B||(B=(0,s.x)());const Ce=(0,a.Nj)(d.Gs),Te=(0,a.Nj)(u.AU),we=(0,a.Nj)(h.V$),{armCoreContentEvent:xe}=(0,i.useContext)(x.e),Ee=(0,i.useCallback)((()=>{null==xe||xe(),we.reportActualFMP(),j.e.handleActualFMP()}),[xe,we]),Re=U||y.T5[D].forceMute,Me=(0,_.i3)(),Ae=1===D?Re:Re||Me,Ie=(0,_.R4)(),Le=(0,f.w)(r,D,e);(0,O.w)({isCurrentVideo:Le,index:r,mode:D});const je=[c.R.ACTIVE,c.R.BACKUP,c.R.RETAIN].includes(ce)&&0===Se,Oe=(0,i.useMemo)((()=>(0,S.fU)()?"":(0,m.N2)(window.location.pathname)),[]),Ve=null!==(he=(0,g.eu)())&&void 0!==he&&he,Be=(0,f.hM)(),De=(0,_.i3)(),Fe=(0,C.Hs)(e),Ue=(0,C.yy)(e,r),Ne=(0,E.WH)(e),He=(0,b.HL)(),Qe=(0,i.useMemo)((()=>{let e;return e={isAutoScroll:Ve,resolution:Be,mute:De,itemMute:U,videoDimensionParams:Fe,videoContentParams:Ue,playModeForTea:Se,pathId:Oe,vqscore:oe&&oe.vqscore?oe.vqscore:0,claTeaParams:Ne},e}),[Ve,Be,De,U,Fe,Se,Oe,oe,Ue,Ne]),$e=(0,o.P)(A.k);p._.updateItems($e),(0,i.useEffect)((()=>{p._.updateItems($e)}),[$e]),(0,i.useEffect)((()=>{Le&&(0,k.uQ)(P.Y.PlayerMounted)}),[Le]);const[ze,qe]=(0,i.useState)(!1),We=(0,T.jj)();(0,i.useEffect)((()=>{me&&me.current&&(We&&q||8===D?me.current.play():(me.current.pause(),Le&&!We&&Ce.triggerPause({enter_method:"switch_tab",playMode:Se})))}),[q,We,Le,Se,D]);const Ge=V,{region:Ke,wid:Ye,user:Je,isTTP:Ze,odinId:Xe}=B||{},{abTestVersion:et}=null!==(ye=(0,w.W)((()=>["abTestVersion"]),[]))&&void 0!==ye?ye:{},tt=(0,b.iM)("desktop"),rt=(0,b.Yu)(),nt=(0,b.pd)("desktop"),it=(0,b.ZC)(),at=(0,i.useMemo)((()=>{var e;return{tea:{channel:Ge.teaChannel,domain:Ge.tea,type:null!==(e=Ge.teaChannelType)&&void 0!==e?e:"tcpy"},region:Ke,webId:Ye,uid:(null==Je?void 0:Je.uid)||Xe||Ye,isLogin:!!Je,abTestVersion:et?`${et.versionName},${nt}`:nt,hevcAbTestVersion:nt,vIndex:null!=r?r:-1,isTTP:Ze}}),[Ge,Ye,Ke,Je,et,nt,Ze]);(0,i.useImperativeHandle)(pe,(()=>({play:e=>{var t;null===(t=me.current)||void 0===t||t.play(),e&&Ce.triggerResume({enter_method:"click_resume",playMode:Se})},pause:()=>{var t;null===(t=me.current)||void 0===t||t.pause(),L.A.emit("video_pause",{itemId:e,playMode:D})},seek:t=>{var r,n;let i=0;const a=null===(r=me.current)||void 0===r?void 0:r.getAttributes();a&&(i=a.duration),null===(n=me.current)||void 0===n||n.seek(i*t),L.A.emit("video_seek",{itemId:e,playMode:D})},seekTime:e=>{var t;null===(t=me.current)||void 0===t||t.seek(e)},getFullscreen:e=>{var t;null===(t=me.current)||void 0===t||t.enterFullscreen(e)},exitFullscreen:e=>{var t;null===(t=me.current)||void 0===t||t.exitFullscreen(e)},updatePlayer:e=>{var t;null===(t=me.current)||void 0===t||t.updatePlayer(e)},changeResolution:e=>{var t;null===(t=me.current)||void 0===t||t.changeResolution(e)},getResolutionInfo:()=>{var e;return null===(e=me.current)||void 0===e?void 0:e.getResolutionInfo()},replay:()=>{var e;null===(e=me.current)||void 0===e||e.replay()},get currentTime(){var e;const t=null===(e=me.current)||void 0===e?void 0:e.getAttributes();return t?t.currentTime:0},get duration(){var e;const t=null===(e=me.current)||void 0===e?void 0:e.getAttributes();return t?t.duration:0},get currentCanPlay(){return Le&&ze}})),[ze,Le,Se]);const{loading:ot,handleCanPlayWithLoading:lt,handlePauseWithLoading:st,handlePlayingWithLoading:dt,handleWaitingWithLoading:ut}=(0,T.iJ)({isCurrentVideo:Le}),ct=(0,i.useCallback)((e=>{lt(),qe(!0),null==ne||ne(e),Pe&&me&&me.current&&ge.current&&(me.current.seek(Pe),ge.current=!1)}),[lt,ne,Pe]),pt=(0,i.useCallback)((()=>{var e,t,r;const n=null===(e=me.current)||void 0===e?void 0:e.getAttributes(),i=null!==(t=null==n?void 0:n.currentTime)&&void 0!==t?t:0,a=null!==(r=null==n?void 0:n.duration)&&void 0!==r?r:0;let o=0;a&&(o=i/a),null==te||te(o,i,a),j.e.handleFirstFrameVideo()}),[te]),vt=(0,i.useCallback)(((e,t)=>{null==re||re(e,t)}),[re,_e,be]),ht=(0,i.useCallback)((e=>{var t;null==ee||ee(e),fe.setPlayerError();const r=null===(t=me.current)||void 0===t?void 0:t.getAttributes();if(r){let e=-1,t="";const n=r.readyState,i=r.networkState;r.error&&(e=r.error.code,t=r.error.message),we.emitEvent("video_playback_error",{code:e},{errorMessage:t,errorCode:String(e),readyState:String(n),networkState:String(i)})}}),[ee,we]),yt=(0,i.useCallback)((e=>{st(),null==K||K(e)}),[K,st]),{handleVvCountOnEnd:mt,handleBreakCount:gt}=(0,I.K)(D),ft=(0,i.useCallback)((()=>{gt()}),[]),_t=(0,i.useCallback)((t=>{mt(),null==X||X(t),W&&L.A.emit("video_replay",{itemId:e,playMode:D})}),[X,W,e,D]),bt=(0,i.useCallback)((e=>{dt(),null==Y||Y(e),ke(!0)}),[Y,dt]),kt=(0,i.useCallback)((()=>{ut()}),[ut]),Pt=(0,i.useCallback)((e=>{const{errorCode:t,errorMessage:r,logid:n}=e;we.emitEvent("video_play_end",{count:1},{is_success:`${0===t}`,error_code:String(t),error_msg:r,logid:n})}),[we]),St=F||2===D||3===D||4===D||6===D||5===D;return(0,n.jsxs)(M.Le,{horizontal:F,mode:D,style:G,children:[(null==ie?void 0:ie.poster)?(0,n.jsx)(M.R,{horizontal:St,mode:D,src:ie.poster,alt:ie.desc,loading:ie.lazyLoading?"lazy":"eager",style:ie.style,onLoad:Ee,fetchPriority:le}):(null==ie?void 0:ie.videoCover)?(0,n.jsx)(R.x,{video:ie.videoCover,objectFit:St?"contain":"cover",style:ie.style,alt:ie.desc,onLoad:Ee,fetchPriority:le}):null,(Le||je)&&(0,n.jsxs)(M.Ec,{horizontal:St,"data-e2e":Q,children:[(0,n.jsx)(v.xk,{ref:me,bitrateInfo:$,defaultBitrate:z,duration:N,autoplay:q,loop:W,oncanplay:ct,onplay:J,onwaiting:kt,onended:_t,ontimeupdate:pt,onvolumechange:vt,onerror:ht,onpause:yt,onbreak:ft,onplaying:bt,onVideoPlayEnd:Pt,onResolutionReady:Z,teaParams:null==ae?void 0:ae.params,mode:D,id:e,volume:Ie,muted:Ae,playbackRate:H,url:t,extraMetricsParams:Qe,videoPlayReport:Ce,videoExperienceReport:Te,appLoggerParams:at,useHEVC:tt.open,hevcTest:tt,playbackAbTestInfo:Object.assign(Object.assign({},rt),it),subtitleList:se,curSubtitle:de,onSubtitleCallback:ue,renderState:ce,onAutoplayPrevented:()=>{He&&ke(!1)}}),ot&&(0,n.jsx)(M.K3,{})]})]})})))},2853:(e,t,r)=>{r.d(t,{Ec:()=>l,K3:()=>s,Le:()=>a,R:()=>o});var n=r(62186),i=r(84827);const a=(0,n.default)("div",{target:"ec2xuek0"})((({horizontal:e,mode:t,theme:{colors:r}})=>[{width:"100%",height:"100%",overflow:"hidden",position:"relative",backgroundColor:r.BGPlaceholderDefault,backgroundSize:e?"contain":"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"},2===t||1===t||3===t||5===t?{display:"flex",alignItems:"center",justifyContent:"center"}:null]),"label:DivContainer;"),o=(0,n.default)("img",{target:"ec2xuek1"})((({horizontal:e,mode:t,fetchPriority:r="auto"})=>2!==t&&3!==t&&4!==t&&5!==t?{width:"100%",height:"100%",objectFit:"cover",fetchPriority:r}:{width:"100%",height:"100%",objectFit:e?"contain":"cover",fetchPriority:r}),"label:ImgPoster;"),l=(0,n.default)("div",{target:"ec2xuek2"})((({horizontal:e=!0})=>({position:"absolute",left:0,top:0,width:"100%",height:"100%","& .tiktok-web-player":{width:"100%",height:"100%"},"& .xgplayer video":{display:"block",width:"100%",height:"100%",objectFit:e?"contain":"cover"},"& .tiktok-web-player video":{display:"block",width:"100%",height:"100%",objectFit:e?"contain":"cover"}})),"label:DivBasicPlayerWrapper;"),s=(0,n.default)(i.R,{target:"ec2xuek3"})({position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:3},"label:StyledLoading;")},39743:(e,t,r)=>{r.d(t,{K:()=>Ne});var n=r(24643),i=r(40099),a=r(88920),o=r(73580),l=r(38739),s=r(15343),d=r(96959);class u{constructor(e="webapp",{playReport:t,experienceReport:r}){this.project=e,this._platform="",this._url="",this._playMode=0,this._videoQualityHandleParams=null,this._videoPlayHandleParams=null,this._playbackAttributes=null,this.isIos=!1,this.isAndroid=!1,this.videoExperienceReport=r,this.videoPlayReport=t,this.videoQualityReport=new d.re,this.renderState=""}set platform(e){this._platform=e,this.isIos="ios"===this._platform,this.isAndroid="android"===this._platform}set playMode(e){this._playMode=e}set url(e){this._url=e}set videoQualityHandleParams(e){this._videoQualityHandleParams=e}set videoPlayHandleParams(e){this._videoPlayHandleParams=e}set playbackAttributes(e){this._playbackAttributes=e}updateMetricsParams({playbackAttribute:e,videoQualityParams:t}){e&&(this.playbackAttributes=e),t&&(this.videoQualityHandleParams=t)}onPlay(){}onPlaying(){this.videoExperienceReport.reportVideoInteract({endTime:Date.now(),videoSource:this._url})}onPause(){this._videoPlayHandleParams&&this._playbackAttributes&&this.videoPlayReport.handlePause(Object.assign(Object.assign({},this._videoPlayHandleParams),this._playbackAttributes))}onWaiting(){this._videoPlayHandleParams&&this._playbackAttributes&&this.videoPlayReport.handleWaiting(Object.assign(Object.assign({},this._videoPlayHandleParams),this._playbackAttributes))}onLoadStart(){}onLoadedData(){}onCanPlay(){this.videoExperienceReport.getCurrentPageReport()||(this.videoExperienceReport.reportVideoFirstScreen({endTime:Date.now(),videoSource:this._url}),this.videoExperienceReport.reportVideoAddition({endTime:Date.now(),videoSource:this._url}))}onCanPlayThrough(){this.isIos&&(this.videoExperienceReport.getCurrentPageReport()||(this.videoExperienceReport.reportVideoFirstScreen({endTime:Date.now(),videoSource:this._url}),this.videoExperienceReport.reportVideoAddition({endTime:Date.now(),videoSource:this._url})))}onTimeUpdate(){var e;this._videoQualityHandleParams&&this._videoPlayHandleParams&&this._playbackAttributes&&("webapp-mobile"===this.project?this.videoPlayReport.handleTimeUpdate(Object.assign(Object.assign(Object.assign({},this._videoPlayHandleParams),this._playbackAttributes),{render_state:this.renderState}),!0):this.videoPlayReport.handleTimeUpdate(Object.assign(Object.assign(Object.assign({},this._videoPlayHandleParams),this._playbackAttributes),{render_state:this.renderState}))),!this.videoExperienceReport.getFirstFrameReport()&&this._playbackAttributes&&this.videoExperienceReport.reportVideoFirstFrame(null!==(e=this._playbackAttributes.currentTime)&&void 0!==e?e:-1)}onError(){this._videoPlayHandleParams&&this.videoPlayReport.handleError(this._videoPlayHandleParams)}onEnded(){this._videoPlayHandleParams&&this.videoPlayReport.handleEnded(this._videoPlayHandleParams)}onSlideChange(e){var t,r;0!==(null!==(r=null===(t=this._playbackAttributes)||void 0===t?void 0:t.duration)&&void 0!==r?r:0)&&this._videoPlayHandleParams&&this.videoPlayReport.handlePlayTime(this._videoPlayHandleParams)}onUnmount(e){this.isIos||this.onSlideChange(e)}onProgress(e,t){}mseCDNCache(e){}pauseAction(e){this.videoPlayReport.triggerPause({enter_method:e,playMode:this.playMode})}setPlayerType(e){}setRenderState(e){this.renderState=e}updateFrameInfo(e){}}var c=r(75248),p=r(90341),v=r(97086),h=r(93341),y=r(11654),m=r(67169),g=r(60484),f=r(63438),_=r(32545),b=r(42357),k=r(95628),P=r(1967),S=r(99147),C=r(26740);const T=(0,i.memo)((0,i.forwardRef)((function({poster:e,videoCover:t,lazyLoading:r=!0,horizontal:a,playUrl:d,id:T,teaParams:w,index:x,mode:E,itemMute:R,desc:M,topSearchQueryAfterViewWord:A,onVideoPause:I,onVideoEnded:L,onVideoError:j,e2eTag:O,onTimeUpdate:V,subtitleStruct:B,disableDownload:D=!0,posterStyle:F,bitrateInfo:U,fetchPriority:N="auto"},H){const{currentVideo:Q,defaultResolution:$}=(0,h.MY)(),z=(0,c.ol)(),q=(0,p.eu)(),W=(0,i.useRef)(null),G=(0,i.useRef)(null),K=(0,o.Nj)(l.Gs),Y=(0,o.Nj)(s.AU),[J,Z]=(0,i.useState)(!1),X=(0,o.Nj)(y.V$),ee=(0,i.useMemo)((()=>(0,v.fU)()?null:new u("webapp-desktop",{playReport:K,experienceReport:Y})),[Y,K]),te=(0,i.useCallback)((()=>{var e,t;null===(t=null===(e=W.current)||void 0===e?void 0:e.play)||void 0===t||t.call(e)}),[]),re=(0,i.useCallback)((()=>{var e,t;null===(t=null===(e=W.current)||void 0===e?void 0:e.pause)||void 0===t||t.call(e)}),[]),ne=(0,i.useMemo)((()=>{if(!Q)return!1;const{id:e,index:t,mode:r}=Q;return e===T&&t===x&&r===E}),[T,x,E,Q]);(0,i.useEffect)((()=>{null==ee||ee.setPlayerType(2)}),[ee]),(0,i.useImperativeHandle)(H,(()=>({play:e=>{te(),G.current=!0,e&&K.triggerResume({enter_method:"click_resume",playMode:E})},pause:()=>{re(),G.current=!1,K.triggerPause({enter_method:"click_pause",playMode:E,currentBackendSourceEventTracking:w.currentBackendSourceEventTracking})},seek:e=>{var t;null===(t=W.current)||void 0===t||t.seek(e)},seekTime:e=>{var t;null===(t=W.current)||void 0===t||t.seekTime(e)},onSeeked:e=>{var t;null===(t=W.current)||void 0===t||t.onSeeked(e)},onSeeking:e=>{var t;null===(t=W.current)||void 0===t||t.onSeeking(e)},onTimeUpdate:e=>{var t;null===(t=W.current)||void 0===t||t.onTimeUpdate(e)},getFullscreen:()=>{},exitFullscreen:()=>{},replay:()=>{te(),G.current=!0},updatePlayer:e=>{},changeResolution:e=>{},getResolutionInfo:()=>{},get currentTime(){var e,t;return null!==(t=null===(e=W.current)||void 0===e?void 0:e.getPlayerAttributes().currentTime)&&void 0!==t?t:0},get duration(){var e,t;return null!==(t=null===(e=W.current)||void 0===e?void 0:e.getPlayerAttributes().duration)&&void 0!==t?t:0},get currentCanPlay(){return ne&&J}})),[te,re,K,E,ne,J,w.currentBackendSourceEventTracking]),(0,i.useEffect)((()=>{ne||Z(!1)}),[ne]);const ie=(0,m.jj)();(0,i.useEffect)((()=>{const e=null===G.current||G.current;ie&&e?te():(re(),ne&&!ie&&K.triggerPause({enter_method:"switch_tab",playMode:E,currentBackendSourceEventTracking:w.currentBackendSourceEventTracking}))}),[ie,te,re,K,ne,E,w.currentBackendSourceEventTracking]);const ae=(0,i.useCallback)((()=>{var e;const t=(0,g.L$)(null===(e=W.current)||void 0===e?void 0:e.getPlayerAttributes()),{bitrate:r,author_id:n,format:i,encodedType:a,videoQuality:o,encodeUserTag:l,codecType:s,definition:u,secret:c,forFriend:p}=w;return Object.assign({id:T,authorId:n,playMode:E,bitrate:r,format:i,encodedType:a,videoQuality:o,encodeUserTag:l,codecType:s,definition:u,secret:c,forFriend:p,play_url:d},null!=t?t:{})}),[T,E,w,d]),oe=(0,c.i3)(),le=(0,i.useMemo)((()=>{const{group_id:e="",author_id:t="",is_scheduled:r,search_id:n,search_keyword:i,search_result_id:a,question_id:o,collection_id:l,collection_name:s,isPaidPartnership:d,poi_id:u,is_sub_only_video:c,isPinnedItem:p,isReposted:v,currentBackendSourceEventTracking:h}=w||{};return{itemId:e,authorId:t,isScheduled:Boolean(r),autoplayStatus:1,searchId:n,searchKeyword:i,searchResultId:a,questionId:o,playMode:E,isMute:oe,isAutoScroll:q,resolution:$,collectionId:l,collectionName:s,isPaidPartnership:Boolean(d),poiId:u,isSubOnlyVideo:c,isCopyrightMuted:R,isPinnedItem:p,isReposted:v,currentBackendSourceEventTracking:h}}),[E,oe,q,R,w,$]),se=(0,i.useCallback)((()=>{var e;const{currentTime:t=0,duration:r=0}=(0,g.L$)(null===(e=W.current)||void 0===e?void 0:e.getPlayerAttributes());return Object.assign(Object.assign({},le),{currentTime:t,duration:r,index:x})}),[x,le]);(0,i.useEffect)((()=>{w&&ee&&(ee.videoPlayHandleParams=se())}),[se,ee,w]);const{loading:de,handleCanPlayWithLoading:ue,handleWaitingWithLoading:ce}=(0,m.iJ)({isCurrentVideo:ne}),pe=(0,i.useCallback)((()=>{var e;null==ee||ee.updateMetricsParams({playbackAttribute:null===(e=W.current)||void 0===e?void 0:e.getPlayerAttributes(),videoQualityParams:ae()}),ue(),Z(!0),null==ee||ee.onCanPlay()}),[ae,ee,ue]),ve=(0,i.useCallback)((()=>{var e,t;const{currentTime:r=0,duration:n=0}=(0,g.L$)(null===(e=W.current)||void 0===e?void 0:e.getPlayerAttributes());null==ee||ee.updateMetricsParams({playbackAttribute:Object.assign({},null===(t=W.current)||void 0===t?void 0:t.getPlayerAttributes()),videoQualityParams:ae()}),null==ee||ee.onTimeUpdate(),null==V||V(r/n),S.e.handleFirstFrameVideo()}),[ae,ee,V]),he=(0,m.tW)(),ye=(0,i.useCallback)((e=>{var t;null==j||j(e),he(e),null==ee||ee.updateMetricsParams({playbackAttribute:null===(t=W.current)||void 0===t?void 0:t.getPlayerAttributes(),videoQualityParams:ae()}),null==ee||ee.onError()}),[ae,ee,j,he]),me=(0,i.useCallback)((()=>{var e;ce(),null==ee||ee.updateMetricsParams({playbackAttribute:null===(e=W.current)||void 0===e?void 0:e.getPlayerAttributes(),videoQualityParams:ae()}),null==ee||ee.onWaiting()}),[ae,ee,ce]),ge=(0,i.useCallback)((e=>{var t;null==L||L(e),null==ee||ee.updateMetricsParams({playbackAttribute:null===(t=W.current)||void 0===t?void 0:t.getPlayerAttributes(),videoQualityParams:ae()}),null==ee||ee.onEnded()}),[ae,ee,L]),fe=(0,i.useCallback)((e=>{var t;null==ee||ee.updateMetricsParams({playbackAttribute:null===(t=W.current)||void 0===t?void 0:t.getPlayerAttributes(),videoQualityParams:ae()}),null==ee||ee.onUnmount(Object.assign({},e))}),[ae,ee]);(0,i.useEffect)((()=>{ne||null==I||I({})}),[ne,I]);const _e=a||2===E||3===E||4===E||6===E||5===E,be=A?`${A}. ${M}`:M,{armCoreContentEvent:ke}=(0,i.useContext)(b.e),Pe=(0,i.useCallback)((()=>{null==ke||ke(),X.reportActualFMP(),S.e.handleActualFMP()}),[ke,X]);return(0,C.w)({isCurrentVideo:ne,index:x,mode:E}),(0,n.jsxs)(P.Le,{horizontal:a,mode:E,children:[e?(0,n.jsx)(P.R,{horizontal:_e,mode:E,src:e,alt:be,loading:r?"lazy":"eager",style:F,onLoad:Pe,fetchPriority:N}):t?(0,n.jsx)(_.x,{video:t,objectFit:_e?"contain":"cover",style:F,alt:be,onLoad:Pe,fetchPriority:N}):null,ne&&(0,n.jsxs)(P.Ec,{"data-e2e":O,children:[(0,n.jsx)(k.e,{ref:W,horizontal:_e,muteSetting:R||f.T5[E].forceMute,defaultMute:f.T5[E].defaultMute,playProgress:null!=z?z:0,src:d,onUnmount:fe,onTimeUpdate:ve,onError:ye,onCanPlay:pe,onWaiting:me,onEnded:ge,disableDownload:D,bitrate:w.bitrate,metrics:ee,bitrateInfo:U}),de&&(0,n.jsx)(P.K3,{}),4!==E&&6!==E||!B?null:(0,n.jsx)("track",{default:!0,kind:"subtitles",srcLang:B.language,src:B.url})]})]})})));var w=r(58632),x=r(46682),E=r(11917),R=r.n(E),M=r(57432),A=r.n(M),I=r(35323),L=r(93987),j=r(34099),O=r(57431),V=r(27111),B=r(61906),D=r(91021),F=r(2787),U=r(72263),N=r(93608),H=r(53701),Q=r(96462);let $=-1;function z(e,...t){$<0&&($=location.search.includes("ttplayer_debug=1")?1:0),$&&console.log(`[MultiMedia1][${e}]`,...t)}var q=r(23232),W=r(92701),G=r(85264),K=r(5267);const Y=(e,t)=>{const r=[];return e.forEach(((e,n)=>{const i=((e,t,r)=>{if(!Array.isArray(e)||e.length<1)return;const n=[];return e.forEach((e=>{const t=(i=e.url)?Array.isArray(i)?i.map((e=>({src:e}))):"string"==typeof i?i:[]:[],r=e.codecType||"h264";var i;!t||Array.isArray(t)&&0===t.length||n.push({url:t,definition:e.definition,bitrate:e.bitrate,duration:e.duration,qualityType:e.qualityType,vtype:"MP4",codecType:r.includes("h265")?"h265":"h264"})})),{order:t,data:{vid:`TT-vCache-${e[0].id}`,payload:n,preloadTime:r,codecType:e[0].codecType}}})(e,n,t);i&&i.data.payload.length>0&&r.push(i)})),r};function J(e,t,r){try{if(!e)return"";const{host:n}=new URL(e);return t.filter((e=>e===n)).length>0?"anonymous":r.filter((e=>e===n)).length>0?"use-credentials":""}catch(e){return""}}const Z=e=>!!e,X={player_type:"playerType",video_play_mode:"videoPlayMode",preloader:"preloader",muted:"muted"};let ee=null;var te=r(63508);let re=null,ne=null,ie={group1:["v16-webapp.tiktok.com","v16m-webapp.tiktokcdn-us.com"],group2:["v16-webapp-prime.tiktok.com","v16-webapp-prime.us.tiktok.com","v19-webapp-prime.us.tiktok.com"]};function ae(e,t,r,n=0){const i=B.M.checkHevcResult(1===n);if(e&&!i.closePreload&&t.length>0){const r=Y(t,10);e.preloadResources(r)}}function oe(e,t){e&&e.updatePreloadCodec(t)}function le(e,t){const r=(null==e?void 0:e.length)||0,n=(null==e?void 0:e.filter((e=>"h264"===e.CodecType)))||[],i=[];return!e||r<1||0===n.length?i.push(function(e){const t=e.defaultDefinition||"default";return{codecType:"h264",url:e.url?[{src:e.url}]:[],vtype:"MP4",qualityType:e.qualityType||0,definition:t,bitrate:e.defaultBitrate||0,gearName:t}}(t)):e.forEach((e=>{var t,r,n,a,o,l;const s=(null===(t=e.PlayAddr)||void 0===t?void 0:t.UrlList)||[];var d;i.push({bitrate:e.Bitrate,size:(null===(r=e.PlayAddr)||void 0===r?void 0:r.DataSize)||0,width:(null===(n=e.PlayAddr)||void 0===n?void 0:n.Width)||0,height:(null===(a=e.PlayAddr)||void 0===a?void 0:a.Height)||0,fileId:(null===(o=e.PlayAddr)||void 0===o?void 0:o.FileHash)||"",uri:(null===(l=e.PlayAddr)||void 0===l?void 0:l.Uri)||"",codecType:(d=e.CodecType,d.includes("h265")?"h265":"h264"),gearName:e.GearName,definition:e.GearName,qualityType:e.QualityType,mvmaf:e.MVMAF||"",url:s.map((e=>({src:e}))),vtype:"MP4"})})),i}const se=e=>J(e.url,ie.group1,ie.group2)===te.uJ?{credentials:"include"}:{};function de(e){return e===V.R.ACTIVE}function ue(e,t,...r){return e?function(e=[],t=0,r,n,i=0,a=!0,o,l,s,d,u,c,p,v,h,y,m){const{channelInfo:g,regionInfo:f}=B.M.getInstance(),_=(null==p?void 0:p.open)?"h265":"h264",b=n,k=le(e,{defaultBitrate:t,defaultDefinition:r,url:d}),{h264Set:P,h265Set:S}=(0,W.cU)(e);let C="";d&&(C=J(d,ie.group1,ie.group2));const T=C===te.uJ?{credentials:"include"}:{},w={channel:null==g?void 0:g.channel,channel_domain:null==g?void 0:g.domain,channel_type:null==g?void 0:g.type},x=(null==f?void 0:f.region)||"",E=(null==f?void 0:f.wid)||"",R=(null==f?void 0:f.isLogin)||!1,M=(null==h?void 0:h.playerPreload)||{},A=(null==u?void 0:u.extInfo)||{},I=null==h?void 0:h.bitrateSelect,L={selector:(null==I?void 0:I.selector)||"default",selectConfig:(null==I?void 0:I.config)||{},quality:null==I?void 0:I.qualityType,hevcQuality:null==I?void 0:I.hevcQualityType};z("generatePlayerConfigTT",b,k,L);const j=B.a.getHevcDisableInfo();return{playerType:"NEW_TT",playerConfig:{autoplay:a,volume:l,muted:s,playbackRate:1,codecType:_,vtype:"MP4",mp4EncryptPlayer:{closeDowngrade:!1,minBufferLength:10,maxBufferLength:30,needPreloadRangeList:!0,needPreloadCheck:!0,needAutoBitrate:!0,removeBufferLen:60,resumePlayWaterLevel:0,segmentMinDuration:10,reqOptions:T,getRequestOptionsCallback:se},getRequestOptionsCallback:se},strategyConfig:{enableSubtitle:!0,enablePreloader:"0"!==(null==m?void 0:m.preloader),enableLogger:!0,preloaderConfig:Object.assign(Object.assign({minBufferLength:10,preloadCacheType:1,preloadMaxCacheCount:5,preloadTime:10,preloadSize:209715,segmentMinDuration:10,reqOptions:T},M),{getRequestOptionsCallback:se}),bitrateAdapter:Object.assign(Object.assign({},L),{hevcQuality:(null==p?void 0:p.hevcQualityType)||28,quality:(null==p?void 0:p.qualityType)||20,userSelectResolution:y||"auto"}),videoPlayMode:(null==m?void 0:m.videoPlayMode)||"AUTO"},videoInfo:{vid:b,groupId:b,vtype:"MP4",codecType:"h264",definition:r||"",bitrate:t,width:0,height:0,url:d,duration:i,bitrateList:k,vqscore:null!=c?c:0,mvmaf:""},loggerParams:{lineAppId:1988,playerCoreVersion:"",codec_type:_,tag:B.M.pageName,preTag:B.M.prePageName,preSubtag:B.M.prePlayMode,subtag:B.M.playMode,vid:n,region:x,webId:E,uid:(null==f?void 0:f.uid)||E,isLogin:R,channelConfig:w,switchPlayerTime:v,bitrateSet:P,bitrateSetHevc:S,pIndex:(null==u?void 0:u.vIndex)||-1,ext:Object.assign(Object.assign(Object.assign({},A),j),{log_id:(null==o?void 0:o.log_id)||"",is_ad:(null==o?void 0:o.isAd)?1:0}),deviceScore:B.b.shortData,strategyVersion:K.v},envInfo:{tag:B.M.pageName,subtag:B.M.playMode,preTag:B.M.prePageName,preSubtag:B.M.prePlayMode,isLogin:R}}}(...r,t):function(e=[],t=0,r,n,i=0,a=!0,o,l,s,d,u,c,p,v,h,y,m){const{channelInfo:g,regionInfo:f}=B.M.getInstance(),_=d,b=(null==p?void 0:p.open)?"h265":"h264";let k="",P="",S="",C=!1;const T=t,w=`TT-vCache-${n}`,x=G.IH.getPreloadMeta(w);k=function(e){return z("getDefaultDefinition",e),e&&e.videoQuality&&e.definition?`${e.videoQuality}_${e.definition.substring(0,e.definition.length-1)}_0`:"unknown_definition_from_xgpreload_config"}(o);const E=le(e,{defaultBitrate:t,defaultDefinition:r,url:d}),{h264Set:R,h265Set:M}=(0,W.cU)(e),A=_;let I="";_&&(I=J(_,ie.group1,ie.group2));const L=I===te.uJ?{credentials:"include"}:{},j={channel:null==g?void 0:g.channel,channel_domain:null==g?void 0:g.domain,channel_type:null==g?void 0:g.type};P=(null==f?void 0:f.region)||"",S=(null==f?void 0:f.wid)||"",C=(null==f?void 0:f.isLogin)||!1;const O=(null==h?void 0:h.playerPreload)||{},V=(null==u?void 0:u.extInfo)||{},D=null==h?void 0:h.bitrateSelect,F={selector:(null==D?void 0:D.selector)||"default",selectConfig:(null==D?void 0:D.config)||{},quality:null==D?void 0:D.qualityType,hevcQuality:null==D?void 0:D.hevcQualityType};z("generatePlayerConfig",w,E,F);const U=B.a.getHevcDisableInfo();return{enableSubtitle:!0,enablePreloader:"0"!==(null==m?void 0:m.preloader),enableLogger:!0,preloader:Object.assign(Object.assign({minBufferLength:10,preloadCacheType:1,preloadMaxCacheCount:5,preloadTime:10,preloadSize:209715,segmentMinDuration:10,reqOptions:L},O),{getRequestOptionsCallback:se}),mp4EncryptPlayer:{closeDowngrade:!1,minBufferLength:10,maxBufferLength:30,needPreloadRangeList:!0,needPreloadCheck:!("MSE"===(null==m?void 0:m.videoPlayMode)),needAutoBitrate:!0,removeBufferLen:60,resumePlayWaterLevel:0,segmentMinDuration:10,reqOptions:L,getRequestOptionsCallback:se},logger:{appId:548444,line_app_id:1988,playerCoreVersion:"",codec_type:b,tag:B.M.pageName,preTag:B.M.prePageName,preSubtag:B.M.prePlayMode,subtag:B.M.playMode,vid:n,region:P,webId:S,uid:(null==f?void 0:f.uid)||S,isLogin:C,channelConfig:j,switchPlayerTime:v,bitrateSet:R,bitrateSetHevc:M,pIndex:(null==u?void 0:u.vIndex)||-1,ext:Object.assign(Object.assign(Object.assign({},V),U),{log_id:(null==o?void 0:o.log_id)||"",is_ad:(null==o?void 0:o.isAd)?1:0}),deviceScore:B.b.shortData,strategyVersion:K.v},video:{codecType:b,defaultBitrate:T,defaultDefinition:k,definitionList:[],duration:i,autoplay:a,volume:null!=l?l:.7,muted:s||!1,vqscore:null!=c?c:0,mvmaf:""},extra:{url:_,actualUrl:A,vid:w,ignores:["play","start"],reqAuth:I,closeMSE:"H5"===(null==m?void 0:m.videoPlayMode)||!Z(x)},hevcResult:p,bitrateList:E,bitrateAdapter:Object.assign(Object.assign({},F),{hevcQuality:(null==p?void 0:p.hevcQualityType)||28,quality:(null==p?void 0:p.qualityType)||20,userSelectResolution:y||"auto"})}}(...r,t)}var ce,pe;!function(e){e.PlayQuality="video_play_quality",e.PlayEnded="video_play_end",e.PlayFailed="video_play_failed",e.BlockStart="video_block_start",e.Block="video_block",e.Request="video_request",e.RequestResponse="video_request_response",e.FirstFrame="first_feed_show_time"}(ce||(ce={})),function(e){e[e.Public=0]="Public",e[e.Self=1]="Self",e[e.Friend=2]="Friend"}(pe||(pe={}));const ve=(e=0)=>["one_column","three_column","browser_mode","swiper_mode","video_detail","pip","fullscreen","creator_tab","mini_player","immersive_player"][e],he=e=>e?e.map((e=>e.GearName||"")):null,ye=e=>e?e.map((e=>e.QualityType&&e.Bitrate?`${e.QualityType}:${e.Bitrate}`:"")).filter((e=>!!e)):null,me=e=>{if(!e)return 0;let t=0;for(let r=0;r<e.length;r++)t+=e.end(r)-e.start(r);return Math.round(1e3*t)},ge=new Map([[2,"adapt_lowest_1080p"],[3,"adapt_lower_1080p"],[4,"adapt_1080p"],[7,"adapt_lowest_1440p"],[10,"normal_720p"],[11,"low_720p"],[12,"adapt_high_720p"],[13,"adapt_higher_720p"],[14,"adapt_lower_720p"],[15,"adapt_lowest_720p"],[16,"higher_720p"],[17,"highest_720p"],[18,"adapt_720p"],[19,"adapt_low_720p"],[191,"lower_720p"],[20,"normal_540p"],[21,"adapt_lower_540p"],[22,"adapt_high_540p"],[23,"adapt_higher_540p"],[24,"lower_540p"],[25,"lowest_540p"],[26,"higher_540p"],[27,"highest_540p"],[28,"adapt_540p"],[29,"adapt_lowest_540p"],[291,"adapt_low_540p"],[30,"normal_480p"],[31,"low_480p"],[32,"high_480p"],[33,"medium_480p"],[34,"lower_480p"],[35,"lowest_480p"],[36,"higher_480p"],[37,"highest_480p"],[38,"adapt_480p"],[39,"adapt_lower_480p"],[391,"adapt_high_480p"],[40,"normal_360p"],[41,"low_360p"],[42,"high_360p"],[43,"medium_360p"],[44,"lower_360p"],[45,"lowest_360p"],[46,"higher_360p"],[47,"highest_360p"],[48,"adapt_360p"],[49,"adapt_lowest_360p"],[50,"adapt_high_360p"]]),fe={color:"#fff",backgroundColor:"#2a9d1f",position:"absolute",zIndex:2,top:"30px"},_e=(0,i.memo)((0,i.forwardRef)((function({containerId:e="",classList:t=[],player:r,bitrateInfo:n,oncanplay:a,onplay:o,onwaiting:l,onended:s,ontimeupdate:d,onloadstart:u,onloadeddata:c,onvolumechange:p,onVideoPlayEnd:v,onResolutionReady:h,onerror:y,onpause:m,onplaying:g,onbreak:f,subtitle:_,teaParams:b,videoDimensionParams:k,mode:P,id:S,containerRef:C,hitPreload:T},w){const x=(0,i.useMemo)((()=>{var e;let t={};if(!b)return t;const n=null==r?void 0:r.attributes;let i=0;b.forFriend&&(i=2),b.secret&&(i=1);let a="";if(n&&n.src){const e=/^(?:https?:\/\/)?([^\/\s:]+)/,t=n.src.match(e);a=t?t[1]:""}const o={group_id:S,author_id:b.author_id||"",play_mode:ve(P),logo_type:"unwatermarked",item_status:i,play_url:n?n.src:"",host:a,aweme_type:b.aweme_type||0,pic_cnt:b.pic_cnt||0,playlist_id:b.playlist_id||"",popup_type:b.popup_type||"",size:b.size,log_id:b.log_id||"none",is_ad:b.isAd,video_width:k?k.video_width:0,video_height:k?k.video_height:0,video_duration:k?k.video_duration:0},{dScore:l,netScore:s}=null!==(e=B.M.getDeviceScore())&&void 0!==e?e:{},d=function(){const e=re||ne;return null==e?void 0:e.device}();return t=Object.assign({},{cpu_core:(null==d?void 0:d.cpu)||0,memory_size:(null==d?void 0:d.memory)||0,HEVC_supported:(null==d?void 0:d.isHEVCSupported)?1:0,hardware_score:l,network_score:s},o),t}),[b,k,S,P]),E=(0,i.useRef)(0),R=(0,i.useCallback)((()=>r&&b?((e,t)=>{if(!e)return t;if("string"==typeof e&&e.indexOf("xgpreload_config")>-1)return e;const r=Number(e);if(!ge.has(r)){const t=String(e).match(/^([a-zA-Z]*)+_([0-9]+)_0$/i);return t?`${t[1]}_${t[2]}p`:`_${e}`}return ge.get(r)})((r.curDefinition||{}).definition,b.definition):null),[r,b]),M=(0,i.useCallback)((()=>r&&b&&(r.curDefinition||{}).bitrate||0),[r,b]),A=(0,i.useCallback)((()=>r&&b?(r.curDefinition||{}).codecType:null),[r,b]),j=(0,i.useCallback)((()=>{let e="";if(!b)return e;const t=R();return b.videoQuality&&t&&(e=`${b.videoQuality}_${t}`),e}),[b,R]),O=(0,i.useCallback)((()=>{const e={};if(b){const t=M(),n=A(),i=j(),a=(0,D.ZQ)(),o=(null==r?void 0:r.state)||"default";let l;S&&(l=a.getPreloadCacheInfo(S)),e.video_bitrate=t||b.bitrate,e.video_format=b.format,e.codec_format=n||"h264",e.encoded_type=b.encodedType,e.bitrate_quality=b.videoQuality,e.video_quality=i,e.video_encodeUserTag=b.encodeUserTag,e.original_definition=b.definition,e.preload_size=l?l.byteLength:-1,e.preload_time=l?Math.floor(l.duration):-1,e.player_type=r?r.type:"defaultPlayer",e.video_type="mp4",e.render_state=o}return e}),[b,R,M,A,j,S,r]),U=(0,i.useCallback)((()=>{let e=!1,t=A();return t||(t="h264"),e=!!t&&t.indexOf("h265")>-1,e}),[A]),H=(0,i.useCallback)((()=>{(0,I.uQ)(L.Y.VideoRequest),x&&1!==P&&N.f.event("video_request",Object.assign(Object.assign({},x),{render_state:(null==r?void 0:r.state)||""}))}),[x,P]),z=(0,i.useCallback)((e=>{if(!x||1===P)return;let t;(null==r?void 0:r.attributes)&&(t=r.attributes.error);const n=j(),i=U(),a=Object.assign({},{duration:Math.round(e.duration),error_code:t?String(t.code):"",is_success:t?"0":"1",video_quality:n,is_bytevc1:i?1:0,isExpired:2,isSupportMP4:Number((0,Q.vk)()),render_state:(null==r?void 0:r.state)||""},x);N.f.event("video_request_response",a)}),[x,U,j,P]),q=(0,i.useCallback)((()=>{if(!x||1===P||!r)return;const{attributes:e}=r;if(e){const{readyState:t,seeking:r}=e;E.current=t<1?1:r?2:0}N.f.event("video_block_start",Object.assign(Object.assign({},x),{block_type:E.current}))}),[x,P]),W=(0,i.useCallback)((e=>{if(!x||1===P||!r)return;const t=O(),n=U();let i,a=0;r.attributes&&(i=r.attributes.error,a=r.attributes.duration);let o=e.code||0,l=e.message||"";o<=0&&i&&(o=i.code,l=i.message);const s=Object.assign({},t,{error_code:String(o),error_info:l,is_bytevc1:n?1:0,duration:Math.round(1e3*a),isExpired:e.isExpired||0,isSupportMP4:Number((0,Q.vk)()),is_before:0===e.status?0:1,retry_c:e.retryCount||0,retry_l:e.retryList||[]},x);N.f.event("video_play_failed",s)}),[x,O,U,P]),G=(0,i.useCallback)((e=>{if(null==f||f(),!x||1===P)return;const t=O(),n=U();let i,a,o=0;const l=e.currentTime;let s=0,d=1,u=!1;const c=e.duration-e.pauseDuration;(null==r?void 0:r.attributes)&&(i=r.attributes.error,o=r.attributes.duration||0,s=r.attributes.readyState,a=r.attributes.buffered,d=r.attributes.volume,u=r.attributes.muted);const p=Math.min(c,1e3*o);let h=M();h<=0&&(h=b&&b.bitrate?b.bitrate:0);const y=h/8*(p/1e3),m=Object.assign({},t,{is_success:i?"0":"1",video_duration:Math.round(1e3*o),play_duration:Math.round(1e3*l),buffering:s<=2?1:0,duration:Math.round(c),wait_duration:0,cur_cache_duration:me(a),local_time_ms:Date.now(),volume_level:d,volume_change:0,muted:u?1:0,click_mute:0,session_order:0,play_size:Math.round(y),data_player_type:2,cache_size:0,cache_duration:0,cdn_size_video:0,is_bytevc1:n?1:0,drop_frame:0,total_play_frame:0,drop_frame_rate:0,drop_frame_duration:0},x),g=function(e){var t,r;const n={isFinish:0,pt:0,vt:0,firstframeDuration:100,errorCode:0,errorMessage:"",codecType:"h264",resolution:"",url:""},i=null===(r=null===(t=null==e?void 0:e.player)||void 0===t?void 0:t.plugins)||void 0===r?void 0:r.xgVodLogger;if(null==i?void 0:i.getFinalInfo){const e=i.getFinalInfo();return Object.assign(Object.assign({},n),e)}return n}(r),_=Object.assign(Object.assign({vid:S,playPos:Math.round(1e3*l),stayDuration:0,videoQuality:1},g),{logid:(null==b?void 0:b.log_id)||"nonw"});null==v||v(_),N.f.event("video_play_end",m)}),[x,O,U,M,b,P]),K=(0,i.useCallback)((e=>{if((0,I.uQ)(L.Y.VideoFirstFrame),!x||1===P)return;const t=Object.assign({},{feed_total:e.duration},x),r=(0,I.xt)();N.f.event("first_feed_show_time",Object.assign(Object.assign({},t),r))}),[x,P]),Y=(0,i.useCallback)((e=>{if(!x||1===P)return;let t=0,i=!1;(null==r?void 0:r.attributes)&&(t=r.attributes.duration,i=r.attributes.muted);const a=U(),o=O(),l=Object.assign({},o,{duration:Math.round(e.duration),is_bytevc1:a?1:0,video_duration:Math.round(1e3*t),muted:i?1:0,bitrate_set:he(n),quality_bitrate:ye(n),duration_from_load:Math.round((null==e?void 0:e.durationFromLoaded)||0),duration_with_load:Math.round((null==e?void 0:e.durationWithLoaded)||0),is_same:0,retry_c:e.retryCount||0,retry_l:e.retryList||[]},x);N.f.event("video_play_quality",l)}),[x,U,n,O,P]),J=(0,i.useCallback)((e=>{if(!x||1===P||(null==r?void 0:r.state)!==V.R.ACTIVE)return;const t=O();let n=0;(null==r?void 0:r.attributes)&&(n=r.attributes.currentTime);const i=U(),a=Object.assign({},t,{duration:Math.round(e.duration),is_bytevc1:i?1:0,position:Math.round(1e3*n),should_filter:"0",droppedRate:0,end_type:0,block_type:E.current},x);N.f.event("video_block",a)}),[x,U,O,P]),Z=(0,i.useCallback)((e=>{e.preventDefault()}),[]),X=(0,i.useCallback)((()=>{(0,I.uQ)(L.Y.VideoCanPlay),null==a||a()}),[a]),ee=(0,i.useCallback)((e=>{null==u||u(e)}),[u]),te=(0,i.useCallback)((e=>{null==c||c(e)}),[c]),ie=(0,i.useCallback)((e=>{null==o||o(e)}),[o]),ae=(0,i.useCallback)((e=>{null==l||l(e)}),[l]),oe=(0,i.useCallback)((e=>{null==s||s(e)}),[s]),le=(0,i.useCallback)((()=>{null==d||d()}),[d]),se=(0,i.useCallback)((e=>{null==y||y(e)}),[y]),de=(0,i.useCallback)((e=>{null==m||m(e)}),[m]),ue=(0,i.useCallback)((e=>{null==g||g(e)}),[g]),ce=(0,i.useCallback)((e=>{null==p||p(e)}),[p]),pe=(0,i.useCallback)((e=>{e.id=S,null==h||h(e)}),[h,S]);return(0,i.useEffect)((()=>()=>{(null==r?void 0:r.metrics)&&r.metrics.stop()}),[S]),(0,i.useEffect)((()=>{if(null==r?void 0:r.metrics)return r.metrics.bind("PlayEnded",G),()=>{r.metrics&&r.metrics.clear("PlayEnded")}}),[G]),(0,i.useEffect)((()=>{if(null==r?void 0:r.metrics)return r.metrics.on("VideoRequest",H),r.metrics.on("VideoRequestResponse",z),r.metrics.on("BlockStart",q),r.metrics.on("Block",J),r.metrics.on("PlayQuality",Y),r.metrics.on("PlayFailed",W),r.metrics.on("FirstFrame",K),r.element&&r.element.addEventListener("contextmenu",Z),r.event&&(r.event.on("canplay",X),r.event.on("play",ie),r.event.on("waiting",ae),r.event.on("ended",oe),r.event.on("timeupdate",le),r.event.on("error",se),r.event.on("pause",de),r.event.on("playing",ue),r.event.on("loadstart",ee),r.event.on("loadeddata",te),r.event.on("volumechange",ce),r.event.on("resolutionReady",pe)),()=>{r.metrics&&(r.metrics.off("VideoRequest",H),r.metrics.off("VideoRequestResponse",z),r.metrics.off("BlockStart",q),r.metrics.off("Block",J),r.metrics.off("PlayQuality",Y),r.metrics.off("PlayFailed",W),r.metrics.off("FirstFrame",K),r.element&&r.element.removeEventListener("contextmenu",Z),r.event&&(r.event.off("canplay",X),r.event.off("play",ie),r.event.off("waiting",ae),r.event.off("ended",oe),r.event.off("timeupdate",le),r.event.off("error",se),r.event.off("pause",de),r.event.off("playing",ue),r.event.off("loadstart",ee),r.event.off("loadeddata",te),r.event.off("volumechange",ce),r.event.off("resolutionReady",pe)))}}),[ie,X,ae,oe,le,se,de,ue,ee,te,H,z,q,J,Y,W,K,Z,a,u,c,pe]),(0,F.FD)("div",{id:e,className:t.join(" "),ref:C,children:[_?(0,F.Y)("track",{default:!0,kind:"subtitles",srcLang:_.language,src:_.url}):null,$>0?(0,F.FD)("div",{style:fe,children:[null==r?void 0:r.uuid,"_",null==r?void 0:r.state,"_before_",T?"hitPreload":""]}):null]})})));var be=r(67353);const ke={Chrome:{cpuCore:0,dScore:0,score:-2,gpuScore:0,hevcQualityType:14,checkLevel:2,pageNames:["video_detail","homepage_hot","homepage_follow","others_homepage","explore_page"],playModes:["video_detail","one_column","browser_mode","immersive_player","three_column"]},Edge:{cpuCore:0,dScore:0,score:-2,gpuScore:0,hevcQualityType:14,checkLevel:2,pageNames:["video_detail","homepage_hot","homepage_follow","others_homepage","explore_page"],playModes:["video_detail","one_column","browser_mode","immersive_player","three_column"]}},Pe={mp4Preloader:null,BitrateSelector:{defaultConfig:{}},ifAddMp4Preloader:!1},Se=e=>{N.f.event("video_mse_error",e)};const Ce="PlayerLife",Te="PlayerCall",we="autoplay_was_prevented";var xe;!function(e){e.NoInteract="failed because the user didn't interact with the document first.",e.SafariNoInteract="The request is not allowed by the user agent or the platform in the current context",e.AbortRequest="new load request"}(xe||(xe={}));const Ee=(e,t)=>{var r,n,i,a,o,l,s,d,u,c,p,v;const h=null!==(n=null===(r=null==e?void 0:e.element)||void 0===r?void 0:r.error)&&void 0!==n?n:null,y=null===(i=null==e?void 0:e.element)||void 0===i?void 0:i.buffered,m=null==e?void 0:e.currentTime,g=null==e?void 0:e.type,f=(null==e?void 0:e.curDefinition)||{};return{buffered:y,currentTime:m,ended:null===(a=null==e?void 0:e.element)||void 0===a?void 0:a.ended,currentSrc:null!=t?t:null===(o=null==e?void 0:e.element)||void 0===o?void 0:o.currentSrc,duration:null==e?void 0:e.duration,readyState:null===(l=null==e?void 0:e.element)||void 0===l?void 0:l.readyState,networkState:null===(s=null==e?void 0:e.element)||void 0===s?void 0:s.networkState,error:h?{code:null==h?void 0:h.code,message:null!==(u=null===(d=null==e?void 0:e.element)||void 0===d?void 0:d.error)&&void 0!==u?u:(null==h?void 0:h.message)||"UNKNOWN_ERROR_MESSAGE",MEDIA_ERR_ABORTED:1,MEDIA_ERR_NETWORK:2,MEDIA_ERR_DECODE:3,MEDIA_ERR_SRC_NOT_SUPPORTED:4}:null,playerType:g,volume:null==e?void 0:e.volume,muted:null==e?void 0:e.muted,videoBitrate:null==f?void 0:f.bitrate,videoQuality:null==f?void 0:f.definition,codecType:null!==(c=null==f?void 0:f.codecType)&&void 0!==c?c:"h264",play_url:null!==(v=null===(p=null==e?void 0:e.element)||void 0===p?void 0:p.currentSrc)&&void 0!==v?v:t}},Re=(0,i.memo)((0,i.forwardRef)((function({id:e,url:t,mode:r,muteSetting:n,playProgress:a,duration:o,playbackRate:l=1,onLoadStart:s,onLoadedData:u,onCanPlay:p,onPause:v,onPlay:y,onPlaying:m,onTimeUpdate:g,onWaiting:f,onEnded:_,onError:b,onUnmount:k,onVideoChange:P,onBreak:S,onVideoVolumeChange:C,onVideoPlayEnd:T,onAutoplayPrevented:x,onResolutionReady:E,userResolution:R,subtitleStruct:M,subtitleList:A,curSubtitle:j,onSubtitleCallback:O=e=>{},bitrateInfo:Q,defaultDefinition:$,preloadUrlsList:W,preloader:K,defaultBitrate:Y=-1,playerInitHost:J,teaParams:Z,autoPlay:le,autoReplay:ce=!0,size:pe,pathId:he="",metrics:ye,hevcTest:me={open:!1,qualityType:20,closePreload:!1},playbackAbTestInfo:ge=D.Ah,isTTP:fe,videoDimensionParams:xe,vIndex:Re=-1,extInfo:Me={},renderState:Ae=V.R.ACTIVE},Ie){const[Le,je]=(0,i.useState)(null),Oe=(0,i.useRef)(null),Ve=(0,i.useRef)((new Date).getTime()),Be=(0,i.useRef)(!1),De=(0,i.useRef)(0),Fe=(0,i.useRef)(null),Ue=(0,i.useRef)(),Ne=(0,i.useRef)(null),He=(0,i.useRef)(function(){if(ee)return ee;const e={playerType:"",videoPlayMode:"",preloader:""},t=(location.search||"").replace("?","").split("&");for(let r=0;r<t.length;r++){const n=t[r].split("=");void 0!==X[n[0]]&&(e[X[n[0]]]=n[1])}return ee=e,e}()),Qe=(0,i.useRef)(Ae),$e=(0,i.useRef)(!1),ze=(0,i.useRef)(null),qe=(0,h.Ul)(),We=(0,i.useRef)(!1),Ge=(0,i.useRef)(null),[Ke,Ye]=(0,i.useState)(!1);(0,i.useEffect)((()=>{const{playerUpgrade:e,playerH265Soft:t}=ge;let r="XG";(null==t?void 0:t.enableSoftwareH265)||(r=(null==e?void 0:e.playerType)||He.current.playerType||"XG"),$e.current="NEW_TT"===r,ze.current=function(e){return e?(ne||(ne=new G.mx({enableReuse:!1,enableMultiple:!0,minBuffer:0,defaultMSE:!1})),ne):(re||(re=new G.SN({enableReuse:!1,enableMultiple:!0,minBuffer:0,defaultMSE:!1})),re)}($e.current)}),[]),function(e){e&&(ie=e)}(J);const[Je,Ze]=(0,i.useState)(!1),Xe=(0,c.i3)(),et=1===r?n:n||Xe;const tt=(0,c.R4)(),rt=(0,c.S4)().setMute,nt=ve(r);B.M.playMode=nt,B.M.pageName=he;const{hevcIgnoreEnv:it}=ge,at=B.M.checkHevcResult(1===it),ot=(0,i.useCallback)(((e,t)=>{var n,i,a,o,l,s;const d={mode:r,pathId:he};if("MP4_2"===e){if(Fe.current)try{const e=null===(n=Fe.current)||void 0===n?void 0:n.element;Object.assign(d,{currentTime:null!==(i=null==e?void 0:e.currentTime)&&void 0!==i?i:0,codec:null!==(l=null===(o=null===(a=Fe.current)||void 0===a?void 0:a.curDefinition)||void 0===o?void 0:o.codecType)&&void 0!==l?l:"",duration:null!==(s=null==e?void 0:e.duration)&&void 0!==s?s:0})}catch(e){console.error("playCatch error")}!function(e,t){var r,n,i,a,o,l,s,d,u;const c={code:null!==(r=t.errorCode)&&void 0!==r?r:0,message:null!==(n=t.errorMessage)&&void 0!==n?n:"",httpCode:null!==(i=t.httpCode)&&void 0!==i?i:0,url:null!==(a=t.url)&&void 0!==a?a:"",type:e,responseMsg:"",xCache:"",via:"",mode:null!==(o=t.mode)&&void 0!==o?o:"",pathId:null!==(l=t.pathId)&&void 0!==l?l:"",currentTime:null!==(s=t.currentTime)&&void 0!==s?s:0,codec:null!==(d=t.codec)&&void 0!==d?d:"",duration:null!==(u=t.duration)&&void 0!==u?u:0};(null==t?void 0:t.response)?function(e){const t={responseMsg:""};return new Promise((r=>{try{e.headers.forEach(((e,r)=>{t[r.toLocaleLowerCase()]=e})),e.text().then((n=>{e.text=n;const i=n.toLocaleLowerCase(),a=/<body>(([\s\S])*?)<\/body>/.exec(i),o=document.createElement("div");o.innerHTML=a?a[1]:"";const l=o.children;let s="";for(let e=0;e<l.length;e++)s+=`${l[e].innerText}|`;t.responseMsg=s,r(t)})).catch((()=>{r(t)}))}catch(e){r(t)}}))}(t.response).then((t=>{var r,n,i;c.responseMsg=null!==(r=t.responseMsg)&&void 0!==r?r:"",c.xCache=null!==(n=t["x-cache"])&&void 0!==n?n:"",c.via=null!==(i=t.via)&&void 0!==i?i:"",console.info(`>>>>>${e} parseResponse`,c),Se(c)})).catch((()=>{c.code=-1e3,Se(c),console.info("parse response error")})):Se(c)}("running",Object.assign(t,d))}(0,be.AX)(t)&&oe(ze.current,"h264")}),[e,r,he,Ne]),lt=(0,i.useCallback)((()=>{null==x||x()}),[e,r,he]);(0,i.useEffect)((()=>{var e,t;(0,d.Cd)(null!==(e=null==qe?void 0:qe.id)&&void 0!==e?e:""),K.setPreloadIndex(null!==(t=null==qe?void 0:qe.index)&&void 0!==t?t:0)}),[qe]),(0,i.useEffect)((()=>{const{hevcResultLocal:e}=ge;B.a.getInstance().needPersist=0===e,B.M.setHevcEffectiveConditions(ke)}),[]),(0,i.useEffect)((()=>{z(Te,"changePreloadCodec",at.open),oe(ze.current,at.open?"h265":"h264"),G.Tz.updateConfig({hevcQuality:at.hevcQualityType,quality:at.qualityType})}),[e,at.open,at.openSrc]);const st=(0,i.useCallback)((e=>{var t;const r=e.player;if(!r)return;const n=r.element;(0,be.y8)(n)&&((e=>{const{H264DefinitionList:t}=e.config;if(t&&t.length>0){const r=t[0];e.emit("playCatch","MP4_3",{errorCode:8200,message:"width and height is 0"}),e.setConfig({defaultBitrate:r.bitrate,defaultDefinition:r.definition,url:r.url,codecType:r.codecType}),e.src=r.url,e.play()}})(r),oe(ze.current,"h264")),null===(t=Fe.current)||void 0===t||t.off("loadedmetadata",st)}),[e,r,he,Ne]),dt=t=>{z(Te,"handlerPreloadInfoReady",t),(0,D.ZQ)().setPreloadCacheInfo(e,t),Ye(!0)},ut=(0,i.useMemo)((()=>A&&A.length>0?A:[]),[A]),ct=(0,i.useMemo)((()=>W.length),[e,W]);(0,i.useEffect)((()=>{const{playerPreload:t,hevcIgnoreEnv:r}=ge,n="number"==typeof(i=(null==t?void 0:t.vid)||"v0")?i:"boolean"==typeof i?i?1:0:0===i.indexOf("v")&&2===i.length?parseInt(i[1],10):parseInt(i,10);var i;z(Ce,"addPreloadList",e,W.map((e=>e[0].id))),n>0&&ae(ze.current,W,0,r)}),[e,ct]),(0,i.useEffect)((()=>{var e,t,r,n,i;ut.length>0?(Ue.current?Ue.current.setSubTitles(ut):(Ue.current=new G.SX({subTitlesList:ut}),null===(e=Ue.current)||void 0===e||e.on("update",(e=>{O(e)})),null===(t=Ue.current)||void 0===t||t.on("change",(e=>{O(e)})),null===(r=Ue.current)||void 0===r||r.on("error",(e=>{O(e)}))),Fe.current&&Ue.current.attach(null===(n=Fe.current)||void 0===n?void 0:n.element)):null===(i=Ue.current)||void 0===i||i.switchOff()}),[ut,e]),(0,i.useEffect)((()=>{var e,t;j?null===(t=Ue.current)||void 0===t||t.switch(j):null===(e=Ue.current)||void 0===e||e.switchOff()}),[j,e]),(0,i.useEffect)((()=>{Fe.current&&(null==ye||ye.setPlayerType(1))}),[ye,Le]),(0,i.useEffect)((()=>{var t,r;z(Ce,"renderState",null===(t=Fe.current)||void 0===t?void 0:t.uuid,e,Ae,et,tt);let n=Ae;if(Fe.current){Ae===V.R.BACKUP&&(n=V.R.RETAIN);const e=ze.current;null==e||e.updatePlayer(Fe.current,n),de(Qe.current)&&le&&(Fe.current.play(),Fe.current.forceAutoplay=!1),n!==V.R.ACTIVE&&Fe.current.pause()}else Ae===V.R.RETAIN&&(n=V.R.BACKUP);z(Ce,"renderStateChange",e,null===(r=Fe.current)||void 0===r?void 0:r.uuid,`renderState:${Ae} state:${n} muted:${et} volume:${tt} autoplay:${le}`),Qe.current=n}),[Ae]),(0,i.useEffect)((()=>{var r;if(!Le){be.bt.hevcTest=me;const n={vIndex:Re,extInfo:Object.assign(Object.assign({},Me),{log_id:(null==Z?void 0:Z.log_id)||"none",is_ad:(null==Z?void 0:Z.isAd)?1:0})},i=ue($e.current,He.current,Q,Y,$,e,o,le,Z,tt,et,t,n,0,at,Ve.current,ge,R);We.current=!1,Ge.current=null,Oe.current=i;const a=ze.current,l=a.usePlayer(i,Qe.current);a.mountDom(l,Ne.current),ae(ze.current,W,0,ge.hevcIgnoreEnv),z(Ce,"usePlayer",l.uuid,e,`autoPlay:${le} volume:${tt} mute:${et} playMode:${nt}`,i,nt,he,at),l.on("playCatch",ot),l.on("autoplay_was_prevented",lt),l.on(te.Wu,dt),l&&(Fe.current=l,null===(r=Ue.current)||void 0===r||r.attach(l.player),je("xgplayer")),q.DS.setCustomTracker({event:(e,t)=>{N.f.event(e,t)}}),a.setCustomTracker({event:(e,t)=>{z("VodLogger",e,t),N.f.event(e,t)}})}}),[pe,e,t,r,K,rt,$,fe]),(0,i.useEffect)((()=>{if(!Le)return;const{mp4Preloader:e}=Pe;if(e){const t=e=>{var t,r;const n={task_type:2,cdn_size:e.len,cdn_speed:e.speed,project:"webapp-desktop",is_hevc:(null===(r=null===(t=Fe.current)||void 0===t?void 0:t.curDefinition)||void 0===r?void 0:r.codecType)||""};(0,H.k)(n),null==ye||ye.videoQualityReport.msePlayerCacheUpdate(e.len)};return e.on("real_time_speed",t),()=>{e.off("real_time_speed",t)}}}),[Le,ye]),(0,i.useEffect)((()=>{var e;if(Le&&Fe.current){const t=e=>{const t={task_type:1,cdn_size:e.cdn_size,cdn_speed:e.cdn_speed,project:"webapp-desktop"};(0,H.k)(t),null==ye||ye.videoQualityReport.msePlayerCacheUpdate(e.cdn_size)};return null===(e=Fe.current)||void 0===e||e.on("prf_data_size",t),()=>{var e;null===(e=Fe.current)||void 0===e||e.off("prf_data_size",t)}}}),[Le,ye]);const pt=(0,i.useCallback)((e=>{null==y||y(e)}),[y]),vt=(0,c.VN)();(0,i.useImperativeHandle)(Ie,(()=>{const n=Fe.current;return{play:()=>(0,w.__awaiter)(this,void 0,void 0,(function*(){var e,t;if(z(Te,"play",null===(e=Fe.current)||void 0===e?void 0:e.uuid,Qe.current,!de(Qe.current)),!Fe.current||!de(Qe.current))return Promise.resolve();try{yield null===(t=Fe.current)||void 0===t?void 0:t.play()}catch(e){console.info("Video play error: ",e)}})),pause:()=>{var t,n;z(Te,"pause",null===(t=Fe.current)||void 0===t?void 0:t.uuid,Qe.current);try{null===(n=Fe.current)||void 0===n||n.pause(),U.A.emit("video_pause",{itemId:e,playMode:r})}catch(e){console.info("Video pause error: ",e)}},seek:t=>{if(z(Te,"seek",t),n){U.A.emit("video_seek",{itemId:e,playMode:r});const i=n.duration;i&&Fe.current&&Fe.current.seek(i*t)}},seekTime:e=>{null==n||n.seek(e)},onSeeked:e=>{null==n||n.on("seeked",e)},onSeeking:e=>{null==n||n.on("seeking",e)},onTimeUpdate:e=>{null==n||n.on("timeupdate",(()=>{var t,r;const i=null!==(t=null==n?void 0:n.currentTime)&&void 0!==t?t:0,a=null!==(r=null==n?void 0:n.duration)&&void 0!==r?r:0;e(i/a,i,a)}))},onCanPlay:e=>{null==n||n.on("canplay",e)},getFullscreen:e=>(0,w.__awaiter)(this,void 0,void 0,(function*(){yield null==n?void 0:n.enterFullscreen(e)})),exitFullscreen:e=>(0,w.__awaiter)(this,void 0,void 0,(function*(){yield null==n?void 0:n.exitFullscreen(e)})),getPlayerAttributes:()=>Ee(n,t),replay:()=>{(null==n?void 0:n.replay)&&(null==n||n.replay())},getPlaybackQuality:()=>{var e;return null===(e=null==n?void 0:n.element)||void 0===e?void 0:e.getVideoPlaybackQuality()},updatePlayer:e=>{var t;Fe.current&&(null===(t=ze.current)||void 0===t||t.updatePlayer(Fe.current,Ae))},changeResolution:e=>{var t;Fe.current&&(null===(t=ze.current)||void 0===t||t.changeResolution(Fe.current,e))},getResolutionInfo:()=>{var e;return Fe.current?null===(e=ze.current)||void 0===e?void 0:e.getResolutionInfo(Fe.current):null},get renderState(){return Qe.current}}}));const ht=(0,i.useCallback)(((e=0)=>(0,w.__awaiter)(this,void 0,void 0,(function*(){var t,r,n,i,a;if(de(Qe.current)&&!(e>=3))try{const e=null===(t=Fe.current)||void 0===t?void 0:t.player;(null==e?void 0:e.isCanplay)?yield null===(r=Fe.current)||void 0===r?void 0:r.play():null===(n=Fe.current)||void 0===n||n.on("canplay",(()=>(0,w.__awaiter)(this,void 0,void 0,(function*(){var e;de(Qe.current)&&(yield null===(e=Fe.current)||void 0===e?void 0:e.play())}))))}catch(t){const r=null!==(i=t.message)&&void 0!==i?i:"",n=r.indexOf("new load request")>-1,o=null!==(a=r.match("failed because the user didn't interact with the document first."))&&void 0!==a?a:r.match("The request is not allowed by the user agent or the platform in the current context");if(n)return;o?(rt(!0),setTimeout((()=>{ht(e+1)}),0)):ht(e+1)}}))),[rt]),yt=(0,i.useCallback)((()=>{var t,n;try{(null===(t=Fe.current)||void 0===t?void 0:t.replay)&&(null===(n=Fe.current)||void 0===n||n.replay()),U.A.emit("video_replay",{itemId:e,playMode:r})}catch(e){setTimeout((()=>{rt(!0)}),0)}}),[rt,e,r]);(0,i.useEffect)((()=>{Le&&Fe.current&&(Fe.current.volume=tt,Fe.current.muted=et,Fe.current.playbackRate=l,null==C||C(et?0:tt))}),[Le,et,l,tt,C]),(0,i.useEffect)((()=>{const t=Fe.current;if(!Le||!t||!de(Qe.current))return;const n="undefined"!=typeof document&&!document.hidden;le&&Le&&(8===r||n)&&ht(),z("videoCanplay",e,t.uuid,t.currentTime,a,`videoCanplay:${Je} autoPlay:${le}`),4!==r&&t&&Math.abs(t.currentTime-a)>.2&&Je&&t.seek(a)}),[Je,le,a,ht,Le,r]);const mt=(0,i.useCallback)((e=>{var t;z("callback handlePlayerWaiting",null===(t=Fe.current)||void 0===t?void 0:t.uuid),Le&&(null==f||f(e))}),[Le,f]),gt=(0,i.useCallback)((()=>{Le&&(null==S||S())}),[Le,S]),ft=(0,i.useCallback)((e=>{var t;z("callback handlePlayerEnded",null===(t=Fe.current)||void 0===t?void 0:t.uuid),Le&&(null==_||_(e),ce&&yt())}),[Le,_,yt,ce]),_t=(0,i.useCallback)((e=>{var t,r,n;z("callback handleLoadStart",null===(t=Fe.current)||void 0===t?void 0:t.uuid);const i=null===(r=Fe.current)||void 0===r?void 0:r.element,a=i?null==i?void 0:i.style.background:null;We.current&&(null===(n=null==Fe?void 0:Fe.current)||void 0===n?void 0:n.element)&&(Ge.current=a||"",Fe.current.element.style.background="#000"),null==s||s(e)}),[s]),bt=(0,i.useCallback)((e=>{var t;z("callback handleLoadedData",null===(t=Fe.current)||void 0===t?void 0:t.uuid),We.current=!0,null==u||u(e)}),[u]),kt=(0,i.useCallback)((e=>{if(!Fe.current)return;const{volume:t,muted:r,uuid:n}=Fe.current;z("callback handlerVolumeChange",n,t,r),de(Qe.current)&&r&&rt(!0),null==C||C(r?0:t)}),[C]),Pt=(0,i.useCallback)((()=>{null==g||g()}),[g]),St=(0,i.useCallback)((e=>{null==b||b(e)}),[b]),Ct=(0,i.useCallback)((()=>{var e;null==p||p(),Ze(!0);const t=Ge.current;(null===(e=null==Fe?void 0:Fe.current)||void 0===e?void 0:e.element)&&null!==t&&(Fe.current.element.style.background=t,Ge.current=null)}),[p]),Tt=(0,i.useCallback)((e=>{var t;z("callback handlePause",null===(t=Fe.current)||void 0===t?void 0:t.uuid),null==v||v(e)}),[v]),wt=(0,i.useCallback)((e=>{var t;z("callback handlePlaying",null===(t=Fe.current)||void 0===t?void 0:t.uuid),null==m||m(e)}),[m]),xt=(0,i.useCallback)((t=>{var n;z(Te,"handlePrevention",null===(n=Fe.current)||void 0===n?void 0:n.uuid,e,Qe.current),Le&&setTimeout((()=>{try{if(!de(Qe.current))return;if(De.current>=3)return void(null==x||x());if("xgplayer"===Le||!(null==t?void 0:t.errorName)||"NotAllowedError"===(null==t?void 0:t.errorName)){if(8===r)return void Tt(t);rt(!0);const e=Fe.current;Fe.current&&(Fe.current.muted=!0),null==e||e.play()}De.current+=1}catch(e){console.error("handle autoplay error",e)}}),0)}),[Le,r]);return(0,i.useEffect)((()=>{if(!Le)return;const e=Fe.current;return null==e||e.on(we,xt),()=>{var e;(null===(e=Fe.current)||void 0===e?void 0:e.element)&&Fe.current.off(we,xt)}}),[Le,xt]),(0,i.useEffect)((()=>{if(Le)return()=>{var e;const t=Fe.current;z(Ce,"release off events",null===(e=Fe.current)||void 0===e?void 0:e.uuid),t&&(t.off("playCatch",ot),t.off(te.Wu,dt),t.off("autoplay_was_prevented",lt))};((e,t)=>{const{playerPreload:r}=t;window.MultiMediaPreloader=G.IH,e&&e.updatePreloadConfig(Object.assign({getRequestOptionsCallback:se},r)),(0,D.as)((null==r?void 0:r.maxQueueCount)||3)})(ze.current,ge)}),[Le,ot]),(0,i.useEffect)((()=>{var t,r;z(Te,"playing",null===(t=Fe.current)||void 0===t?void 0:t.uuid,e,Qe.current,`playing:${vt} isPausedForced:${Be.current}`),vt?Be.current&&le&&(Be.current=!1,ht()):(Be.current=!0,null===(r=Fe.current)||void 0===r||r.pause())}),[le,vt,ht]),(0,i.useEffect)((()=>()=>{var e,t,r,n,i,a;const o=null===(r=null===(t=null===(e=Fe.current)||void 0===e?void 0:e.element)||void 0===t?void 0:t.getVideoPlaybackQuality)||void 0===r?void 0:r.call(t);if(o){null==ye||ye.updateFrameInfo({drop_frame:o.droppedVideoFrames,total_play_frame:o.totalVideoFrames,drop_frame_rate:o.droppedVideoFrames/o.totalVideoFrames,drop_frame_duration:o.creationTime});const e=null!==(a=null===(i=null===(n=Fe.current)||void 0===n?void 0:n.curDefinition)||void 0===i?void 0:i.codecType)&&void 0!==a?a:"";be.bt.setDropRate(o.droppedVideoFrames,o.totalVideoFrames,e)}}),[]),(0,i.useEffect)((()=>()=>{(0,I.uQ)(L.Y.PlayerDestroy),k(Ee(Fe.current,t))}),[]),(0,i.useEffect)((()=>{var n;return z(Ce,"releasePlayer0",null===(n=Fe.current)||void 0===n?void 0:n.uuid,e),()=>{var n,i,a,o,l,s,d;null===(n=Pe.mp4Preloader)||void 0===n||n.cancelLoading(),null===(a=null===(i=Fe.current)||void 0===i?void 0:i.metrics)||void 0===a||a.stop(),z(Ce,"releasePlayer1",null===(o=Fe.current)||void 0===o?void 0:o.uuid,e,Qe,t,r),null===(l=ze.current)||void 0===l||l.releasePlayer(Fe.current),null===(s=Ue.current)||void 0===s||s.detach(),null===(d=Ue.current)||void 0===d||d.destroy(),Ue.current=null,Ze(!1),Fe.current=null,null==P||P(!1)}}),[]),(0,F.Y)(_e,{containerId:`xgwrapper-${r}-${e}`,classList:["xgplayer-container","tiktok-web-player"],player:Fe.current,containerRef:Ne,bitrateInfo:Q,oncanplay:Ct,onplay:pt,onwaiting:mt,onended:ft,onbreak:gt,ontimeupdate:Pt,onerror:St,onpause:Tt,onplaying:wt,onloadstart:_t,onloadeddata:bt,onvolumechange:kt,onVideoPlayEnd:T,onResolutionReady:E,subtitle:4===r&&M?M:void 0,teaParams:Z,videoDimensionParams:xe,hitPreload:Ke,mode:r,id:e})})));var Me=r(64116),Ae=r(33805),Ie=r(53438),Le=r(48615),je=r(49057),Oe=r(99282),Ve=r(52333),Be=r(32098);let De=null,Fe=null;const Ue=(0,i.memo)((0,i.forwardRef)((function({poster:e,videoCover:t,lazyLoading:r=!0,horizontal:d,playUrl:k,id:T,teaParams:E,index:M,mode:F,itemMute:U,desc:N,topSearchQueryAfterViewWord:H,duration:Q,playbackRate:$=1,onVideoPause:z=A(),onVideoPlaying:q=A(),onVideoPlay:W,onVideoEnded:G,onVideoError:K,onTimeUpdate:Y,onLoadStart:J,onLoadedData:Z,onVolumeChange:X,onVideoUnmount:ee,onUserHandlePlayVideo:te,onUserHandlePauseVideo:re,onVideoInit:ne=A(),e2eTag:ie,subtitleStruct:ae,subtitleList:oe,curSubtitle:le,onSubtitleCallback:se,onResolutionReady:de,disableDownload:ue=!0,volumeInfo:ce=A(),adaptBitrateVid:pe,bitrateInfo:ve,bitrate:he,posterStyle:ye,playModeForTea:me,autoPlay:ge=!0,autoReplay:fe=!0,size:_e,playerStyle:be,fetchPriority:ke="auto",renderState:Pe=V.R.ACTIVE},Se){var Ce,Te,we,xe,Ee;const Ue=(0,h.Ul)(),Ne=null!==(Ce=(0,p.eu)())&&void 0!==Ce&&Ce,He=(0,c.ol)(),Qe=(0,h.hM)(),$e=(0,o.Nj)(l.Gs),ze=(0,o.Nj)(s.AU),qe=(0,i.useRef)(null),We=(0,i.useRef)(null),Ge=(0,p.J3)(),Ke=(0,c.S4)(),Ye=(0,a.HL)(),[Je,Ze]=(0,i.useState)(!1),[Xe,et]=(0,i.useState)(k),[tt,rt]=(0,i.useState)(!1),nt=(0,i.useRef)(null),it=(0,x.w)(Ve.k),at=(0,a.qZ)(),ot=(0,o.Nj)(y.V$),lt=null!=me?me:F;if(De||(De=(0,j.V)(),De&&(B.M.getInstance().channelInfo={domain:De.tea,channel:De.teaChannel,type:null!==(Te=De.teaChannelType)&&void 0!==Te?Te:"tcpy"})),!Fe&&(Fe=(0,O.x)(),Fe)){const{user:e,wid:t,region:r,odinId:n}=Fe;B.M.regionInfo={region:r,uid:(null==e?void 0:e.uid)||n||t,wid:t,isLogin:Boolean(e)}}const st=(0,h.w)(M,F,T),dt=[V.R.ACTIVE,V.R.BACKUP,V.R.RETAIN].includes(Pe)&&0===lt;(0,i.useEffect)((()=>{var e;let t=Pe;qe.current&&t===V.R.BACKUP?t=V.R.RETAIN:qe.current||t!==V.R.RETAIN||(t=V.R.BACKUP),null===(e=nt.current)||void 0===e||e.setRenderState(t||"")}),[Pe]),(0,i.useEffect)((()=>{if(Ue){const{index:e}=Ue;if(R()(e)&&(M-e<0||M-e>=3))return void(tt&&(rt(!1),nt.current=null))}if(!tt){const e=new u("webapp-desktop",{playReport:$e,experienceReport:ze});rt(!0),nt.current=e}}),[tt,Ue,M,$e,ze]);const ut=(0,i.useCallback)((()=>{var e,t;try{null==te||te(),null===(t=null===(e=qe.current)||void 0===e?void 0:e.play)||void 0===t||t.call(e)}catch(e){}}),[]),ct=(0,i.useCallback)((()=>{var e,t;null===(t=null===(e=qe.current)||void 0===e?void 0:e.pause)||void 0===t||t.call(e),null==re||re()}),[]);(0,i.useEffect)((()=>{const{id:e,mode:t}=null!=Ue?Ue:{};e===T&&F===t||et(k)}),[Ue,T,F,k]),(0,i.useEffect)((()=>{st||Ze(!1)}),[st]),(0,i.useImperativeHandle)(Se,(()=>({play:e=>{ut(),We.current=!0,e&&$e.triggerResume({enter_method:"click_resume",playMode:F})},pause:()=>{ct(),We.current=!1,$e.triggerPause({enter_method:"click_pause",playMode:lt,currentBackendSourceEventTracking:E.currentBackendSourceEventTracking})},seek:e=>{var t;null===(t=qe.current)||void 0===t||t.seek(e)},seekTime:e=>{var t;null===(t=qe.current)||void 0===t||t.seekTime(e)},onSeeked:e=>{var t;null===(t=qe.current)||void 0===t||t.onSeeked(e)},onSeeking:e=>{var t;null===(t=qe.current)||void 0===t||t.onSeeking(e)},onTimeUpdate:e=>{var t;null===(t=qe.current)||void 0===t||t.onTimeUpdate(e)},getFullscreen:e=>{var t;null===(t=qe.current)||void 0===t||t.getFullscreen(e)},exitFullscreen:e=>{var t;null===(t=qe.current)||void 0===t||t.exitFullscreen(e)},replay:()=>{var e;null===(e=qe.current)||void 0===e||e.replay()},updatePlayer:e=>{var t;null===(t=qe.current)||void 0===t||t.updatePlayer(e)},changeResolution:e=>{var t;null===(t=qe.current)||void 0===t||t.changeResolution(e)},getResolutionInfo:()=>{var e;return null===(e=qe.current)||void 0===e?void 0:e.getResolutionInfo()},get currentTime(){var e,t;return null!==(t=null===(e=qe.current)||void 0===e?void 0:e.getPlayerAttributes().currentTime)&&void 0!==t?t:0},get duration(){var e,t;return null!==(t=null===(e=qe.current)||void 0===e?void 0:e.getPlayerAttributes().duration)&&void 0!==t?t:0},get currentCanPlay(){return st&&Je}})),[Je,st,ct,ut,$e,lt,E.currentBackendSourceEventTracking]);const pt=(0,m.jj)();(0,i.useEffect)((()=>{var e;const t=null===We.current||We.current,{ended:r}=(0,g.L$)(null===(e=qe.current)||void 0===e?void 0:e.getPlayerAttributes());pt&&t&&ge&&(!r||fe)||8===F&&t?ut():(ct(),st&&!pt&&$e.triggerPause({enter_method:"switch_tab",playMode:lt,currentBackendSourceEventTracking:E.currentBackendSourceEventTracking}))}),[ge,pt,ut,ct,$e,st,lt,fe,F,E.currentBackendSourceEventTracking]);const vt=(0,Ie.Zd)({id:T}),ht=(0,Ie.Hs)(T),yt=(0,Ie.yy)(T,M),mt=(0,Oe.WH)(T),gt=(0,i.useMemo)((()=>{var e;const{videoQuality:t}=(0,g.L$)(null===(e=qe.current)||void 0===e?void 0:e.getPlayerAttributes()),{definition:r}=E;return(0,Me.H4)(t,r)}),[E]),ft=(0,i.useCallback)((()=>{var e;const t=(0,g.L$)(null===(e=qe.current)||void 0===e?void 0:e.getPlayerAttributes()),{videoBitrate:r,videoQuality:n,codecType:i}=t,a=(0,w.__rest)(t,["videoBitrate","videoQuality","codecType"]),{bitrate:o,author_id:l,format:s,encodedType:d,videoQuality:u,encodeUserTag:c,secret:p,forFriend:v,definition:h,playlist_id:y,popup_type:m,size:f}=E;return Object.assign(Object.assign(Object.assign(Object.assign({id:T,authorId:l,playMode:lt,bitrate:null!=r?r:o,format:s,encodedType:d,videoQuality:u,encodeUserTag:c,codecType:i,definition:gt,secret:p,forFriend:v,originalDefinition:h,playlist_id:y,popupType:m},null!=a?a:{}),ht),yt),{size:f})}),[T,E,gt,lt,ht,yt]),_t=(0,c.i3)(),bt=(0,i.useMemo)((()=>{const{group_id:e,author_id:t,is_scheduled:r,search_id:n,search_keyword:i,search_result_id:a,question_id:o,collection_id:l,collection_name:s,isPaidPartnership:d,poi_id:u,playlist_id:c,popup_type:p,enter_tab:v,diversify_id:h,enter_method:y,is_sub_only_video:m,tab_name:g,isPinnedItem:f,isReposted:_,is_just_watched:b,index_from_just_watched:k,currentBackendSourceEventTracking:P}=E;return Object.assign(Object.assign(Object.assign({itemId:e,authorId:t,isScheduled:Boolean(r),autoplayStatus:1,searchId:n,searchKeyword:i,searchResultId:a,questionId:o,playMode:lt,isMute:_t,collectionId:l,collectionName:s,isPaidPartnership:Boolean(d),poiId:u,playlistId:c,popupType:p,enterTab:v,diversifyId:h,enterMethod:y,isSubOnlyVideo:m,isCopyrightMuted:U,isPinnedItem:f,isReposted:_,tab_name:g,isAutoScroll:Ne,resolution:Qe,is_just_watched:b,index_from_just_watched:k,currentBackendSourceEventTracking:P},ht),yt),mt)}),[_t,U,E,Ne,Qe,lt,ht,yt,mt]),kt=(0,i.useCallback)((()=>{var e;const{currentTime:t=0,duration:r=0}=(0,g.L$)(null===(e=qe.current)||void 0===e?void 0:e.getPlayerAttributes());return Object.assign(Object.assign({},bt),{currentTime:t,duration:r,index:M})}),[M,bt]);(0,i.useEffect)((()=>{E&&tt&&nt.current&&(nt.current.videoPlayHandleParams=kt())}),[kt,E,tt]);const Pt=(0,i.useMemo)((()=>(0,v.fU)()?"":(0,Ae.N2)(window.location.pathname)),[]),{loading:St,handleCanPlayWithLoading:Ct,handlePauseWithLoading:Tt,handlePlayingWithLoading:wt,handleWaitingWithLoading:xt}=(0,m.iJ)({isCurrentVideo:st}),Et=(0,i.useCallback)((()=>{var e,t,r;null===(e=nt.current)||void 0===e||e.updateMetricsParams({playbackAttribute:null===(t=qe.current)||void 0===t?void 0:t.getPlayerAttributes(),videoQualityParams:ft()}),null===(r=nt.current)||void 0===r||r.onLoadStart(),null==J||J()}),[ft]),Rt=(0,i.useCallback)((()=>{var e,t,r;null===(e=nt.current)||void 0===e||e.updateMetricsParams({playbackAttribute:null===(t=qe.current)||void 0===t?void 0:t.getPlayerAttributes(),videoQualityParams:ft()}),null===(r=nt.current)||void 0===r||r.onLoadedData(),null==Z||Z()}),[ft]),Mt=(0,i.useCallback)((()=>{var e,t,r;null===(e=nt.current)||void 0===e||e.updateMetricsParams({playbackAttribute:null===(t=qe.current)||void 0===t?void 0:t.getPlayerAttributes(),videoQualityParams:ft()}),Ct(),Ze(!0),null==ne||ne(!0),null===(r=nt.current)||void 0===r||r.onCanPlay()}),[ft,Ct,ne]),At=(0,i.useCallback)((e=>{var t,r,n;null===(t=nt.current)||void 0===t||t.updateMetricsParams({playbackAttribute:null===(r=qe.current)||void 0===r?void 0:r.getPlayerAttributes(),videoQualityParams:ft()}),null===(n=nt.current)||void 0===n||n.onPlay(),null==W||W(e),it.addMlModelTrainData({id:T,action:"play",isPreview:1===F||7===F}),Ke.setCanAutoPlay(!0)}),[ft,W,T,it,F]),It=(0,i.useCallback)((()=>{var e,t,r,n;const{currentTime:i=0,duration:a=0,playerType:o}=(0,g.L$)(null===(e=qe.current)||void 0===e?void 0:e.getPlayerAttributes()),l=(0,D.ZQ)(),{byteLength:s,duration:d}=l.getPreloadCacheInfo(T);null===(t=nt.current)||void 0===t||t.updateMetricsParams({playbackAttribute:Object.assign(Object.assign(Object.assign({},vt),null===(r=qe.current)||void 0===r?void 0:r.getPlayerAttributes()),{preload_size:s,preload_time:d,player_type:o,bitrateInfo:ve}),videoQualityParams:ft()}),null===(n=nt.current)||void 0===n||n.onTimeUpdate(),null==Y||Y(i/a),S.e.handleFirstFrameVideo()}),[ft,Y,T,ve,vt]),Lt=(0,m.TL)(),jt=(0,i.useCallback)((e=>{const{httpCode:t=-1,errorCode:r=-1,errorMessage:n="",url:i="",response:a="",mode:o="",pathId:l=""}=e;ot.emitEvent("video_mse_error",{},{httpCode:String(t),errorCode:String(r),errorMessage:n,url:i,response:a,mode:o,pathId:l})}),[ot]),Ot=(0,i.useCallback)((e=>{var t,r,n,i;Ge.setPlayerError(),null==K||K(e);const a=ft(),o=null===(t=qe.current)||void 0===t?void 0:t.getPlayerAttributes();Lt(Object.assign(Object.assign({},o),a)),null===(r=nt.current)||void 0===r||r.updateMetricsParams({playbackAttribute:null===(n=qe.current)||void 0===n?void 0:n.getPlayerAttributes(),videoQualityParams:ft()}),null===(i=nt.current)||void 0===i||i.onError()}),[ft,K,Lt]),Vt=(0,i.useCallback)((e=>{var t,r,n;z(e),Tt(),null===(t=nt.current)||void 0===t||t.updateMetricsParams({playbackAttribute:null===(r=qe.current)||void 0===r?void 0:r.getPlayerAttributes(),videoQualityParams:ft()}),null===(n=nt.current)||void 0===n||n.onPause(),it.addMlModelTrainData({id:T,action:"pause"})}),[ft,z,Tt,T,it]),Bt=(0,i.useCallback)((e=>{var t,r,n;q(e),wt(),null===(t=nt.current)||void 0===t||t.updateMetricsParams({playbackAttribute:null===(r=qe.current)||void 0===r?void 0:r.getPlayerAttributes(),videoQualityParams:ft()}),null===(n=nt.current)||void 0===n||n.onPlaying()}),[ft,q,wt]),Dt=(0,i.useCallback)((()=>{var e,t,r,n,i,a;xt();const o=null===(e=qe.current)||void 0===e?void 0:e.getPlayerAttributes();if(o){null===(t=nt.current)||void 0===t||t.updateMetricsParams({playbackAttribute:null===(r=qe.current)||void 0===r?void 0:r.getPlayerAttributes(),videoQualityParams:ft()});const{buffered:e,currentTime:l=0,duration:s=0}=o,d=(null!==(n=null==e?void 0:e.length)&&void 0!==n?n:0)>0&&null!==(i=null==e?void 0:e.start(0))&&void 0!==i?i:0;if(Math.abs(d-l)<.5)return;if(Math.abs(s-l)<.5)return;null===(a=nt.current)||void 0===a||a.onWaiting(),it.addMlModelTrainData({id:T,action:"wait"})}}),[ft,xt,T,it]),{handleVvCountOnEnd:Ft,handleBreakCount:Ut}=(0,Be.K)(F),Nt=(0,i.useCallback)((()=>{Ut()}),[]),Ht=(0,i.useCallback)((e=>{null==X||X(e)}),[]),Qt=(0,i.useCallback)((e=>{var t,r,n;null===(t=nt.current)||void 0===t||t.updateMetricsParams({playbackAttribute:null===(r=qe.current)||void 0===r?void 0:r.getPlayerAttributes(),videoQualityParams:ft()}),null===(n=nt.current)||void 0===n||n.onEnded(),null==G||G(e),Ft(),it.addMlModelTrainData({id:T,action:"finish"})}),[ft,G,T,it]),$t=(0,i.useCallback)((e=>{var t,r,n,i;const a=(0,D.ZQ)(),{byteLength:o,duration:l}=a.getPreloadCacheInfo(T);null===(t=nt.current)||void 0===t||t.updateMetricsParams({playbackAttribute:null===(r=qe.current)||void 0===r?void 0:r.getPlayerAttributes(),videoQualityParams:ft()});const s=null===(n=qe.current)||void 0===n?void 0:n.getPlaybackQuality(),d=s?s.droppedVideoFrames/s.totalVideoFrames*100:0;null===(i=nt.current)||void 0===i||i.onUnmount(Object.assign(Object.assign({},e),{preload_size:o,preload_time:l,droppedRate:d})),it.addMlModelTrainData({id:T,action:"unmount"}),null==ee||ee()}),[ft,T,it]),zt=(0,i.useCallback)((e=>{e.preventDefault}),[]);(0,i.useEffect)((()=>{st||null==z||z({})}),[st,z]),(0,i.useEffect)((()=>{st&&(0,I.uQ)(L.Y.PlayerMounted)}),[st]);const qt=(0,i.useCallback)((()=>{null==ne||ne()}),[ne]),Wt=d||2===F||3===F||4===F||6===F||5===F,Gt=(0,i.useMemo)((()=>{const{videoQuality:e,definition:t}=E;return e&&t?`${e}_${t.substring(0,t.length-1)}_0`:"unknown_definition_from_xgpreload_config"}),[E]),{bitrateConfig:Kt}=(0,g.L$)((0,Le.U)((()=>["bitrateConfig"]),[])),{isTTP:Yt}=null!==(we=(0,Le.U)((()=>["isTTP"]),[]))&&void 0!==we?we:{},{region:Jt}=null!==(xe=(0,je.W)((()=>["region"]),[]))&&void 0!==xe?xe:{},{abTestVersion:Zt}=null!==(Ee=(0,je.W)((()=>["abTestVersion"]),[]))&&void 0!==Ee?Ee:{},Xt=(0,a.pd)("desktop"),er=(0,a.ZC)(),tr=(0,a.iM)("desktop"),rr=(0,a.Yu)(),nr=B.M.getInstance();nr.isTTP=Yt,Zt&&(nr.abTestVersion=Zt.versionName,B.M.setABTest(rr)),Xt&&(nr.hevcAbVersion=Xt,B.M.setHevcTestData(tr));const{normalizationVid:ir,playbackNormalizePath:ar}=(0,a.KV)(),or=(0,o.Nj)(D.JX),lr=or.getPreloadUrls(),sr=(0,m.CT)(lr,Gt),{playerInitHost:dr}=(0,a.NY)(),{videoOrder:ur}=(0,a.Xl)(),{bitrateSelectorConfigs:cr}=(0,a.Tg)(),{preloadConfigVid:pr}=(0,a.Md)(),vr=H?`${H}. ${N}`:N,{armCoreContentEvent:hr}=(0,i.useContext)(b.e),yr=(0,i.useCallback)((()=>{null==hr||hr(),ot.reportActualFMP(),S.e.handleActualFMP()}),[hr,ot]);(0,C.w)({isCurrentVideo:st,index:M,mode:F});const mr=(0,i.useCallback)((e=>{const{errorCode:t,errorMessage:r,logid:n}=e;ot.emitEvent("video_play_end",{count:1},{is_success:`${0===t}`,error_code:String(t),error_msg:r,logid:n})}),[ot]);return(0,n.jsxs)(P.Le,{horizontal:d,mode:F,style:be,children:[e?(0,n.jsx)(P.R,{horizontal:Wt,mode:F,src:e,alt:vr,loading:r?"lazy":"eager",style:ye,onLoad:yr,fetchPriority:ke}):t?(0,n.jsx)(_.x,{video:t,objectFit:Wt?"contain":"cover",style:ye,alt:vr,onLoad:yr,fetchPriority:ke}):null,(st||dt)&&(0,n.jsxs)(P.Ec,{horizontal:Wt,"data-e2e":ie,children:[(0,n.jsx)(Re,{ref:qe,id:T,url:Xe,playbackRate:$,mode:F,muteSetting:U||f.T5[F].forceMute,defaultMute:f.T5[F].defaultMute,playProgress:null!=He?He:0,duration:Q,onUnmount:$t,onLoadStart:Et,onLoadedData:Rt,onTimeUpdate:It,onError:Ot,onCanPlay:Mt,onPause:Vt,onPlay:At,onPlaying:Bt,onWaiting:Dt,onEnded:Qt,onBreak:Nt,onVideoChange:qt,onResolutionReady:de,userResolution:Qe,onContextMenu:zt,onVideoVolumeChange:Ht,onVideoPlayEnd:mr,subtitleStruct:ae,subtitleList:oe,curSubtitle:le,onSubtitleCallback:se,disableDownload:ue,volumeInfo:ce,adaptBitrateVid:pe,bitrateInfo:ve,defaultDefinition:Gt,bitrateConfig:Kt,preloader:or,normalizationVid:ir,playbackNormalizePath:ar,preloadUrlsList:sr,playerInitHost:dr,defaultBitrate:he,videoOrder:ur,teaParams:E,autoPlay:ge,autoReplay:fe,size:_e,bitrateSelectorConfigs:cr,preloadConfigVid:pr,pathId:Pt,metrics:nt.current,hevcTest:tr,hevcRobustnessTest:at,playbackAbTestInfo:Object.assign(Object.assign({},rr),er),handleMseError:jt,isTTP:!!Yt&&"US"===Jt,vIndex:M,renderState:Pe,onAutoplayPrevented:()=>{Ye&&Ke.setCanAutoPlay(!1)}}),St&&(0,n.jsx)(P.K3,{})]})]})}))),Ne=(0,i.memo)((0,i.forwardRef)((function(e,t){const r=(0,i.useRef)(null);(0,i.useImperativeHandle)(t,(()=>({play:e=>{var t,n;(null===(t=r.current)||void 0===t?void 0:t.play)&&(null===(n=r.current)||void 0===n||n.play(e))},pause:()=>{var e,t;(null===(e=r.current)||void 0===e?void 0:e.pause)&&(null===(t=r.current)||void 0===t||t.pause())},seek:e=>{var t,n;(null===(t=r.current)||void 0===t?void 0:t.seek)&&(null===(n=r.current)||void 0===n||n.seek(e))},seekTime:e=>{var t,n;(null===(t=r.current)||void 0===t?void 0:t.seekTime)&&(null===(n=r.current)||void 0===n||n.seekTime(e))},onSeeked:e=>{var t,n;(null===(t=r.current)||void 0===t?void 0:t.onSeeked)&&(null===(n=r.current)||void 0===n||n.onSeeked(e))},onSeeking:e=>{var t,n;(null===(t=r.current)||void 0===t?void 0:t.onSeeking)&&(null===(n=r.current)||void 0===n||n.onSeeking(e))},onTimeUpdate:e=>{var t,n;(null===(t=r.current)||void 0===t?void 0:t.onTimeUpdate)&&(null===(n=r.current)||void 0===n||n.onTimeUpdate(e))},getFullscreen:e=>{var t;null===(t=r.current)||void 0===t||t.getFullscreen(e)},exitFullscreen:e=>{var t;null===(t=r.current)||void 0===t||t.exitFullscreen(e)},replay:()=>{var e,t;(null===(e=r.current)||void 0===e?void 0:e.replay)&&(null===(t=r.current)||void 0===t||t.replay())},updatePlayer:e=>{var t,n;(null===(t=r.current)||void 0===t?void 0:t.updatePlayer)&&(null===(n=r.current)||void 0===n||n.updatePlayer(e))},changeResolution:e=>{var t,n;(null===(t=r.current)||void 0===t?void 0:t.changeResolution)&&(null===(n=r.current)||void 0===n||n.changeResolution(e))},getResolutionInfo:()=>{var e;return null===(e=r.current)||void 0===e?void 0:e.getResolutionInfo()},get currentTime(){var e,t;return null!==(t=null===(e=r.current)||void 0===e?void 0:e.currentTime)&&void 0!==t?t:0},get duration(){var e,t;return null!==(t=null===(e=r.current)||void 0===e?void 0:e.duration)&&void 0!==t?t:0},get currentCanPlay(){var e,t;return null!==(t=null===(e=r.current)||void 0===e?void 0:e.currentCanPlay)&&void 0!==t&&t}})));const{isUseNativePlayer:o,adaptBitrateVid:l}=(0,a.Sc)();return o?(0,n.jsx)(T,Object.assign({},e,{ref:r})):(0,n.jsx)(Ue,Object.assign({},e,{adaptBitrateVid:l,ref:r}))})))},1967:(e,t,r)=>{r.d(t,{CZ:()=>d,Ec:()=>l,K3:()=>s,Le:()=>a,R:()=>o});var n=r(62186),i=r(84827);const a=(0,n.default)("div",{target:"e1yey0rl0"})((({horizontal:e,mode:t,theme:{colors:r}})=>[{width:"100%",height:"100%",overflow:"hidden",position:"relative",backgroundColor:1===t?r.BGPlaceholderOpaque:r.BGPlaceholderDefault,backgroundSize:e?"contain":"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"},2===t||1===t||3===t||5===t?{display:"flex",alignItems:"center",justifyContent:"center"}:null]),"label:DivContainer;"),o=(0,n.default)("img",{target:"e1yey0rl1"})((({horizontal:e,mode:t,fetchPriority:r="auto"})=>2!==t&&3!==t&&4!==t&&5!==t?{width:"100%",height:"100%",objectFit:"cover",fetchPriority:r}:{width:"100%",height:"100%",objectFit:e?"contain":"cover",fetchPriority:r}),"label:ImgPoster;"),l=(0,n.default)("div",{target:"e1yey0rl2"})((({horizontal:e=!0})=>({position:"absolute",left:0,top:0,width:"100%",height:"100%","& .xgplayer video":{display:"block",width:"100%",height:"100%",objectFit:e?"contain":"cover"},"& .tiktok-web-player video":{display:"block",width:"100%",height:"100%",objectFit:e?"contain":"cover"}})),"label:DivBasicPlayerWrapper;"),s=(0,n.default)(i.R,{target:"e1yey0rl3"})({position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},"label:StyledLoading;"),d=(0,n.default)("video",{target:"e1yey0rl4"})((({horizontal:e})=>({display:"block",width:"100%",height:"100%",objectFit:e?"contain":"cover"})),"label:VideoBasic;")},49677:(e,t,r)=>{r.d(t,{_:()=>a});var n,i=r(93608);!function(e){e.General="general",e.Photosensitive="photosensitive",e.LoggedOut="logged_out",e.AgeRestriction="age_restriction"}(n||(n={}));const a={handleRemovePhotosensitiveStatus:e=>{i.f.sendEvent("tns_remove_photosensitive_status",{status:e})},handleShowMaskLayer:e=>{i.f.sendEvent("tns_show_mask_layer",e)},handleShowPhotosensitiveRemoved:e=>{i.f.sendEvent("tns_show_photosensitive_removed",e)},handleMaskLayerClickSkip:e=>{i.f.sendEvent("tns_mask_layer_click_skip",e)},handleMaskLayerClickWatch:e=>{i.f.sendEvent("tns_mask_layer_click_watch",e)},handleCCMaskShow:e=>{i.f.sendEvent("cc_mask_show",e)},handleClickLogInCCMask:e=>{i.f.sendEvent("click_log_in_cc_mask",e)}}}}]);