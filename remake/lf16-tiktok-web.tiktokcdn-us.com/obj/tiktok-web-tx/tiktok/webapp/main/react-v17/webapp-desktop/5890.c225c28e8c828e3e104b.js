"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[5890],{42257:(e,t,a)=>{var i;a.d(t,{Ag:()=>s}),function(e){e[e.Video=0]="Video",e[e.Creator=1]="Creator",e[e.Music=2]="Music",e[e.Tag=3]="Tag"}(i||(i={}));const s={copy:"copy",whatsapp:"whatsapp",facebook:"facebook",twitter:"twitter",reddit:"reddit",pinterest:"pinterest",vk:"vk",sms:"sms",embed:"embed",telegram:"telegram",line:"line",linkedin:"linkedin",email:"email",message:"message",repost:"repost"};var r,o;!function(e){e[e.DEFAULT=0]="DEFAULT",e[e.HEADER=1]="HEADER",e[e.BOTTOM=2]="BOTTOM",e[e.BrowserModePopup=3]="BrowserModePopup"}(r||(r={})),function(e){e[e.Icon=0]="Icon",e[e.Entry=1]="Entry",e[e.Corner=2]="Corner"}(o||(o={}))},90621:(e,t,a)=>{a.d(t,{d:()=>u});var i=a(58632),s=a(64162),r=a(4126),o=a(93995),n=a(71510),d=a.n(n),l=a(8800),c=a(55306);let u=class extends s.E{constructor(e){super(),this.userModule=e,this.defaultState={}}setItem(e,t){t.id_str&&(e[t.id_str]=t)}updateItem(e,t){t.id_str&&e[t.id_str]&&(e[t.id_str]=d()(e[t.id_str],t))}multiSetItem(e,t){t.forEach((t=>this.setItem(e,t)))}addItems(e){const t=e.filter((e=>Boolean(e.owner))).map((e=>{var t,a;return(0,l.bg)(Object.assign(Object.assign({},e.owner),{unique_id:null===(t=e.owner)||void 0===t?void 0:t.display_id,custom_verify:null===(a=e.owner)||void 0===a?void 0:a.authentication_info,room_id:e.id_str}))}));return[this.userModule.getActions().multiSetUser(t),this.getActions().multiSetItem(e)]}setDeleteVideo(e,t){e[t]&&(e[t]=void 0)}};(0,i.__decorate)([(0,r.h5)(),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[Object,Object]),(0,i.__metadata)("design:returntype",void 0)],u.prototype,"setItem",null),(0,i.__decorate)([(0,r.h5)(),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[Object,Object]),(0,i.__metadata)("design:returntype",void 0)],u.prototype,"updateItem",null),(0,i.__decorate)([(0,r.h5)(),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[Object,Array]),(0,i.__metadata)("design:returntype",void 0)],u.prototype,"multiSetItem",null),(0,i.__decorate)([(0,r.h5)(),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[Object,String]),(0,i.__metadata)("design:returntype",void 0)],u.prototype,"setDeleteVideo",null),u=(0,i.__decorate)([(0,o.n)("LiveModule"),(0,i.__metadata)("design:paramtypes",[c.U])],u)},87303:(e,t,a)=>{a.d(t,{F:()=>g});var i=a(58632),s=a(64162),r=a(4126),o=a(93995),n=a(45537),d=a.n(n),l=a(300),c=a.n(l),u=a(23999),_=a(26324),h=a(24451),p=a(8536),v=a(90621);Object.freeze({statusCode:0,loading:!0,list:[],browserList:[],hasMore:!0,cursor:"0"});let g=class extends s.E{constructor(e){super(),this.live=e,this.defaultState={}}resetLiveList(e,t){const{key:a,hasMore:i=!0,loading:s=!0,cursor:r="0"}=t;e[a]={list:[],browserList:[],loading:s,statusCode:0,hasMore:i,cursor:r}}addLiveList(e,t){const{key:a,list:i,statusCode:s=0,hasMore:r,cursor:o}=t;e[a]||(e[a]={list:[],browserList:[],loading:!1,statusCode:s,hasMore:Boolean(r),cursor:o}),e[a].list=d()(e[a].list,c()(i,"id_str").map((({id_str:e})=>e))),e[a].statusCode=s,e[a].hasMore=r,e[a].cursor=o}setLoading(e,t){const{loading:a,key:i}=t;e[i]||(e[i]={list:[],browserList:[],loading:a,statusCode:0,hasMore:!0,cursor:"0"}),e[i].loading=a}setListKeyword(e,t){const{keyword:a,key:i}=t;e[i]||(e[i]={keyword:a,list:[],browserList:[],loading:!1,statusCode:0,hasMore:!0,cursor:"0"}),e[i].keyword=a}setList(e){return e.pipe((0,h.E)(this.state$),(0,p.Z)((([{key:e,response:t}])=>{const{liveList:a=[],statusCode:i=0,hasMore:s=!1,cursor:r="0"}=t;return 0===i?(0,u.of)(...this.live.addItems(a),this.getActions().addLiveList({key:e,list:a,statusCode:i,hasMore:s,cursor:r})):(0,u.of)(this.getActions().addLiveList({key:e,list:[],statusCode:i,hasMore:!0}))})))}};(0,i.__decorate)([(0,r.uk)(),(0,i.__metadata)("design:type",_.c)],g.prototype,"dispose$",void 0),(0,i.__decorate)([(0,r.h5)(),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[Object,Object]),(0,i.__metadata)("design:returntype",void 0)],g.prototype,"resetLiveList",null),(0,i.__decorate)([(0,r.h5)(),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[Object,Object]),(0,i.__metadata)("design:returntype",void 0)],g.prototype,"addLiveList",null),(0,i.__decorate)([(0,r.h5)(),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[Object,Object]),(0,i.__metadata)("design:returntype",void 0)],g.prototype,"setLoading",null),(0,i.__decorate)([(0,r.h5)(),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[Object,Object]),(0,i.__metadata)("design:returntype",void 0)],g.prototype,"setListKeyword",null),(0,i.__decorate)([(0,r.Mj)(),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[_.c]),(0,i.__metadata)("design:returntype",void 0)],g.prototype,"setList",null),g=(0,i.__decorate)([(0,o.n)("LiveList"),(0,i.__metadata)("design:paramtypes",[v.d])],g)},45489:(e,t,a)=>{a.d(t,{fu:()=>m});var i=a(58632),s=a(4126),r=a(93995),o=a(46657),n=a(68628),d=a(23999),l=a(26324),c=a(24451),u=a(35572),_=a(8536),h=a(80339),p=a(2408),v=a(34360),g=a(53966);let m=class extends g.E{constructor(){super(...arguments),this.defaultState={isSearchPersonalized:!0,isFeedPersonalized:!0,isSearchConfigInitialized:!1,isFeedConfigInitialized:!1,isManageModalOpen:!1,isExplanationModalOpen:!1,isShowingToast:!1}}setIsShowingToast(e,t){(0,p.nH)().setIsShowingToast(t)}setIsManageModalOpen(e,t){(0,p.nH)().setIsManageModalOpen(t)}setIsExplanationModalOpen(e,t){(0,p.nH)().setIsExplanationModalOpen(t)}setIsSearchPersonalized(e,t){(0,p.nH)().setIsSearchPersonalized(t)}setIsFeedPersonalized(e,t){(0,p.nH)().setIsFeedPersonalized(t)}setSearchConfigInitialized(e,t){(0,p.nH)().setSearchConfigInitialized(t)}setFeedConfigInitialized(e,t){(0,p.nH)().setFeedConfigInitialized(t)}staticInit(e,t){(0,p.nH)().init(t)}init(e){return e.pipe((0,c.E)(this.state$),(0,u.p)((([{isFeed:e},{isSearchConfigInitialized:t,isFeedConfigInitialized:a}])=>t&&!e||a&&e?o.w:(0,n.H)((0,p.nH)().init({isFeed:e})).pipe((0,_.Z)((()=>(0,d.of)(this.noop()))),(0,h.q)(this.terminate("init"))))))}};m.jotaiAtom=p.WH,(0,i.__decorate)([(0,s.h5)(),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[Object,Boolean]),(0,i.__metadata)("design:returntype",void 0)],m.prototype,"setIsShowingToast",null),(0,i.__decorate)([(0,s.h5)(),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[Object,Boolean]),(0,i.__metadata)("design:returntype",void 0)],m.prototype,"setIsManageModalOpen",null),(0,i.__decorate)([(0,s.h5)(),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[Object,Boolean]),(0,i.__metadata)("design:returntype",void 0)],m.prototype,"setIsExplanationModalOpen",null),(0,i.__decorate)([(0,s.h5)(),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[Object,Boolean]),(0,i.__metadata)("design:returntype",void 0)],m.prototype,"setIsSearchPersonalized",null),(0,i.__decorate)([(0,s.h5)(),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[Object,Boolean]),(0,i.__metadata)("design:returntype",void 0)],m.prototype,"setIsFeedPersonalized",null),(0,i.__decorate)([(0,s.h5)(),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[Object,Boolean]),(0,i.__metadata)("design:returntype",void 0)],m.prototype,"setSearchConfigInitialized",null),(0,i.__decorate)([(0,s.h5)(),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[Object,Boolean]),(0,i.__metadata)("design:returntype",void 0)],m.prototype,"setFeedConfigInitialized",null),(0,i.__decorate)([(0,s.h5)(),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[Object,Object]),(0,i.__metadata)("design:returntype",void 0)],m.prototype,"staticInit",null),(0,i.__decorate)([(0,s.Mj)(),(0,i.__metadata)("design:type",Function),(0,i.__metadata)("design:paramtypes",[l.c]),(0,i.__metadata)("design:returntype",void 0)],m.prototype,"init",null),m=(0,i.__decorate)([(0,r.n)("SearchPersonalization")],m),p.WH.__SIGI_MODULE__=m,(0,v.y)(m)},43271:(e,t,a)=>{a.d(t,{Fy:()=>D,I4:()=>V,tq:()=>U});var i,s,r=a(58632),o=a(64162),n=a(4126),d=a(93995),l=a(340),c=a(23999),u=a(63700),_=a(26324),h=a(24451),p=a(62564),v=a(72916),g=a(8536),m=a(74690),y=a(80339),b=a(76435),S=a(95719),k=a(20259),f=a(82715),w=a(65365),O=a(42713),j=a(11983),L=a(97086),P=a(64356),I=a(8800),M=a(27375),A=a(54888),T=a(87303),E=a(49799),C=a(55306),G=a(59952),F=a(79983),x=a(45489),z=a(30264),$=a(46705);!function(e){e[e.NetworkError=-1]="NetworkError",e[e.NoResultText=10]="NoResultText",e[e.SelfHarmText=11]="SelfHarmText",e[e.HateSexualizationText=12]="HateSexualizationText",e[e.Guide=13]="Guide"}(i||(i={})),function(e){e.ShowWithButton="show_with_button",e.ShowDirectly="show_directly",e.NoResult="no_results"}(s||(s={}));const D={keyword:"",error:null,loading:!0,hasMore:!0,cursor:0,items:[],preloadList:[],searchPrecheck:null},V={keyword:"",error:null,loading:!0,hasMore:!0,totalLength:0,isGoToHashtag:!1,cursor:0,data:{videoList:[],otherDataList:[]},preloadList:[],searchPrecheck:null},B={rootEnterFrom:void 0,preSearchId:void 0},R={1:(e,t)=>{var a,i,s,r,o,n,d,l,c;t.totalLength++,t.data.videoList=[...t.data.videoList,null!==(i=null===(a=e.item)||void 0===a?void 0:a.id)&&void 0!==i?i:""];const u={id:null!==(o=null===(r=null===(s=e.item)||void 0===s?void 0:s.video)||void 0===r?void 0:r.id)&&void 0!==o?o:"",url:null!==(l=null===(d=null===(n=e.item)||void 0===n?void 0:n.video)||void 0===d?void 0:d.playAddr)&&void 0!==l?l:""};t.preloadList=[...null!==(c=t.preloadList)&&void 0!==c?c:[],u]},4:(e,t)=>{var a,i;const s=t.data.videoList.length,r={type:e.type,items:null===(a=e.user_list)||void 0===a?void 0:a.map((({user_info:e})=>{var a;return t.totalLength++,null!==(a=e.unique_id)&&void 0!==a?a:""})),position:s%6==0?s:6*Math.ceil(s/6),hasMore:null!==(i=e.view_more)&&void 0!==i&&i,common:e.common};t.data.otherDataList=[...t.data.otherDataList,r]},20:(e,t)=>{var a,i,s,r,o,n,d,l,c;const u=t.data.videoList.length;t.totalLength++;const _={type:e.type,items:[null!==(i=null===(a=e.user_live)||void 0===a?void 0:a.user_info.user_info.unique_id)&&void 0!==i?i:""],lives:[null!==(o=null===(r=null===(s=e.user_live)||void 0===s?void 0:s.live_info)||void 0===r?void 0:r.id_str)&&void 0!==o?o:""],position:u%6==0?u:6*Math.ceil(u/6),hasMore:null!==(n=e.view_more)&&void 0!==n&&n,common:e.common,teaParams:{search_result_id:null!==(c=null===(l=null===(d=e.user_live)||void 0===d?void 0:d.user_info)||void 0===l?void 0:l.user_info.uid)&&void 0!==c?c:""}};t.data.otherDataList=[...t.data.otherDataList,_]},61:(e,t)=>{var a,i,s,r;const o=t.data.videoList.length;t.totalLength++;const n={type:e.type,lives:null===(a=e.live_collection)||void 0===a?void 0:a.map((({id_str:e})=>e)),position:o%6==0?o:6*Math.ceil(o/6),hasMore:null!==(i=e.view_more)&&void 0!==i&&i,common:e.common,teaParams:{search_result_id:null!==(r=null===(s=e.common)||void 0===s?void 0:s.doc_id_str)&&void 0!==r?r:""}};t.data.otherDataList=[...t.data.otherDataList,n]}},H={1:(e,t,a)=>{var i,s,r;const{enter_from:o,totalLength:n,count:d,impr_id:l,videoCount:c,videoStart:u}=t;w.$G.handleSearchVideoImpression(Object.assign(Object.assign({},a),{enter_from:o,rank:u+c,item_rank:n+d,group_id:null===(i=e.item)||void 0===i?void 0:i.id,author_id:null===(r=null===(s=e.item)||void 0===s?void 0:s.author)||void 0===r?void 0:r.id,impr_id:l})),t.count++,t.videoCount++},4:(e,t,a)=>{var i;const{enter_from:s,userStart:r,userCount:o,totalLength:n,count:d,impr_id:l}=t;return null===(i=e.user_list)||void 0===i||i.forEach((e=>{var i;const c=Object.assign(Object.assign({},a),{search_result_id:e.user_info.uid});w.$G.handleSearchImpression(Object.assign({enter_from:s,rank:r+o,item_rank:n+d,impr_id:l},c));const u=null!==(i=e.user_info.room_id_str)&&void 0!==i?i:String(e.user_info.room_id);Boolean(Number(u))&&O.lu.handleLiveShow(Object.assign({room_id:u,anchor_id:e.user_info.uid,action_type:"click",enter_from_merge:"general_search",enter_method:"others_photo"},c)),t.count++,t.userCount++})),t},61:(e,t,a)=>{var i,s,r;const{enter_from:o}=t,n=Object.assign(Object.assign({},a),{search_result_id:null!==(s=null===(i=e.common)||void 0===i?void 0:i.doc_id_str)&&void 0!==s?s:"",enter_from:o,token_type:"live_card",is_aladdin:1,rank:0});w.$G.handleSearchImpression(n),null===(r=e.live_collection)||void 0===r||r.forEach(((e,t)=>{w.$G.handleSearchImpression(Object.assign(Object.assign({},n),{aladdin_words:e.title,aladdin_rank:t,list_result_type:"live",list_item_id:e.id_str,realtime_watch_user:e.user_count}))})),t.count++},20:(e,t,a)=>{var i,s,r,o,n;const{enter_from:d,impr_id:l}=t,{user_info:c,live_info:u}=null!==(i=null==e?void 0:e.user_live)&&void 0!==i?i:{},_=Object.assign(Object.assign({},a),{search_result_id:null!==(s=null==c?void 0:c.user_info.uid)&&void 0!==s?s:""}),h=Object.assign(Object.assign({},_),{user_name:null===(r=null==c?void 0:c.user_info)||void 0===r?void 0:r.nickname,user_tag:"",enter_from:d,token_type:"hot_user",is_aladdin:1,rank:0});w.$G.handleSearchImpression(Object.assign(Object.assign({},h),{impr_id:l})),w.$G.handleSearchImpression(Object.assign(Object.assign({},h),{list_result_type:"live",list_item_id:null!==(o=null==u?void 0:u.id_str)&&void 0!==o?o:""}));const p=null==u?void 0:u.id_str;p&&O.lu.handleLiveShow(Object.assign(Object.assign({},_),{room_id:p,anchor_id:null!==(n=null==c?void 0:c.user_info.uid)&&void 0!==n?n:"",action_type:"click",enter_from_merge:"general_search",enter_method:"others_photo"})),t.count++}};let U=class extends o.E{constructor(e,t,a,i,s,r,o,n,d,l){super(),this.service=e,this.user=t,this.seoModule=a,this.itemList=i,this.liveList=s,this.videoMask=r,this.bizContext=o,this.videoPlayerJotai=n,this.personalization=d,this.t=l,this.defaultState={showTabs:!0,general:V,user:D,video:D,live:D,searchReminderData:null,searchGlobalParams:B}}setSearchResult(e,t){const{key:a,result:i}=null!=t?t:{};e[a]=i}setSearchReminderData(e,t){e.searchReminderData=t.data}addSearchResult(e,t){var a,i,s,r,o;const{key:n,result:d}=null!=t?t:{};if(!e[n])return e[n]=d,e;e[n]=Object.assign(Object.assign(Object.assign({},e[n]),d),{items:null===(i=null===(a=e[n])||void 0===a?void 0:a.items)||void 0===i?void 0:i.concat(d.items),preloadList:null===(r=null===(s=e[n])||void 0===s?void 0:s.preloadList)||void 0===r?void 0:r.concat(null!==(o=d.preloadList)&&void 0!==o?o:[])})}addTopSearchResult(e,t){var a,i;const s=e.general;null===(a=t.data)||void 0===a||a.forEach((e=>{e.type&&R[e.type](e,s)})),e.general=Object.assign(Object.assign({},e.general),{hasMore:Boolean(t.has_more),cursor:null!==(i=t.cursor)&&void 0!==i?i:0,data:Object.assign({},s.data),rid:t.rid,preloadList:s.preloadList})}setSearchLoading(e,t){const{key:a,loading:i}=null!=t?t:{};e[a].loading=i}setIsGoToHashtag(e,t){const{key:a,isGoToHashtag:i}=null!=t?t:{};e[a].isGoToHashtag=i}setShowTabs(e,t){e.showTabs=t}setSearchGlobalParams(e,t){e.searchGlobalParams=Object.assign(Object.assign({},e.searchGlobalParams),t)}setSearchPrecheck(e,t){const{key:a,value:i}=null!=t?t:{};e[a].searchPrecheck=i}setKeyword(e,t){const{key:a,keyword:i}=t;e[a].keyword=i}resetSearchResult(e){e.general=V,e.user=D,e.video=D,e.live=D}getTopSearch(e){return e.pipe((0,h.E)(this.state$,this.videoMask.state$,this.bizContext.state$,this.personalization.state$,this.videoPlayerJotai.state$),(0,p.T)((([e,t,a,i,{isSearchPersonalized:s},r])=>({query:e,state:t.general,videoMaskState:a,bizContextState:i,searchGlobalParams:t.searchGlobalParams,nonPersonalized:s?void 0:1,currentVideo:r.currentVideo}))),(0,v.n)((e=>{var t=e.query,{teaParams:a,abTestVersion:i,user:s,language:o,hasSearchLive:n}=t,d=(0,r.__rest)(t,["teaParams","abTestVersion","user","language","hasSearchLive"]),{state:l,state:{cursor:_,data:h,rid:v},videoMaskState:S,searchGlobalParams:k,nonPersonalized:w,currentVideo:O}=e;let j=(0,c.of)({});d.keyword&&!(0,L.fU)()&&(j=this.service.getTopSearch(Object.assign(Object.assign({},d),{offset:_,search_id:v,web_search_code:this.getWebSearchCode(i),is_non_personalized_search:w})));const P=Date.now();return j.pipe((0,p.T)((e=>{var t,a;return Object.assign(e,{data:null!==(a=null===(t=e.data)||void 0===t?void 0:t.map((e=>{var t,a,i,s,r,o;switch(e.type){case 20:return n?Object.assign(e,{user_live:{live_info:JSON.parse(null!==(i=null===(a=null===(t=e.user_live)||void 0===t?void 0:t.live_info)||void 0===a?void 0:a.raw_data)&&void 0!==i?i:"{}"),user_info:null===(s=e.user_live)||void 0===s?void 0:s.user_info}}):null;case 61:return n?Object.assign(e,{live_collection:null===(o=null===(r=e.live_collection)||void 0===r?void 0:r.live_list)||void 0===o?void 0:o.map((({raw_data:e="{}"})=>JSON.parse(e)))}):null;case 4:case 1:return e;default:return null}})).filter((e=>Boolean(e))))&&void 0!==a?a:[]})})),this.handleTopSearchReport({state:l,keyword:d.keyword,isSendSearch:0===_,teaParams:a,requestStart:P,searchGlobalParams:k,groupId:null==O?void 0:O.id}),(0,g.Z)((e=>{var t,a,r,n,_,h;let p=!1;const g=null===(t=null==e?void 0:e.global_doodle_config)||void 0===t?void 0:t.forbid_search_type;(1===g||0===g&&0===(null===(a=null==e?void 0:e.data)||void 0===a?void 0:a.length))&&(p=!0);const m=this.seoModule.setSearchSEOProps(e,{language:o},{pathname:f.OZ.searchHome,input_keyword:d.keyword}),{has_more:y,data:b=[],extra:k={},search_nil_info:w,suicide_prevent:O,search_nil_text:j,status_code:L,log_pb:P}=e,I=[0,203,403].includes(L)?0:L,{logid:M}=k,A=null!==(r=null!=v?v:M)&&void 0!==r?r:"",T=w&&[11,13].includes(null!==(n=w.text_type)&&void 0!==n?n:0);if(!b.length&&!y&&!T)return this.generateErrorState({search_nil_info:w,search_nil_text:j,suicide_prevent:O,state:l,key:"general",keyword:d.keyword,pathname:f.OZ.searchHome,action$s:[m]});const E=[],C=[],G={hasMore:Boolean(y),statusCode:I,itemList:[],rid:A,log_pb:P},F={hasMore:Boolean(y),statusCode:I,liveList:[],rid:A};let x=null;T&&(x={type:null!==(_=null==w?void 0:w.text_type)&&void 0!==_?_:11,data:Object.assign(Object.assign({},O),{et_search_id:A})}),b.forEach((e=>{var t,a,i,s,r;switch(e.type){case 1:G.itemList.push(e.item);break;case 4:const o=Object.assign(Object.assign({},e),{items:[]}),{user_list:n=[]}=e;n.forEach((({user_info:e={}})=>{const{user:t,stats:a}=this.userConvertor(e,A,null==P?void 0:P.impr_id),{unique_id:i=""}=e;E.push(t),C.push(a),o.items.push(i)}));break;case 20:if(null===(a=null===(t=e.user_live)||void 0===t?void 0:t.user_info)||void 0===a?void 0:a.user_info){const{user_live:{user_info:{user_info:t}}}=e,{user:a,stats:i}=this.userConvertor(t,A,null==P?void 0:P.impr_id);E.push(a),C.push(i)}(null===(s=null===(i=e.user_live)||void 0===i?void 0:i.live_info)||void 0===s?void 0:s.id_str)&&F.liveList.push(e.user_live.live_info);break;case 61:null===(r=e.live_collection)||void 0===r||r.forEach((e=>{e.id_str&&F.liveList.push(e)}))}})),(1===(null==s?void 0:s.photoSensitiveVideosSetting)||!s&&1===S.photoSensitiveVideosSetting)&&(e.data=null===(h=e.data)||void 0===h?void 0:h.filter((e=>{var t;return 4===e.type||4!==(null===(t=e.item)||void 0===t?void 0:t.maskType)})));const z=(0,c.of)(this.user.getActions().multiSetUser(E),this.user.getActions().multiSetUserStats(C),this.itemList.getActions().setList({response:G,key:"search_top",abTestVersion:i,user:s,language:o}),this.liveList.getActions().setList({response:F,key:"search_top",abTestVersion:i,user:s,language:o}),this.getActions().addTopSearchResult(Object.assign(Object.assign({},e),{rid:A})),this.getActions().setSearchPrecheck({key:"general",value:x}),this.getActions().setIsGoToHashtag({key:"general",isGoToHashtag:p}),this.getActions().setSearchGlobalParams({preSearchId:A}));return(0,u.h)(z,m)})),this.catchError({isEmpty:Boolean(h.videoList.length||h.otherDataList.length),key:"general",keyword:d.keyword,state:l,teaParams:a,isSendSearch:0===_}),(0,m.Z)(this.getActions().setSearchLoading({key:"general",loading:!0}),this.getActions().setShowTabs(!0),this.getActions().setKeyword({key:"general",keyword:d.keyword})),(0,y.q)(this.getActions().setSearchLoading({key:"general",loading:!1}),this.terminate()),(0,b.Q)(this.getAction$().dispose))})))}getUserSearch(e){return e.pipe((0,h.E)(this.state$,this.bizContext.state$,this.personalization.state$,this.videoPlayerJotai.state$),(0,p.T)((([e,t,a,{isSearchPersonalized:i},s])=>({query:e,state:t.user,bizContextState:a,currentVideo:s.currentVideo,searchGlobalParams:t.searchGlobalParams,nonPersonalized:i?void 0:1}))),(0,v.n)((e=>{var t=e.query,{teaParams:a,abTestVersion:i,language:s,user:o}=t,n=(0,r.__rest)(t,["teaParams","abTestVersion","language","user"]),{state:d,state:{cursor:l,items:_,rid:h},searchGlobalParams:p,nonPersonalized:v,currentVideo:k}=e;let j=(0,c.of)({});n.keyword&&!(0,L.fU)()&&(j=this.service.getUserSearch(Object.assign(Object.assign({},n),{cursor:l,search_id:h,web_search_code:this.getWebSearchCode(i),is_non_personalized_search:v})));const P=Date.now();return j.pipe((0,S.M)((e=>{var t,i;const{user_list:s=[],log_pb:r,extra:o}=e,{impr_id:d}=null!=r?r:{},{logid:c}=null!=o?o:{},u=null!==(t=null!=h?h:c)&&void 0!==t?t:"";if(s.length){const e=_.length;s.forEach(((t,a)=>{var i;w.$G.handleSearchImpression({search_type:"user",enter_from:"search_result",rank:e+a,search_keyword:n.keyword,search_result_id:t.user_info.uid,impr_id:d,search_id:u});const s=null!==(i=t.user_info.room_id_str)&&void 0!==i?i:String(t.user_info.room_id);Boolean(Number(s))&&O.lu.handleLiveShow({room_id:s,anchor_id:t.user_info.uid,action_type:"click",enter_from_merge:"search_user",enter_method:"others_photo",search_type:"user",search_id:u,search_keyword:n.keyword,search_result_id:t.user_info.uid,rank:e+a,impr_id:d})}))}else w.$G.handleSearchResultEmpty({search_keyword:n.keyword,impr_id:d,search_id:u});0===l&&a&&w.$G.handleSearch(Object.assign(Object.assign({},a),{search_id:u,search_keyword:n.keyword,impr_id:d,duration:Date.now()-P,pre_search_id:p.preSearchId,group_id:null!==(i=null==k?void 0:k.id)&&void 0!==i?i:void 0}))})),(0,g.Z)((e=>{var t,a,i;const r=this.seoModule.setSearchSEOProps(e,{language:s},{pathname:f.OZ.searchUser,input_keyword:n.keyword}),{has_more:o,cursor:l,user_list:_=[],extra:p,search_nil_info:v,suicide_prevent:g,search_nil_text:m,log_pb:y}=e,b=null!==(t=null!=h?h:null==p?void 0:p.logid)&&void 0!==t?t:"",S=v&&[11,13].includes(null!==(a=v.text_type)&&void 0!==a?a:0);let k=null,w=null;if(S&&(w={type:null!==(i=null==v?void 0:v.text_type)&&void 0!==i?i:11,data:Object.assign(Object.assign({},g),{et_search_id:b})},k=(0,c.of)(this.getActions().setSearchPrecheck({key:"user",value:w}))),!_.length&&!o&&!S)return this.generateErrorState({res:e,search_nil_info:v,search_nil_text:m,suicide_prevent:g,state:d,key:"user",keyword:n.keyword,pathname:f.OZ.searchUser,action$s:[r]});if(_.length){const e=[],t=[],a=_.map((({user_info:a})=>{const{user:i,stats:s}=this.userConvertor(a,b,null==y?void 0:y.impr_id);return e.push(i),t.push(s),i.uniqueId})),i=(0,c.of)(this.user.getActions().multiSetUser(e),this.user.getActions().multiSetUserStats(t),this.getActions().addSearchResult({key:"user",result:{hasMore:Boolean(o),keyword:n.keyword,cursor:l,error:null,items:a,loading:!1,rid:b,preloadList:[]}}),this.getActions().setSearchGlobalParams({preSearchId:b}));return k?(0,u.h)(r,i,k):(0,u.h)(r,i)}return k?(0,u.h)(r,k):r})),this.catchError({isEmpty:Boolean(_.length),key:"user",keyword:n.keyword,state:d,teaParams:a,isSendSearch:0===l}),(0,m.Z)(this.getActions().setSearchLoading({key:"user",loading:!0}),this.getActions().setShowTabs(!0),this.getActions().setKeyword({key:"user",keyword:n.keyword})),(0,y.q)(this.getActions().setSearchLoading({key:"user",loading:!1}),this.terminate()),(0,b.Q)(this.getAction$().dispose))})))}getVideoSearch(e){return e.pipe((0,h.E)(this.state$,this.videoMask.state$,this.bizContext.state$,this.personalization.state$,this.videoPlayerJotai.state$),(0,p.T)((([e,t,a,i,{isSearchPersonalized:s},r])=>({query:e,state:t.video,searchGlobalParams:t.searchGlobalParams,videoMaskState:a,bizContextState:i,nonPersonalized:s?void 0:1,currentVideo:r.currentVideo}))),(0,v.n)((e=>{var t=e.query,{teaParams:a,abTestVersion:i,language:s,user:o,filterId:n}=t,d=(0,r.__rest)(t,["teaParams","abTestVersion","language","user","filterId"]),{state:l,state:{cursor:_,items:h,rid:p},videoMaskState:v,searchGlobalParams:k,currentVideo:O,nonPersonalized:j}=e;let P=(0,c.of)({});d.keyword&&!(0,L.fU)()&&(P=this.service.getVideoSearch(Object.assign(Object.assign({},d),{offset:_,count:20,search_id:p,web_search_code:this.getWebSearchCode(i),is_non_personalized_search:j})));const I=Date.now();return P.pipe((0,S.M)((e=>{var t,i;const{item_list:s=[],log_pb:r,extra:o}=e,n=null!==(t=null!=p?p:null==o?void 0:o.logid)&&void 0!==t?t:"";if(s.length){const e=h.length;s.forEach(((t,a)=>{var i;w.$G.handleSearchVideoImpression({search_type:"video",enter_from:"search_result",group_id:null==t?void 0:t.id,author_id:null===(i=null==t?void 0:t.author)||void 0===i?void 0:i.id,rank:e+a,search_keyword:d.keyword,impr_id:null==r?void 0:r.impr_id,search_id:n})}))}else w.$G.handleSearchResultEmpty({search_keyword:d.keyword,impr_id:null==r?void 0:r.impr_id,search_id:n});0===_&&a&&w.$G.handleSearch(Object.assign(Object.assign({},a),{search_id:n,search_keyword:d.keyword,impr_id:null==r?void 0:r.impr_id,duration:Date.now()-I,pre_search_id:k.preSearchId,group_id:null!==(i=null==O?void 0:O.id)&&void 0!==i?i:void 0}))})),(0,g.Z)((e=>{var t,a,r,_,h;const g=this.seoModule.setSearchSEOProps(e,{language:s},{pathname:f.OZ.searchVideo,input_keyword:d.keyword}),{has_more:m,cursor:y,item_list:b=[],extra:S,search_nil_info:k,suicide_prevent:w,search_nil_text:O,status_code:j,log_pb:L}=e,P=[0,203,403].includes(j)?0:j,I=k&&[11,13].includes(null!==(t=k.text_type)&&void 0!==t?t:0),M=null!==(a=null!=p?p:null==S?void 0:S.logid)&&void 0!==a?a:"";if(!b.length&&!m&&!I)return this.generateErrorState({search_nil_info:k,search_nil_text:O,suicide_prevent:w,state:l,key:"video",keyword:d.keyword,pathname:f.OZ.searchVideo,action$s:[g]});let A=[];const T=b.filter((e=>e.id!==n));A=1===(null==o?void 0:o.photoSensitiveVideosSetting)||!o&&1===v.photoSensitiveVideosSetting?T.filter((e=>4!==(null==e?void 0:e.maskType))).map((({id:e})=>e)):T.map((({id:e})=>e));const E=null!==(r=T.map((e=>{const{video:{id:t,playAddr:a=""}}=e;return{id:t,url:a}})))&&void 0!==r?r:[];let C=null;I&&(C={type:null!==(_=null==k?void 0:k.text_type)&&void 0!==_?_:11,data:Object.assign(Object.assign({},w),{et_search_id:null!==(h=null==S?void 0:S.logid)&&void 0!==h?h:""})});const G=(0,c.of)(this.itemList.getActions().setList({response:{itemList:T,hasMore:Boolean(m),statusCode:P,log_pb:L},key:"search_video",abTestVersion:i,language:s,user:o}),this.getActions().addSearchResult({key:"video",result:{hasMore:Boolean(m),keyword:d.keyword,cursor:null!=y?y:0,error:null,items:A,loading:!1,rid:null!=p?p:null==S?void 0:S.logid,preloadList:E}}),this.getActions().setSearchPrecheck({key:"video",value:C}),this.getActions().setSearchGlobalParams({preSearchId:M}));return(0,u.h)(G,g)})),this.catchError({isEmpty:Boolean(h.length),state:l,keyword:d.keyword,teaParams:a,key:"video",isSendSearch:0===_}),(0,m.Z)(this.getActions().setSearchLoading({key:"video",loading:!0}),this.getActions().setShowTabs(!0),this.getActions().setKeyword({key:"video",keyword:d.keyword})),(0,y.q)(this.getActions().setSearchLoading({key:"video",loading:!1}),this.terminate()),(0,b.Q)(this.getAction$().dispose))})))}getLiveSearch(e){return e.pipe((0,h.E)(this.state$,this.bizContext.state$,this.personalization.state$,this.videoPlayerJotai.state$),(0,p.T)((([e,t,a,{isSearchPersonalized:i},s])=>({query:e,state:t.live,searchGlobalParams:t.searchGlobalParams,bizContextState:a,nonPersonalized:i?void 0:1,currentVideo:s.currentVideo}))),(0,v.n)((e=>{var t=e.query,{teaParams:a,abTestVersion:i,language:s,user:o}=t,n=(0,r.__rest)(t,["teaParams","abTestVersion","language","user"]),{state:d,state:{cursor:l,items:_,rid:h},searchGlobalParams:v,currentVideo:k,nonPersonalized:O}=e;let j=(0,c.of)({});n.keyword&&!(0,L.fU)()&&(j=this.service.getLiveSearch(Object.assign(Object.assign({},n),{offset:l,count:20,search_id:h,web_search_code:this.getWebSearchCode(i),is_non_personalized_search:O})));const P=Date.now(),I=j.pipe((0,p.T)((e=>{var t;return Object.assign(Object.assign({},e),{data:null===(t=e.data)||void 0===t?void 0:t.map((e=>{var t,a;return JSON.parse(null!==(a=null===(t=e.live_info)||void 0===t?void 0:t.raw_data)&&void 0!==a?a:"{}")}))})})));return I.pipe((0,S.M)((e=>{var t,i;const{data:s=[],log_pb:r,extra:o}=e,d=null!==(t=null!=h?h:null==o?void 0:o.logid)&&void 0!==t?t:"";if(s.length){const e=_.length;s.forEach((({user_count:t=0,like_count:a=0,id_str:i},s)=>{const o=t<=50&&a>t;w.$G.handleSearchImpression({search_id:d,search_result_id:i,enter_from:"search_result",search_keyword:n.keyword,token_type:"live_card",is_aladdin:0,rank:e+s,result_source:"search",room_tag:"",like_number:o?a:"",realtime_watch_user:o?"":t,search_type:"live",impr_id:null==r?void 0:r.impr_id})}))}else w.$G.handleSearchResultEmpty({search_keyword:n.keyword,impr_id:null==r?void 0:r.impr_id,search_id:d});0===l&&a&&w.$G.handleSearch(Object.assign(Object.assign({},a),{search_id:d,search_keyword:n.keyword,impr_id:null==r?void 0:r.impr_id,duration:Date.now()-P,pre_search_id:v.preSearchId,group_id:null!==(i=null==k?void 0:k.id)&&void 0!==i?i:void 0}))})),(0,g.Z)((e=>{var t,a,r,l;const _=this.seoModule.setSearchSEOProps(e,{language:s},{pathname:f.OZ.searchLive,input_keyword:n.keyword}),{has_more:p,cursor:v,data:g=[],extra:m,search_nil_info:y,suicide_prevent:b,search_nil_text:S,status_code:k}=e,w=[0,203,403].includes(k)?0:k,O=y&&[11,13].includes(null!==(t=y.text_type)&&void 0!==t?t:0),j=null!==(a=null!=h?h:null==m?void 0:m.logid)&&void 0!==a?a:"";if(!g.length&&!p&&!O)return this.generateErrorState({search_nil_info:y,search_nil_text:S,suicide_prevent:b,state:d,key:"live",keyword:n.keyword,pathname:f.OZ.searchLive,action$s:[_]});let L=null;O&&(L={type:null!==(r=null==y?void 0:y.text_type)&&void 0!==r?r:11,data:Object.assign(Object.assign({},b),{et_search_id:null!==(l=null==m?void 0:m.logid)&&void 0!==l?l:""})});const P=(0,c.of)(this.liveList.getActions().setList({response:{liveList:g,hasMore:Boolean(p),statusCode:w},key:"search_live",abTestVersion:i,language:s,user:o}),this.getActions().addSearchResult({key:"live",result:{hasMore:Boolean(p),keyword:n.keyword,cursor:null!=v?v:0,error:null,items:g.map((e=>e.id_str)),loading:!1,rid:null!=h?h:null==m?void 0:m.logid}}),this.getActions().setSearchPrecheck({key:"live",value:L}),this.getActions().setSearchGlobalParams({preSearchId:j}));return(0,u.h)(P,_)})),this.catchError({isEmpty:Boolean(_.length),state:d,keyword:n.keyword,teaParams:a,key:"video",isSendSearch:0===l}),(0,m.Z)(this.getActions().setSearchLoading({key:"live",loading:!0}),this.getActions().setShowTabs(!0),this.getActions().setKeyword({key:"live",keyword:n.keyword})),(0,y.q)(this.getActions().setSearchLoading({key:"live",loading:!1}),this.terminate()),(0,b.Q)(this.getAction$().dispose))})))}handleTopSearchReport({state:{data:e,totalLength:t,rid:a},isSendSearch:i,teaParams:s,keyword:r,requestStart:o,searchGlobalParams:n,groupId:d}){return(0,S.M)((l=>{var c;const{data:u=[],log_pb:_,extra:h={}}=l,{logid:p}=h,v=null!==(c=null!=a?a:p)&&void 0!==c?c:"",{impr_id:g}=null!=_?_:{};if(u.length){const a=e.videoList.length,i={enter_from:"general_search",userStart:t-e.videoList.length,totalLength:t,keyword:r,impr_id:g,searchId:v,videoStart:a,count:0,userCount:0,videoCount:0},s={search_type:"general",search_id:v,search_keyword:r};u.forEach((e=>{var t,a;null===(a=H[null!==(t=null==e?void 0:e.type)&&void 0!==t?t:""])||void 0===a||a.call(H,e,i,s)}))}else w.$G.handleSearchResultEmpty({search_keyword:r,impr_id:g,search_id:v});i&&s&&w.$G.handleSearch(Object.assign(Object.assign({},s),{search_id:v,search_keyword:r,impr_id:g,duration:Date.now()-o,pre_search_id:n.preSearchId,group_id:null!=d?d:void 0}))}))}catchError({isEmpty:e,teaParams:t,keyword:a,key:i,state:s,isSendSearch:r}){return(0,k.W)((()=>e?(j.F.open({content:this.t("server_error_title"),duration:3,widthType:"half"}),(0,c.of)(this.noop())):(r&&t&&w.$G.handleSearch(Object.assign(Object.assign({},t),{search_id:"",search_keyword:a})),(0,c.of)(this.getActions().setSearchResult({key:i,result:Object.assign(Object.assign({},s),{keyword:a,error:{type:-1}})})))))}generateErrorState(e){const{search_nil_info:t,search_nil_text:a,state:i,key:s,keyword:r,actions:o=[],action$s:n=[]}=e,{text_type:d}=null!=t?t:{text_type:10},l={type:d||10};12===d&&(l.extra=a);const _=(0,c.of)(this.getActions().setSearchResult({key:s,result:Object.assign(Object.assign({},i),{keyword:r,error:l})}),...o);return(0,u.h)(_,...n)}userConvertor(e,t,a){var i;return{user:(0,I.bg)(e,{search_id:t,impr_id:a}),stats:{uniqueId:null!==(i=e.unique_id)&&void 0!==i?i:"",stats:(0,M.sg)(e,!0)}}}getWebSearchCode(e){var t,a;const{parameters:i={}}=null!=e?e:{},{search_add_live:s,search_server:r}=i,o={tiktok:{client_params_x:{search_engine:{}},search_server:{}}};return"v2"===(null==s?void 0:s.vid)&&(o.tiktok.client_params_x.search_engine.ies_mt_user_live_video_card_use_libra=1,o.tiktok.client_params_x.search_engine.mt_search_general_user_live_card=1),Object.keys(null!==(t=null==r?void 0:r.vid)&&void 0!==t?t:{}).length>0&&(o.tiktok.search_server=null!==(a=null==r?void 0:r.vid)&&void 0!==a?a:{}),JSON.stringify(o)}};(0,r.__decorate)([(0,n.uk)(),(0,r.__metadata)("design:type",_.c)],U.prototype,"dispose",void 0),(0,r.__decorate)([(0,n.h5)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object,Object]),(0,r.__metadata)("design:returntype",void 0)],U.prototype,"setSearchResult",null),(0,r.__decorate)([(0,n.h5)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object,Object]),(0,r.__metadata)("design:returntype",void 0)],U.prototype,"setSearchReminderData",null),(0,r.__decorate)([(0,n.h5)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object,Object]),(0,r.__metadata)("design:returntype",void 0)],U.prototype,"addSearchResult",null),(0,r.__decorate)([(0,n.h5)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object,Object]),(0,r.__metadata)("design:returntype",void 0)],U.prototype,"addTopSearchResult",null),(0,r.__decorate)([(0,n.h5)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object,Object]),(0,r.__metadata)("design:returntype",void 0)],U.prototype,"setSearchLoading",null),(0,r.__decorate)([(0,n.h5)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object,Object]),(0,r.__metadata)("design:returntype",void 0)],U.prototype,"setIsGoToHashtag",null),(0,r.__decorate)([(0,n.h5)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object,Boolean]),(0,r.__metadata)("design:returntype",void 0)],U.prototype,"setShowTabs",null),(0,r.__decorate)([(0,n.h5)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object,Object]),(0,r.__metadata)("design:returntype",void 0)],U.prototype,"setSearchGlobalParams",null),(0,r.__decorate)([(0,n.h5)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object,Object]),(0,r.__metadata)("design:returntype",void 0)],U.prototype,"setSearchPrecheck",null),(0,r.__decorate)([(0,n.h5)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object,Object]),(0,r.__metadata)("design:returntype",void 0)],U.prototype,"setKeyword",null),(0,r.__decorate)([(0,n.h5)(),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[Object]),(0,r.__metadata)("design:returntype",void 0)],U.prototype,"resetSearchResult",null),(0,r.__decorate)([(0,n.Mj)({payloadGetter:1,skipFirstClientDispatch:!1}),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[_.c]),(0,r.__metadata)("design:returntype",void 0)],U.prototype,"getTopSearch",null),(0,r.__decorate)([(0,n.Mj)({payloadGetter:1,skipFirstClientDispatch:!1}),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[_.c]),(0,r.__metadata)("design:returntype",void 0)],U.prototype,"getUserSearch",null),(0,r.__decorate)([(0,n.Mj)({payloadGetter:1,skipFirstClientDispatch:!1}),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[_.c]),(0,r.__metadata)("design:returntype",void 0)],U.prototype,"getVideoSearch",null),(0,r.__decorate)([(0,n.Mj)({payloadGetter:1,skipFirstClientDispatch:!1}),(0,r.__metadata)("design:type",Function),(0,r.__metadata)("design:paramtypes",[_.c]),(0,r.__metadata)("design:returntype",void 0)],U.prototype,"getLiveSearch",null),U=(0,r.__decorate)([(0,d.n)("Search"),(0,r.__param)(9,(0,l.y)(P.hp)),(0,r.__metadata)("design:paramtypes",[z.S,C.U,E.E,F.O,T.F,G.w,A.$,$.Q,x.fu,Function])],U)},30264:(e,t,a)=>{a.d(t,{S:()=>o});var i=a(58632),s=a(7672),r=a(55099);let o=class{constructor(e){this.fetch=e}getTopSearch(e){return this.fetch.get("/api/search/general/full/",{query:e,baseUrlType:2})}getUserSearch(e){return this.fetch.get("/api/search/user/full/",{query:e,baseUrlType:2})}getVideoSearch(e){return this.fetch.get("/api/search/item/full/",{query:e,baseUrlType:2})}getLiveSearch(e){return this.fetch.get("/api/search/live/full/",{query:e,baseUrlType:2})}};o=(0,i.__decorate)([(0,s._)(),(0,i.__metadata)("design:paramtypes",[r.p])],o)},22884:(e,t,a)=>{a.d(t,{Gr:()=>v,Jq:()=>c,f7:()=>p,pF:()=>l});var i=a(58632),s=a(71111),r=a(31209),o=a(42257),n=a(84908),d=a(58305);const l="l_s_platform",c="l_s_user",u={platformId:o.Ag.copy,user:{id:"",uniqueId:"",nickname:"",avatarThumb:"",avatarMedium:"",avatarLarger:"",signature:"",relation:-1}},_=()=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const e=Object.assign({},u);if("undefined"==typeof window||"undefined"==typeof document)return e;try{if(e.platformId=(0,d._S)(l,o.Ag.copy),e.user.id=(0,d._S)(c,""),e.user.id&&!e.user.avatarThumb){const t=yield function(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){try{const t=yield(0,n.Gp)().getUserDetail({userId:e});return 0===t.statusCode&&t.userInfo?t.userInfo.user:(console.warn(`Warn: Unable to get last shared friend info for user ${e}`,t),null)}catch(e){return console.error("Error fetching user details:",e),null}}))}(e.user.id);if(!t)return console.error("Unable to get last shared friend info, default to copy method!"),e.platformId=o.Ag.copy,e;e.user=Object.assign({},t)}}catch(t){return console.error("getDefaultState() failed for getting shared info..."),e}return e})),h=(0,s.atom)(u);h.debugLabel="lastSharedAtom";const{useServiceDispatchers:p,useServiceState:v}=(0,r.i)(h,((e,t)=>({initLastSharedAtom:()=>(0,i.__awaiter)(void 0,void 0,void 0,(function*(){const{platformId:a,user:i}=e(h);if(a&&i.id&&i.avatarThumb)return;const s=yield _();t(h,(e=>Object.assign(Object.assign({},e),s)))})),updateLastSharedInfo:e=>{var a,i;t(h,(t=>Object.assign(Object.assign({},t),{platformId:(null==e?void 0:e.platformId)||o.Ag.copy,user:(null==e?void 0:e.user)||t.user}))),(0,d.AP)(l,e.platformId),e.user&&(0,d.AP)(c,null!==(i=null===(a=e.user)||void 0===a?void 0:a.id)&&void 0!==i?i:"")}})))},42713:(e,t,a)=>{a.d(t,{lu:()=>l});var i,s,r,o,n,d=a(93608);!function(e){e.LiveShow="livesdk_live_show",e.LiveRecPlay="livesdk_rec_live_play",e.LiveWindowDuration="livesdk_live_window_duration_v2"}(i||(i={})),function(e){e.Click="click",e.Draw="draw"}(s||(s={})),function(e){e.General="general_search",e.SearchResult="search_result",e.SearchUser="search_user"}(r||(r={})),function(e){e.OthersPhoto="others_photo",e.Cover="live_cover",e.Cell="live_cell"}(o||(o={})),function(e){e.AutoMatic="automatic",e.Hover="hover"}(n||(n={}));const l={handleLiveShow:e=>{d.f.event("livesdk_live_show",e)},handleLiveRecPlay:e=>{d.f.event("livesdk_rec_live_play",Object.assign({action_type:"click"},e))},handleLiveWindowDuration:e=>{d.f.event("livesdk_live_window_duration_v2",e)}}}}]);