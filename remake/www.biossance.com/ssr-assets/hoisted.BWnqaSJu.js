import{r as a,s as c,a as u,b as g}from"./recaptcha.CWNNhFz_.js";import{u as m}from"./index.hy_87apP.js";import"./hoisted.DUolJQwy.js";import"./hoisted.DbN_s2PI.js";import"./hoisted.CrbnF-IH.js";import"./GlobalDispatchAndDateCountdownWidget.astro_astro_type_script_index_0_lang.DQWCLhkB.js";import"./basketPage.BPoE1kg2.js";import"./accordionItem.CWhAfE-2.js";import"./provenance.BZIpCnq5.js";const w=document.getElementById("newsletter-signup-form"),i=document.getElementById("email-newsletter"),o=document.getElementById("newsletter-content"),l=window?.tenantConfig?.application?.features?.recaptcha?.enabled;let r;l&&a.get()!=="newsletter-signup-page"&&c("newsletter-signup-page");u.subscribe(t=>{if(!t||a.get()!=="newsletter-signup-page")return;d({"X-Captcha-Type":"V2_INVISIBLE","X-Captcha-Response":t}),grecaptcha.reset(r[0]["newsletter-signup-page"])});function h(t){t.preventDefault(),l?(a.get()!=="newsletter-signup-page"&&c("newsletter-signup-page"),r=g.get().filter(n=>n["newsletter-signup-page"]||n["newsletter-signup-page"]===0),grecaptcha.execute(r[0]["newsletter-signup-page"])):d()}async function d(t={}){if(!i.value)return;const n=i.value;document.getElementById("email-signup-error").classList.add("hidden");try{const s=await m({operation:"NewsletterSignup",variables:{email:n,auditData:{messageShown:lang.altitude.newsletter.page.content.title,formIdentifier:"newsletter-signup-page",formLocation:window?.location.href}},customHeaders:t});if(s?.data?.signUpForMarketing||s?.data?.signUpForMarketing===null)if(s?.data?.signUpForMarketing==="OK"){window?.Tracker?.handlers?.newsletterSignup({status:"success",location:window?.location.href}),o?.classList.add("hidden");const e=document.getElementById("newsletter-content-success");e?.classList.remove("hidden"),e.querySelector("#newsletter-success-btn")?.classList.remove("hidden")}else{window?.Tracker?.handlers?.newsletterSignup({status:"duplicate",location:window?.location.href}),o?.classList.add("hidden");const e=document.getElementById("newsletter-content-duplicate");e?.classList.remove("hidden"),e.querySelector("#newsletter-duplicate-btn")?.classList.remove("hidden")}else window?.Tracker?.handlers?.newsletterSignup({status:"api error",location:window?.location.href}),document.getElementById("email-signup-error")?.classList.remove("hidden")}catch(s){console.error(s.message),window?.Tracker?.handlers?.newsletterSignup({status:"storefront error",location:window?.location.href}),document.getElementById("email-signup-error")?.classList.remove("hidden")}}w?.addEventListener("submit",h);
