import{a as xe,i as Ue}from"./gtmReviews.O_m179wD.js";import{i as He,t as Ge,s as Be,a as p,c as Ke,d as Ye}from"./basketPage.BPoE1kg2.js";import{f as Ze,m as f,u as F}from"./index.hy_87apP.js";import"./hoisted.DUolJQwy.js";import"./hoisted.DbN_s2PI.js";import"./hoisted.BwZwhcIp.js";import"./hoisted.CsRQBF6t.js";import"./hoisted.BJI5i2zr.js";import"./hoisted.DCj1FfRW.js";import"./hoisted.BvVr0gRp.js";import"./hoisted.D8xmIKpv.js";import"./hoisted.BGTma8by.js";import"./EmailWhenInStockModal.astro_astro_type_script_index_0_lang.Df0b5M6J.js";import"./VideoTranscriptModal.astro_astro_type_script_index_0_lang.DaW57Rr-.js";import"./hoisted.CrbnF-IH.js";import{m as De,d as Je}from"./recaptcha.CWNNhFz_.js";import"./GlobalDispatchAndDateCountdownWidget.astro_astro_type_script_index_0_lang.DQWCLhkB.js";import"./accordionItem.CWhAfE-2.js";import"./provenance.BZIpCnq5.js";xe();Ue();window?.tenantConfig?.application?.features?.notifyWhenInStock?.enabled&&He();const le=document.getElementById("global-andromeda-wrapper");le&&Ze("/fragments/pdpBlogs",le,null,!1,"GET");!window.__STYLE_SUGGESTIONS__&&tenantConfig?.application?.features?.styleSuggestions&&window?.Tracker?.handlers?.showOutfitSuggestions({success:!1,sku:window?.Tracker?.store?.productVisit?.sku});class je extends HTMLElement{styleSuggestionsFetcherButtonElement=document.getElementById("style-suggestions-fetcher");styleSuggestions=window.__STYLE_SUGGESTIONS__;styleSuggestionsWidget=document.getElementsByTagName("style-suggestions");constructor(){super(),this.handleScrollIntoView=this.handleScrollIntoView.bind(this),this.styleSuggestionsFetcherButtonElement?.addEventListener("click",()=>{if(this.styleSuggestionsWidget.length){this.handleScrollIntoView();return}const t=fetch("/fragments/styleSuggestionsWidgetFragment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({styleSuggestions:this.styleSuggestions,sku:window.Tracker.store.productVisit.sku})}).then(o=>o.text()).catch(o=>o);Promise.resolve(t).then(o=>{this.innerHTML=o,this.handleScrollIntoView()}).catch(o=>o)})}handleScrollIntoView(){this.scrollIntoView({behavior:"smooth"})}}customElements.define("style-suggestions-wrapper",je);function Ce(e){class t extends HTMLElement{constructor(){super(),this.brandsDropdownSelector=e?this.querySelector("#concealer-finder-brands-dropdown-selector"):this.querySelector("#foundation-finder-brands-dropdown-selector"),this.concealerFinderConcealerOption=document.getElementById("concealer-finder-concealer-option"),this.selectBrand=e?document.getElementById("concealer-finder-brands-dropdown-selector"):document.getElementById("foundation-finder-brands-dropdown-selector"),this.selectProduct=e?document.getElementById("concealer-finder-products-dropdown-selector"):document.getElementById("foundation-finder-products-dropdown-selector"),this.selectShade=e?document.getElementById("concealer-finder-shades-dropdown-selector"):document.getElementById("foundation-finder-shades-dropdown-selector"),this.concealerFinderFoundationOption=document.getElementById("concealer-finder-foundation-option"),this.productsDropdownSelector=this.querySelector((e?"#concealer-":"#foundation-")+"finder-products-dropdown-selector"),this.shadesDropdownSelector=this.querySelector((e?"#concealer-":"#foundation-")+"finder-shades-dropdown-selector"),this.brandsDropdownOptionsFoundations=this.querySelector((e?"#concealer-":"#foundation-")+"finder-brands-elements-foundations"),this.brandsDropdownOptionsFoundations=document.getElementById((e?"concealer-":"foundation-")+"finder-brands-elements-foundations"),this.brandsDropdownOptionsConcealers=this.querySelector("#concealer-finder-brands-elements-concealers"),this.productsDropdownOptionsFoundations=this.querySelectorAll((e?".concealer-":".foundation-")+"finder-products-elements-foundations"),this.productDropdownOptionsConcealers=this.querySelectorAll(".concealer-finder-products-elements-concealers"),this.shadesDropdownOptionsFoundations=this.querySelectorAll((e?".concealer-":".foundation-")+"finder-shades-elements-foundations"),this.shadesDropdownOptionsConcealers=this.querySelectorAll(".concealer-finder-shades-elements-concealers"),this.brandOptions=this.querySelectorAll(".brand-option"),this.productOptions=this.querySelectorAll(".product-option"),this.shadeOptions=this.querySelectorAll(".shade-option"),this.selectedBrandOption=this.querySelector((e?"#concealer-":"#foundation-")+"finder-brands-dropdown-selector-default"),this.selectedProductOption=this.querySelector((e?"#concealer-":"#foundation-")+"finder-products-dropdown-selector-default"),this.selectedShadeOption=this.querySelector((e?"#concealer-":"#foundation-")+"finder-shades-dropdown-selector-default"),this.concealerCascadingDropdownsContainer=document.getElementById("concealer-cascading-dropdowns-container"),this.handleConcealerFinderConcealerOption=this.handleConcealerFinderConcealerOption.bind(this),this.handleConcealerFinderFoundationOption=this.handleConcealerFinderFoundationOption.bind(this),this.handleBrandDropdownAction=this.handleBrandDropdownAction.bind(this),this.handleProductDropdownAction=this.handleProductDropdownAction.bind(this),this.handleShadeDropdownAction=this.handleShadeDropdownAction.bind(this),this.handleWindowCloseBrandDropdown=this.handleWindowCloseBrandDropdown.bind(this),this.handleWindowCloseProductDropdown=this.handleWindowCloseProductDropdown.bind(this),this.handleWindowCloseShadeDropdown=this.handleWindowCloseShadeDropdown.bind(this),this.closeShadeDropdowns=this.closeShadeDropdowns.bind(this),this.closeProductDropdowns=this.closeProductDropdowns.bind(this),this.handleChooseBrandOption=this.handleChooseBrandOption.bind(this),this.handleChooseProductOption=this.handleChooseProductOption.bind(this),this.handleChooseShadeOption=this.handleChooseShadeOption.bind(this),this.concealerFinderConcealerOption?.addEventListener("click",this.handleConcealerFinderConcealerOption),this.concealerFinderFoundationOption?.addEventListener("click",this.handleConcealerFinderFoundationOption),this.brandsDropdownSelector?.addEventListener("click",this.handleBrandDropdownAction),this.productsDropdownSelector?.addEventListener("click",this.handleProductDropdownAction),this.shadesDropdownSelector?.addEventListener("click",this.handleShadeDropdownAction),this.brandOptions?.forEach(n=>{n.addEventListener("click",this.handleChooseBrandOption)}),this.productOptions?.forEach(n=>{n.addEventListener("click",this.handleChooseProductOption)}),this.shadeOptions?.forEach(n=>{n.addEventListener("click",this.handleChooseShadeOption)}),this.selectedBrand=null,this.selectedProduct=null,this.selectedShade=null,this.productType=null,this.selectedFoundationId=null,this.resetSelection=this.resetSelection.bind(this),e?window.resetConcealerSelection=this.resetSelection:window.resetFoundationSelection=this.resetSelection}handleBrandDropdownAction(){this.closeProductDropdowns(),this.closeShadeDropdowns(),this.productType==="concealer"?this.brandsDropdownOptionsConcealers.classList.contains("block")?(this.brandsDropdownSelector.querySelector("svg").classList.remove("rotate-180"),this.brandsDropdownOptionsConcealers.classList.replace("block","hidden"),window.removeEventListener("click",this.handleWindowCloseBrandDropdown)):(window.addEventListener("click",this.handleWindowCloseBrandDropdown),this.brandsDropdownSelector.querySelector("svg").classList.add("rotate-180"),this.brandsDropdownOptionsConcealers.classList.replace("hidden","block")):this.brandsDropdownOptionsFoundations.classList.contains("block")?(this.brandsDropdownSelector.querySelector("svg").classList.remove("rotate-180"),this.brandsDropdownOptionsConcealers.classList.replace("block","hidden"),window.removeEventListener("click",this.handleWindowCloseBrandDropdown)):(window.addEventListener("click",this.handleWindowCloseBrandDropdown),this.brandsDropdownSelector.querySelector("svg").classList.add("rotate-180"),this.brandsDropdownOptionsFoundations.classList.replace("hidden","block"))}handleWindowCloseBrandDropdown(n){this.productType==="concealer"?(!n||!this.contains(n.target))&&(this.brandsDropdownSelector.querySelector("svg").classList.remove("rotate-180"),this.brandsDropdownOptionsConcealers.classList.replace("block","hidden"),window.removeEventListener("click",this.handleWindowCloseBrandDropdown)):(!n||!this.contains(n.target))&&(this.brandsDropdownSelector.querySelector("svg").classList.remove("rotate-180"),this.brandsDropdownOptionsFoundations.classList.replace("block","hidden"),window.removeEventListener("click",this.handleWindowCloseBrandDropdown))}handleChooseBrandOption(n){const s=n.currentTarget,i=s.querySelector("p").textContent;this.selectedBrandOption.textContent=i,this.brandOptions.forEach(r=>{r.classList.remove("active-brand-option"),r.querySelector("svg").classList.add("hidden")}),s.classList.add("active-brand-option"),s.querySelector("svg").classList.remove("hidden"),this.selectedBrand=i,this.brandsDropdownSelector.querySelector("svg").classList.remove("rotate-180"),this.productType==="concealer"?this.brandsDropdownOptionsConcealers.classList.replace("block","hidden"):this.brandsDropdownOptionsFoundations.classList.replace("block","hidden"),this.productsDropdownSelector.disabled=!1,this.shadesDropdownSelector.disabled=!0,this.selectedProductOption.textContent=this.selectProduct?.innerText,this.selectedShadeOption.textContent=this.selectShade?.innerText,this.selectedProduct=null,this.selectedShade=null,e?(this.selectedFoundationId=null,this.dispatchEvent(new CustomEvent("concealerIncompleteSelection",{bubbles:!0}))):(this.selectedFoundationId=null,this.dispatchEvent(new CustomEvent("incompleteSelection",{bubbles:!0}))),window.removeEventListener("click",this.handleWindowCloseBrandDropdown)}handleConcealerFinderConcealerOption(){this.concealerFinderConcealerOption.classList.replace("font-normal","font-semibold"),this.concealerFinderFoundationOption.classList.replace("font-semibold","font-normal"),this.concealerFinderConcealerOption.classList.replace("no-underline","underline"),this.concealerFinderFoundationOption.classList.replace("underline","no-underline"),this.concealerFinderConcealerOption.classList.replace("bg-[#FFFFFF]","bg-[#8B6A5B]"),this.concealerFinderFoundationOption.classList.replace("bg-[#8B6A5B]","bg-[#FFFFFF]"),this.handleWindowCloseBrandDropdown(),this.closeProductDropdowns(),this.closeShadeDropdowns(),this.resetSelection(),this.handle,this.brandsDropdownSelector.disabled=!1,this.productsDropdownSelector.disabled=!0,this.shadesDropdownSelector.disabled=!0,this.productType="concealer"}handleConcealerFinderFoundationOption(){this.concealerFinderFoundationOption.classList.replace("font-normal","font-semibold"),this.concealerFinderConcealerOption.classList.replace("font-semibold","font-normal"),this.concealerFinderFoundationOption.classList.replace("no-underline","underline"),this.concealerFinderConcealerOption.classList.replace("underline","no-underline"),this.concealerFinderFoundationOption.classList.replace("bg-[#FFFFFF]","bg-[#8B6A5B]"),this.concealerFinderConcealerOption.classList.replace("bg-[#8B6A5B]","bg-[#FFFFFF]"),this.handleWindowCloseBrandDropdown(),this.closeProductDropdowns(),this.closeShadeDropdowns(),this.resetSelection(),this.brandsDropdownSelector.disabled=!1,this.productsDropdownSelector.disabled=!0,this.shadesDropdownSelector.disabled=!0,this.productType="foundation"}handleProductDropdownAction(){this.closeShadeDropdowns();let n;this.productType==="concealer"?n=Array.from(this.productDropdownOptionsConcealers).find(s=>s.dataset.foundationBrand===this.selectedBrand):n=Array.from(this.productsDropdownOptionsFoundations).find(s=>s.dataset.foundationBrand===this.selectedBrand),n&&(n?.classList.contains("block")?(this.productsDropdownSelector.querySelector("svg").classList.remove("rotate-180"),n?.classList.replace("block","hidden"),window.removeEventListener("click",this.handleWindowCloseProductDropdown)):(window.addEventListener("click",this.handleWindowCloseProductDropdown),this.productsDropdownSelector.querySelector("svg").classList.add("rotate-180"),n.classList.replace("hidden","block")))}handleWindowCloseProductDropdown(n){let s;this.productType==="concealer"?s=Array.from(this.productDropdownOptionsConcealers).find(i=>i.dataset.foundationBrand===this.selectedBrand):s=Array.from(this.productsDropdownOptionsFoundations).find(i=>i.dataset.foundationBrand===this.selectedBrand),this.contains(n.target)||(this.productsDropdownSelector.querySelector("svg").classList.remove("rotate-180"),s.classList.replace("block","hidden"),window.removeEventListener("click",this.handleWindowCloseProductDropdown))}handleChooseProductOption(n){const s=n.currentTarget,i=s.querySelector("p").textContent;this.selectedProductOption.textContent=i;let r;this.productType==="concealer"?r=Array.from(this.productDropdownOptionsConcealers).find(d=>d.dataset.foundationBrand===this.selectedBrand):r=Array.from(this.productsDropdownOptionsFoundations).find(d=>d.dataset.foundationBrand===this.selectedBrand),this.productOptions.forEach(d=>{d.classList.remove("active-brand-option"),d.querySelector("svg").classList.add("hidden")}),s.classList.add("active-brand-option"),s.querySelector("svg").classList.remove("hidden"),this.selectedProduct=i,this.productsDropdownSelector.querySelector("svg").classList.remove("rotate-180"),r.classList.replace("block","hidden"),this.shadesDropdownSelector.disabled=!1,this.selectedShadeOption.textContent=this.selectShade?.innerText,this.selectedShade=null,e?(this.selectedFoundationId=null,this.dispatchEvent(new CustomEvent("concealerIncompleteSelection",{bubbles:!0}))):(this.selectedFoundationId=null,this.dispatchEvent(new CustomEvent("incompleteSelection",{bubbles:!0}))),window.removeEventListener("click",this.handleWindowCloseProductDropdown)}handleShadeDropdownAction(){let n;this.productType==="concealer"?n=Array.from(this.shadesDropdownOptionsConcealers).find(s=>s.dataset.foundationProduct===this.selectedProduct):n=Array.from(this.shadesDropdownOptionsFoundations).find(s=>s.dataset.foundationProduct===this.selectedProduct),n&&(n?.classList.contains("block")?(this.shadesDropdownSelector.querySelector("svg").classList.remove("rotate-180"),n?.classList.replace("block","hidden"),window.removeEventListener("click",this.handleWindowCloseShadeDropdown)):(window.addEventListener("click",this.handleWindowCloseShadeDropdown),this.shadesDropdownSelector.querySelector("svg").classList.add("rotate-180"),n.classList.replace("hidden","block")))}handleWindowCloseShadeDropdown(n){let s;this.productType==="concealer"?s=Array.from(this.shadesDropdownOptionsConcealers).find(i=>i.dataset.foundationProduct===this.selectedProduct):s=Array.from(this.shadesDropdownOptionsFoundations).find(i=>i.dataset.foundationProduct===this.selectedProduct),this.contains(n.target)||(this.shadesDropdownSelector.querySelector("svg").classList.remove("rotate-180"),s.classList.replace("block","hidden"),window.removeEventListener("click",this.handleWindowCloseShadeDropdown))}handleChooseShadeOption(n){const s=n.currentTarget,i=s.querySelector("p").textContent,r=this.productType==="concealer"?s.dataset.concealerFinderShadeId:s.dataset.foundationFinderShadeId;e?this.selectedFoundationId=r:this.selectedFoundationId=r,this.selectedShadeOption.textContent=i;let d;this.productType==="concealer"?d=Array.from(this.shadesDropdownOptionsConcealers).find(c=>c.dataset.foundationProduct===this.selectedProduct):d=Array.from(this.shadesDropdownOptionsFoundations).find(c=>c.dataset.foundationProduct===this.selectedProduct),this.shadeOptions.forEach(c=>{c.classList.remove("active-brand-option"),c.querySelector("svg").classList.add("hidden")}),s.classList.add("active-brand-option"),s.querySelector("svg").classList.remove("hidden"),this.selectedShade=i,this.shadesDropdownSelector.querySelector("svg").classList.remove("rotate-180"),d.classList.replace("block","hidden"),e?this.dispatchEvent(new CustomEvent("concealerShadeSelected",{detail:{brand:this.selectedBrand,product:this.selectedProduct,shade:this.selectedShade,foundationId:this.selectedFoundationId,productType:this.productType},bubbles:!0})):this.dispatchEvent(new CustomEvent("shadeSelected",{detail:{brand:this.selectedBrand,product:this.selectedProduct,shade:this.selectedShade,foundationId:this.selectedFoundationId},bubbles:!0})),window.removeEventListener("click",this.handleWindowCloseShadeDropdown)}closeProductDropdowns(){let n;this.productType==="concealer"?n=Array.from(this.productDropdownOptionsConcealers).find(s=>s.classList.contains("block")):n=Array.from(this.productsDropdownOptionsFoundations).find(s=>s.classList.contains("block")),n&&(this.productsDropdownSelector.querySelector("svg").classList.remove("rotate-180"),n?.classList.replace("block","hidden"))}closeShadeDropdowns(){let n;this.productType==="concealer"?n=Array.from(this.shadesDropdownOptionsConcealers).find(s=>s.classList.contains("block")):n=Array.from(this.shadesDropdownOptionsFoundations).find(s=>s.classList.contains("block")),n&&(this.shadesDropdownSelector.querySelector("svg").classList.remove("rotate-180"),n?.classList.replace("block","hidden"))}resetSelection(){this.brandOptions.forEach(n=>{n.classList.remove("active-brand-option"),n.querySelector("svg").classList.add("hidden")}),this.productOptions.forEach(n=>{n.classList.remove("active-brand-option"),n.querySelector("svg").classList.add("hidden")}),this.shadeOptions.forEach(n=>{n.classList.remove("active-brand-option"),n.querySelector("svg").classList.add("hidden")}),this.productsDropdownSelector.disabled=!0,this.shadesDropdownSelector.disabled=!0,this.selectedBrandOption.textContent=this.selectBrand?.innerText,this.selectedProductOption.textContent=this.selectProduct?.innerText,this.selectedShadeOption.textContent=this.selectShade?.innerText,this.selectedBrand=null,this.selectedProduct=null,this.selectedShade=null,e?(this.selectedFoundationId=null,this.dispatchEvent(new CustomEvent("concealerIncompleteSelection",{bubbles:!0}))):(this.selectedFoundationId=null,this.dispatchEvent(new CustomEvent("incompleteSelection",{bubbles:!0})))}}customElements.get("cascading-dropdowns")||customElements.define("cascading-dropdowns",t)}function ze(){const e=document.getElementById("product-image-zoom"),t=document.getElementById("product-zoom-modal");e?.addEventListener("click",()=>{t?.classList.add("modal"),t?.showModal()})}ze();function Xe(){const e=document.getElementById("open-transcript-button"),t=document.getElementById("open-transcript");e?.addEventListener("click",()=>{t?.classList.add("modal"),f("open-transcript","false",!0,"false"),t?.showModal()})}Xe();window?.tenantConfig?.application?.features?.hasQuickBuy&&document.querySelectorAll(".quick-buy").forEach(t=>{t.addEventListener("click",()=>{const n=t.closest("product-card-wrapper")?.dataset?.quicklook;n&&Ge(n,t,!1)})});const Qe=document.getElementById("concealer-finder"),ue=document.getElementById("concealer-finder-modal"),et=document.getElementById("concealer-cascading-dropdowns-container"),he=document.getElementById("concealer-selection-view"),pe=document.getElementById("concealer-confirmation-view");Qe?.addEventListener("click",async()=>{window.sharedFunctions.fetchFragment("/fragments/finderSelectionFragment",et,{type:"concealerFinder"},!1,"GET").then(()=>{f("concealer-finder-modal","false"),ue?.setAttribute("aria-hidden","false"),ue.showModal(),window?.Tracker?.handlers?.foundationFinderToolOpen(window?.__product_id__),Ce(!0),window.resetConcealerSelection(),tt()})});function tt(){pe?.classList.remove("block"),pe?.classList.add("hidden"),he?.classList.remove("hidden"),he?.classList.add("block")}const nt=document.getElementById("foundation-finder"),me=document.getElementById("foundation-finder-modal"),ot=document.getElementById("cascading-dropdowns-container"),we=document.getElementById("selection-view"),fe=document.getElementById("confirmation-view");nt?.addEventListener("click",async()=>{window.sharedFunctions.fetchFragment("/fragments/finderSelectionFragment",ot,{type:"foundationFinder"},!1,"GET").then(()=>{f("foundation-finder-modal","false"),me?.setAttribute("aria-hidden","false"),me.showModal(),window?.Tracker?.handlers?.foundationFinderToolOpen(window?.__product_id__),Ce(),window.resetFoundationSelection(),st()})});function st(){fe?.classList.remove("block"),fe?.classList.add("hidden"),we?.classList.remove("hidden"),we?.classList.add("block")}const L=document.getElementById("pap-banner"),ve=document.getElementById("pap-modal");L?.addEventListener("click",async()=>{f("pap-modal","false"),ve?.setAttribute("aria-hidden","false"),ve.showModal(),window.Tracker.handlers.promoClick({promotion:L.innerText});const e=document.getElementById("pap-title"),t=document.getElementById("pap-description"),o=document.getElementById("pap-link"),n=document.getElementById("pap-product-title"),s=document.getElementById("pap-product-image");e.innerHTML=L?.innerHTML,t.innerHTML=L?.dataset?.description,o.innerHTML=L?.dataset?.text,o.href=L?.dataset?.link,o.dataset.trackPush=L?.innerHTML;const i=L?.dataset?.papimagetitle,r=L?.dataset?.papimage;n&&(n.innerHTML=i||""),s&&(s.innerHTML=r?`<img src="${r}" alt="${i}" class="w-full h-auto" />`:"")});const U=[...document.querySelectorAll(".product-images")],it=document.querySelector(".carouselWrapper"),Se=[];U.length>4&&rt();function rt(){const e=new IntersectionObserver(t=>{t.forEach(o=>{const{target:n}=o;if(U.findIndex(s=>s.isSameNode(n)),o.isIntersecting){const s=U.findIndex(i=>i.isSameNode(n));if(s>4&&!Se.includes(s)){const i=o.target,r=document.createElement("img");r.src=i.getAttribute("data-image");const d=i.getAttribute("data-altText");r.setAttribute("role","presentation"),r.setAttribute("aria-hidden","true"),r.setAttribute("alt",d),i.append(r),Se.push(s)}}})},{root:it});U.forEach(t=>{e.observe(t)})}const at=Array.from(document.getElementsByClassName("bnpl-providers")),dt=document.getElementById("bnpl-modal");at?.forEach(e=>{e.addEventListener("click",()=>{f("bnpl-modal","false"),dt.showModal()})});const ct=document.getElementById("size-guide"),lt=document.getElementById("size-guide-modal");ct?.addEventListener("click",()=>{window.Tracker.handlers.sizeGuideClick(),f("size-guide-modal","false"),lt.showModal(),window.Tracker.handlers.sizeGuideModalOpen()});let ne=De([]);typeof localStorage<"u"&&(ne=De(localStorage.getItem("recentlyViewed")!==null?JSON.parse(localStorage.getItem("recentlyViewed")):[]));const ut=Je(ne,"addToRecentlyViewed",(e,t)=>{if(!t?.sku||!t?.image||!t?.title)return;let o=e.get();o.findIndex(s=>s.sku===t.sku)===-1&&(o.length<5?e.set([...o,{sku:t.sku,image:t.image,title:t.title,brand:t?.brand||null,price:t?.price,vipPrice:t?.vipPrice,url:t?.url,ppu:t?.ppu}]):(o.shift(),e.set([...o,{sku:t.sku,image:t.image,title:t.title,brand:t?.brand||null,price:t?.price,vipPrice:t?.vipPrice,url:t?.url,ppu:t?.ppu}]))),localStorage.setItem("recentlyViewed",JSON.stringify(e.get()))});function ht(e){return ne.get().filter(o=>o.sku!==e)}if(window.__RECENTLYVIEWED__){const e=window.__RECENTLYVIEWED__;delete window.__RECENTLYVIEWED__,ut(e);const t=ht(e.sku);class o extends HTMLElement{constructor(){if(super(),t.length){const s=fetch("/fragments/productRecentlyViewedFragment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:t})}).then(i=>i.text());Promise.all([s]).then(([i])=>{this.innerHTML=i}).catch(i=>{console.error(i)})}}}customElements.define("recently-viewed",o)}const{lang:I}=window,pt=window.tenantConfig?.application?.features?.reviews?.disableVotes,q=document.getElementById("reviews")?.dataset.sku,y=document.getElementById("reviews-modal"),A=new URLSearchParams(window.location.search),Te=["UPVOTE","DOWNVOTE","CREATE","REPORT"],R=Te.find(e=>{if(A.toString().includes(e))return e}),G=document.getElementById("review-wrapper");let N=!1;const Oe=document.getElementById("review-login"),Ie=document.getElementById("review-register");Be.subscribe(async e=>{N=e,N&&(Oe?.removeEventListener("click",K),Ie?.removeEventListener("click",K))});N||(Oe?.addEventListener("click",K),Ie?.addEventListener("click",K));if(R){let e;A.has("id")&&(e=A.get("id"));let t;A.has("variation")&&(t=A.get("variation")),Te.forEach(n=>{A.has(n)&&A.delete(n)});let o=`${window.location.origin}${window.location.pathname}`;t&&(o+=`?variation=${t}`),window.history.pushState({},document.title,o),R=="UPVOTE"?Ae(e):R=="DOWNVOTE"?Pe(e):R=="REPORT"?Fe(e):R=="CREATE"&&(window.location.href=`/create-review/${q}`)}function mt(e){switch(e){case"SUCCESSFUL":return{type:"success",message:`${p(()=>I.altitude.reviews.customer.vote.successful)}`};case"INVALID_REVIEW_ID":return{type:"error",message:`${p(()=>I.altitude.reviews.customer.vote.error)}`};case"REVIEW_NOT_FOUND":return{type:"error",message:`${p(()=>I.altitude.reviews.customer.vote.error)}`};case"ALREADY_VOTED":return{type:"info",message:`${p(()=>I.altitude.reviews.customer.vote.duplicate)}`}}}async function Ae(e){qe(e,"UPVOTE")}async function Pe(e){qe(e,"DOWNVOTE")}async function Fe(e){if(N)try{let t=function(d){switch(d){case"SUCCESSFUL":return{type:"success",message:`${p(()=>I.altitude.reviews.customer.report.success)}`};case"INVALID_REVIEW_ID":return{type:"error",message:`${p(()=>I.altitude.reviews.customer.report.error)}`};case"REVIEW_NOT_FOUND":return{type:"error",message:`${p(()=>I.altitude.reviews.customer.report.error)}`};case"ALREADY_VOTED":return{type:"info",message:`${p(()=>I.altitude.reviews.customer.report.duplicate)}`}}};const n=document.querySelector(`[data-review='${e}']`)?.parentElement?.querySelector("[data-report]"),s=await F({operation:"ReportReview",variables:{sku:q,reviewId:e}});window.Tracker.handlers.reviewReported({id:e});const i=s.data.reportReview,r=t(i);Ve(e,r)}catch(t){console.error(t)}else f("reviews-modal","false"),y?.showModal(),y?.setAttribute("data-action","REPORT"),y?.setAttribute("data-reviewId",e)}async function qe(e,t){if(N)try{const o=await F({operation:t==="UPVOTE"?"VoteReviewPositive":"VoteReviewNegative",variables:{sku:q,reviewId:e}}),n=t==="UPVOTE"?o?.data?.voteReviewPositive:o?.data?.voteReviewNegative,s=mt(n);t==="UPVOTE"?window.Tracker.handlers.reviewVoted({voted:"yes",id:e}):window.Tracker.handlers.reviewVoted({voted:"no",id:e}),Ve(e,s)}catch(o){console.error(o)}else f("reviews-modal","false"),y?.showModal(),y?.setAttribute("data-action",t),y?.setAttribute("data-reviewId",e)}function Ve(e,t){const o=document.querySelector(`[data-review='${e}']`)?.parentElement,n=o?.querySelector("[data-report]"),s=fetch("/fragments/alertFragment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fragmentData:t})}).then(i=>i.text());Promise.all([s]).then(([i])=>{const r=o?.querySelector("[data-reviewMessage]");if(r)r.innerHTML=i;else{const d=document.createElement("div");d.setAttribute("data-reviewMessage",""),d.innerHTML=i,o.insertBefore(d,n)}}).catch(i=>{console.error(i)})}function K(e){const t=e.target.getAttribute("id")==="review-login"?"login":"register",o=y?.dataset.action;let n;if(o!=="CREATE"){n=y?.dataset?.reviewid;const s=encodeURIComponent(`${window.location.href}/?reviewAction=${o}&id=${n}`);window.location.href=`/account/${t}/?returnTo=${s}`}else{const s=encodeURIComponent(`${window.location.origin}/create-review/${q}/?reviewAction=${o}`);window.location.href=`/account/${t}/?returnTo=${s}`}}const wt=new URLSearchParams(window.location.search);let P=wt.get("pageNumber")??1;const Me=10;function oe(){let e=document.querySelector(".next-page-button"),t=document.querySelector(".pre-page-button");e?.addEventListener("click",ft),t?.addEventListener("click",vt)}oe();function ft(e){window.Tracker.handlers.reviewPage("next"),e.preventDefault();let t;e.target.dataset.hasmore=="true"&&(t=fetch(`/fragments/reviewPagination?pageNumber=${P+1}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sku:q,offset:P*Me})}).then(o=>o.text()),Promise.all([t]).then(([o])=>{P+=1,G.innerHTML=o,G.scrollIntoView({behavior:"instant"}),oe()}).catch(o=>{console.error(o)}))}function vt(e){window.Tracker.handlers.reviewPage("previous"),e.preventDefault(),P-=1;const t=fetch(`/fragments/reviewPagination?pageNumber=${P}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sku:q,offset:P-1<0?0:(P-1)*Me})}).then(o=>o.text());Promise.all([t]).then(([o])=>{G.innerHTML=o,G.scrollIntoView({behavior:"instant"}),oe()}).catch(o=>{console.error(o)})}const St=document.getElementById("create-review");St?.addEventListener("click",gt);function gt(){N?window.location.href=`/create-review/${q}`:(f("reviews-modal","false"),y?.showModal(),y?.setAttribute("data-action","CREATE"))}if(!pt){class e extends HTMLElement{constructor(){super();const o=this.querySelector("[data-review]").dataset.review,n=this.querySelector("[data-upvote]"),s=this.querySelector("[data-downvote]");this.querySelector("[data-report]")?.addEventListener("click",()=>Fe(o)),n?.addEventListener("click",()=>Ae(o)),s?.addEventListener("click",()=>Pe(o))}}customElements.define("review-vote",e)}const bt=(e=[])=>e.reduce((t,o)=>(parseFloat(t)+parseFloat(o)).toFixed(2)),yt=(e,t)=>e,Et=(e,t,o)=>{const n=yt(t);switch(n){case"€":return e.replace(".",",")+" "+n;case"AED":return Math.round(e)+" "+n;default:return n+e}},Lt={AED:"د.إ",AFN:"؋",ALL:"L",AMD:"֏",ANG:"ƒ",AOA:"Kz",ARS:"$",AUD:"$",AWG:"ƒ",AZN:"₼",BAM:"KM",BBD:"$",BDT:"৳",BGN:"лв",BHD:".د.ب",BIF:"FBu",BMD:"$",BND:"$",BOB:"$b",BOV:"BOV",BRL:"R$",BSD:"$",BTC:"₿",BTN:"Nu.",BWP:"P",BYN:"Br",BYR:"Br",BZD:"BZ$",CAD:"$",CDF:"FC",CHE:"CHE",CHF:"CHF",CHW:"CHW",CLF:"CLF",CLP:"$",CNY:"¥",COP:"$",COU:"COU",CRC:"₡",CUC:"$",CUP:"₱",CVE:"$",CZK:"Kč",DJF:"Fdj",DKK:"kr",DOP:"RD$",DZD:"دج",EEK:"kr",EGP:"£",ERN:"Nfk",ETB:"Br",ETH:"Ξ",EUR:"€",FJD:"$",FKP:"£",GBP:"£",GEL:"₾",GGP:"£",GHC:"₵",GHS:"GH₵",GIP:"£",GMD:"D",GNF:"FG",GTQ:"Q",GYD:"$",HKD:"$",HNL:"L",HRK:"kn",HTG:"G",HUF:"Ft",IDR:"Rp",ILS:"₪",IMP:"£",INR:"₹",IQD:"ع.د",IRR:"﷼",ISK:"kr",JEP:"£",JMD:"J$",JOD:"JD",JPY:"¥",KES:"KSh",KGS:"лв",KHR:"៛",KMF:"CF",KPW:"₩",KRW:"₩",KWD:"KD",KYD:"$",KZT:"₸",LAK:"₭",LBP:"£",LKR:"₨",LRD:"$",LSL:"M",LTC:"Ł",LTL:"Lt",LVL:"Ls",LYD:"LD",MAD:"MAD",MDL:"lei",MGA:"Ar",MKD:"ден",MMK:"K",MNT:"₮",MOP:"MOP$",MRO:"UM",MRU:"UM",MUR:"₨",MVR:"Rf",MWK:"MK",MXN:"$",MXV:"MXV",MYR:"RM",MZN:"MT",NAD:"$",NGN:"₦",NIO:"C$",NOK:"kr",NPR:"₨",NZD:"$",OMR:"﷼",PAB:"B/.",PEN:"S/.",PGK:"K",PHP:"₱",PKR:"₨",PLN:"zł",PYG:"Gs",QAR:"﷼",RMB:"￥",RON:"lei",RSD:"Дин.",RUB:"₽",RWF:"R₣",SAR:"﷼",SBD:"$",SCR:"₨",SDG:"ج.س.",SEK:"kr",SGD:"S$",SHP:"£",SLL:"Le",SOS:"S",SRD:"$",SSP:"£",STD:"Db",STN:"Db",SVC:"$",SYP:"£",SZL:"E",THB:"฿",TJS:"SM",TMT:"T",TND:"د.ت",TOP:"T$",TRL:"₤",TRY:"₺",TTD:"TT$",TVD:"$",TWD:"NT$",TZS:"TSh",UAH:"₴",UGX:"USh",USD:"$",UYI:"UYI",UYU:"$U",UYW:"UYW",UZS:"лв",VEF:"Bs",VES:"Bs.S",VND:"₫",VUV:"VT",WST:"WS$",XAF:"FCFA",XBT:"Ƀ",XCD:"$",XOF:"CFA",XPF:"₣",XSU:"Sucre",XUA:"XUA",YER:"﷼",ZAR:"R",ZMW:"ZK",ZWD:"Z$",ZWL:"$"},kt={currencies:Lt};class Bt extends HTMLElement{recommendedProduct_=window.__RECOMMENDATIONS__;isMainProduct_=this.dataset.wrapperId==="main-product-wrapper";wrapperContainer=document.querySelector(`#${this.dataset.wrapperId}`);addBothToBasketAnchor=document.querySelector("#fbt-atb-anchor");basketPriceElement=document.querySelector("#basket-price");recommendedOptions=this.querySelector("#recommended-options");variantOption=this.querySelectorAll("#variant-option");selectedVariant=this.querySelector("#selected-variant");optionsDropdown=this.querySelector("#options-dropdown");dropdownArrow=this.recommendedOptions?.querySelector("svg");addBothToBasketButtonElement=this.addBothToBasketAnchor.querySelector("#add-both-to-basket");productTitle=this.wrapperContainer.querySelector(".fbt-product-title");priceContainer=this.wrapperContainer.querySelector(".price-container");currencySymbol=kt.currencies[window.siteObj?.currency];constructor(){super(),this.isMainProduct_&&(this.recommendedProduct_={variants:window.__VARIATIONS__}),this.handleDropdownAction=this.handleDropdownAction.bind(this),this.handleWindowCloseDropdown=this.handleWindowCloseDropdown.bind(this),this.handleChooseOption=this.handleChooseOption.bind(this),this.recommendedOptions&&this.recommendedOptions.addEventListener("click",this.handleDropdownAction),this.variantOption.forEach(t=>{t.dataset.sku===this.selectedVariant.dataset.defaultSelectedSku&&(t.classList.add("active-option"),t.querySelector("svg").classList.remove("hidden")),t.addEventListener("click",this.handleChooseOption),t.addEventListener("keydown",o=>{o.key==="Enter"&&this.handleChooseOption(o)})})}handleDropdownAction(){return new Set(this.optionsDropdown.classList).has("block")?(this.dropdownArrow.classList.remove("rotate-180"),this.optionsDropdown.classList.replace("block","hidden")):(window.addEventListener("click",this.handleWindowCloseDropdown),this.dropdownArrow.classList.add("rotate-180"),this.optionsDropdown.classList.replace("hidden","block"))}handleWindowCloseDropdown(t){if(t.target!==this.recommendedOptions)return this.dropdownArrow.classList.remove("rotate-180"),this.optionsDropdown.classList.replace("block","hidden"),window.removeEventListener("click",this.handleWindowCloseDropdown)}handleChooseOption(t){const o=this.wrapperContainer.querySelector("figure"),n=this.addBothToBasketButtonElement.hasAttribute("data-main-product-in-stock"),s=this.addBothToBasketButtonElement.hasAttribute("data-recommended-product-in-stock"),i=this.addBothToBasketButtonElement.hasAttribute("disabled"),r=this.optionsDropdown.querySelector(".active-option"),d=t.target.dataset.sku,c=t.target.dataset.variantName,l=this.recommendedProduct_.variants.find(w=>w.sku.toString()===d),C={mainSku:this.addBothToBasketButtonElement?.dataset?.mainProductSku,recommendedSku:this.addBothToBasketButtonElement?.dataset?.recommendedProductSku};this.isMainProduct_?(C.mainSku=d,this.basketPriceElement.setAttribute("data-selected-product-amount",l?.price?.price?.amount),this.addBothToBasketButtonElement.setAttribute("data-main-product-sku",d),this.addBothToBasketButtonElement.setAttribute("data-main-product-in-stock",l?.inStock)):(C.recommendedSku=d,this.basketPriceElement.setAttribute("data-recommended-product-amount",l?.price?.price?.amount),this.addBothToBasketButtonElement.setAttribute("data-recommended-product-sku",d),this.addBothToBasketButtonElement.setAttribute("data-recommended-product-in-stock",l?.inStock)),this.optionsDropdown.classList.replace("block","hidden"),this.dropdownArrow.classList.remove("rotate-180"),r&&(r.classList.remove("active-option"),r.querySelector("svg")?.classList?.add("hidden"),r.setAttribute("aria-selected","false")),i&&n&&s&&(this.addBothToBasketButtonElement.removeAttribute("disabled"),this.addBothToBasketButtonElement.classList.add("hover:underline","hover:bg-[#4C4C4C]","bg-black")),t.target.classList.add("active-option"),t.target.querySelector("svg")?.classList?.remove("hidden"),t.target.setAttribute("aria-selected","true"),this.addBothToBasketButtonElement.setAttribute("data-skus",JSON.stringify([C.mainSku,C.recommendedSku])),this.addBothToBasketAnchor.setAttribute("href",`/basket?buylist=${C.mainSku},${C.recommendedSku}&rctxt=fbt`);const ce=fetch("/fragments/productPriceFragment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({price:l.price,customFont:"text-base mt-1 font-bold",customDiscountFont:"text-red-900 text-base font-bold"})}).then(w=>w.text()),Re=fetch("/fragments/fbtProductVariantImageFragment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({src:l?.product?.images[0]?.original,title:l?.title})}).then(w=>w.text());Promise.resolve(Re).then(w=>{const We=new DOMParser,{body:{firstElementChild:$e}}=We.parseFromString(w,"text/html");o.replaceWith($e)}).catch(w=>{console.error(w)}),Promise.resolve(ce).then(w=>this.priceContainer.innerHTML=w).catch(w=>{console.error(w)}),this.selectedVariant.textContent=c,this.productTitle.textContent=l?.title,this.basketPriceElement.textContent=`${Et(bt([this.basketPriceElement.dataset.selectedProductAmount,this.basketPriceElement.dataset.recommendedProductAmount]),this.currencySymbol)}`}}customElements.define("fbt-dropdown-wrapper",Bt);const Y=document.getElementById("selection-view"),W=document.getElementById("confirmation-view"),se=document.getElementById("meet-your-match"),ge=window.__REACTIVEFOUNDATIONDATA__?.foundationTargetSku,Dt=window.__REACTIVEFOUNDATIONDATA__?.targetSkuMasterTitle;delete window.__REACTIVEFOUNDATIONDATA__;let k=null;async function Ct(){if(!k)return;const e=await F({operation:"FoundationMatchSingleProduct",variables:{sourceFoundationId:k.foundationId,targetSku:ge}});window?.Tracker?.handlers?.foundationFinderShadeMatch(ge,k.foundationId);const o=window.__VARIATIONS__.find(n=>n.sku===e.data?.foundationMatchSingleProduct?.id);window.sharedFunctions.fetchFragment("/fragments/finderConfirmationFragment",W,{type:"foundationFinder",selectionData:{brand:k.brand,product:k.product,shade:k.shade},matchData:e,matchedVariant:{image:o?.images?.[0]?.largeProduct,title:Dt,subscriptionContracts:o?.subscriptionContracts,inStock:o?.inStock,sku:o?.sku,colour:o?.choices?.[0]?.colour}}).then(()=>{Y?.classList.remove("block"),Y?.classList.add("hidden"),W?.classList.remove("hidden"),W?.classList.add("block");const n=document.getElementById("edit-foundation-finder-selection"),s=document.getElementById("continue-shopping-pdp");document.querySelector("#foundation-finder-modal-wrapper button[id=add-to-basket]")?.addEventListener("click",()=>{window?.Tracker?.handlers?.foundationFinderShadeAddToBasket(o?.sku,k.foundationId,"foundation")}),n?.addEventListener("click",()=>{window.resetFoundationSelection(),Tt()}),s?.addEventListener("click",()=>{f("foundation-finder-modal","true"),document.getElementById("foundation-finder-modal").close()})})}function Tt(){W?.classList.remove("block"),W?.classList.add("hidden"),Y?.classList.remove("hidden"),Y?.classList.add("block")}document.addEventListener("shadeSelected",e=>{k=e.detail,se.disabled=!1});document.addEventListener("incompleteSelection",e=>{k=null,se.disabled=!0});se?.addEventListener("click",async()=>{await Ct()});const Z=document.getElementById("concealer-selection-view"),$=document.getElementById("concealer-confirmation-view"),ie=document.getElementById("concealer-meet-your-match"),be=window.__REACTIVECONCEALERDATA__?.concealerTargetSku,Ot=window.__REACTIVECONCEALERDATA__?.targetSkuMasterTitle;delete window.__REACTIVECONCEALERDATA__;let v=null;async function It(){if(!v)return;const e=await F({operation:"FoundationMatchSingleProductLighterDarker",variables:{sourceFoundationId:v.foundationId,targetSku:be}});window?.Tracker?.handlers?.foundationFinderShadeMatch(be,v.foundationId);const t=window.__VARIATIONS__,o=r("exact"),n=r("lighter"),s=r("darker");window.sharedFunctions.fetchFragment("/fragments/finderConfirmationFragment",$,{type:"concealerFinder",selectionData:{brand:v.brand,product:v.product,shade:v.shade},matchData:e,matchedVariant:d(o),lighterVariant:d(n),darkerVariant:d(s)}).then(()=>{Z?.classList.remove("block"),Z?.classList.add("hidden"),$?.classList.remove("hidden"),$?.classList.add("block");const c=document.getElementById("edit-foundation-finder-selection"),l=document.getElementById("continue-shopping-pdp");c?.addEventListener("click",()=>{window.resetConcealerSelection(),At()}),i("exact",o?.sku,v),i("lighter",n?.sku,v),i("darker",s?.sku,v),l?.addEventListener("click",()=>{f("concealer-finder-modal","true"),document.getElementById("concealer-finder-modal").close()})});function i(c,l,C){document.querySelector(`#ff-${c} button[id=add-to-basket]`)?.addEventListener("click",()=>{window?.Tracker?.handlers?.foundationFinderShadeAddToBasket(l,C.foundationId,"concealer-"+c)})}function r(c){return t.find(l=>l.sku==e.data?.foundationMatchSingleProductLighterDarker?.[c]?.id)}function d(c){return c?{image:c?.images?.[0]?.largeProduct,title:Ot,subscriptionContracts:c?.subscriptionContracts,inStock:c?.inStock,sku:c?.sku,colour:c?.choices?.[0]?.colour}:null}}function At(){$?.classList.remove("block"),$?.classList.add("hidden"),Z?.classList.remove("hidden"),Z?.classList.add("block")}document.addEventListener("concealerShadeSelected",e=>{v=e.detail,ie.disabled=!1});document.addEventListener("concealerIncompleteSelection",e=>{v=null,ie.disabled=!0});ie?.addEventListener("click",async()=>{await It()});const h=document.getElementById("wishlist"),Pt=document.querySelector(".itemListCarousel"),V=h?.firstElementChild,Ft=h,z=h?.parentElement?.dataset.master,qt=h?.parentElement?.dataset?.pageskus?.split(",");let H=window.__VARIATIONS__,re=!1;Be.subscribe(async e=>{re=e});let S=h?.dataset.sku;async function ye(){const e=document.getElementById("add-to-basket")?.dataset?.variantselected,t=await F({operation:"WishlistProducts",variables:{skus:[...qt]}});window.__WISHLISTPRODUCTS__=t.data.products;let o=e=="false"?window.__WISHLISTPRODUCTS__.find(i=>Number(i.sku)===Number(z)):window.__WISHLISTPRODUCTS__.find(i=>Number(i.sku)===Number(z))?.variants?.find(i=>Number(i.sku)===Number(S));const n=Pt?.querySelector(`[data-currentsku="${o?.sku}"]`),s=e=="false"?z:S;Number(o?.sku)!==Number(s)&&(o=H.find(i=>Number(i.sku)===Number(s))),o.inWishlist?(h.dataset.wishlist="true",V.classList.add("inWishlist"),h?.classList.add("border-black"),n&&(n?.firstElementChild?.classList.add("inWishlist"),n?.classList.add("border-black"))):(h.dataset.wishlist="false",V.classList.remove("inWishlist"),h?.classList.remove("border-black"),n&&(n?.firstElementChild?.classList.remove("inWishlist"),n?.classList.remove("border-black")))}h?.addEventListener("click",Vt);async function Vt(e){const t=e.target.dataset.wishlist==="true",o=document.getElementById("wishlist-login"),n=h?.parentElement?.dataset.master;if(S=document.getElementById("add-to-basket")?.dataset?.variantselected=="false"?n:S,!re){window.Tracker.handlers.wishlistLoggedout(S),f("wishlist-login","false");const i=document.getElementById("wishlist-login-modal-content"),r=fetch("/fragments/wishlistLoginModalFragment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(window.__wishlistModalData__)}).then(d=>d.text());Promise.all([r]).then(([d])=>{i&&(i.innerHTML=d,o?.showModal())}).catch(d=>{console.error(d)});return}if(t){const i=await F({operation:"RemoveProductFromWishlist",variables:{sku:S}});window.Tracker.handlers.wishlistRemove(S),i.data.removeProductFromWishlist&&await ye()}else{const i=await F({operation:"AddProductToWishlist",variables:{sku:S}});window.Tracker.handlers.wishlistAdded(S),i.data.addProductToWishlist&&await ye()}}class Mt extends HTMLElement{constructor(){super(),new MutationObserver(function(o){o.forEach(function(n){if(n.type==="attributes"&&n.attributeName=="data-sku"){S=n?.target?.dataset?.sku;let s;const i=document.getElementById("add-to-basket")?.dataset?.variantselected,r=h?.parentElement?.dataset.master,d=i=="false"?r:S;re?(H=window.__WISHLISTPRODUCTS__,s=H?.find(l=>Number(l.sku)===Number(r))?.variants?.find(l=>Number(l.sku)===Number(d))):s=H?.find(c=>Number(c?.sku)==Number(d)),Nt(s)}else return})}).observe(Ft,{attributes:!0})}}customElements.define("product-wishlist",Mt);function Nt(e){if(h.dataset.wishlist=e?.inWishlist?"true":"false",!e?.eligibleForWishlist)h?.classList.add("hidden");else if(h?.classList.remove("hidden"),e?.inWishlist)if(!V.classList.contains("inWishlist"))V.classList.add("inWishlist"),h?.classList.add("border-black");else return;else V.classList.contains("inWishlist")&&(V.classList.remove("inWishlist"),h?.classList.remove("border-black"))}const{lang:B}=window,_t=/^\+1[0-9 ()]+$/,a=document.getElementById("giftcardform"),g=a?.querySelector("#email-text"),u=a?.querySelector("#email-confirm-text"),x=a?.querySelector("#phone-number"),Rt=a?.querySelector("#phone"),Wt=a?.querySelector('input[value="email"]'),T=a?.querySelector("#phone-number"),$t=a?.querySelectorAll(".variantinput"),xt=a?.querySelectorAll(".template-input"),X=a?.querySelector("#message"),Ee=a?.querySelector("#message-char-count"),Ut=jt(),_=a?.querySelector("#date-now"),ae=a?.querySelector("#date-radio"),m=a?.querySelector("#date"),Q=a?.querySelector("#date-error"),M=a?.querySelector("#email-error"),O=a?.querySelector("#phone-error"),ee=a?.querySelector("#basketlimit-error"),b=a?.querySelector("#submission-error"),Ne=a?.dataset.supportedcurrency,Ht=window.siteObj.currency,Gt=Number(a?.dataset.basketlimit),Kt=a?.dataset.basketlimitdisplayvalue;let te=Ne===Ht,Le=null,E=0;const Yt=window.tenantConfig?.application?.features?.productPage?.giftCards?.enableTimePicker,J=a?.querySelector('button[type="submit"]'),D=Zt(e=>{if(J){const t=Qt(Gt,e),o=en()&&te&&t;J.disabled=!o,te&&b.classList.add("hidden"),t&&ee.classList.add("hidden")}},50);function Zt(e,t){let o;return(...n)=>{clearTimeout(o),o=setTimeout(()=>{e(...n)},t)}}function Jt(){const e=a?.querySelector(".template-input"),t=e?.parentElement?.querySelector("img");e&&(e.checked=!0,t?.classList.add("outline","p-1","outline-2","outline-solid"));const o=a?.querySelector(".variantinput"),n=o?.parentElement?.querySelector(".btn");o&&(o.checked=!0,n?.classList.add("outline","outline-2")),D(E)}function jt(){const e=new Date;return{value:e.toISOString().split("T")[0],display:e.toLocaleDateString(void 0,{weekday:"short",day:"numeric",month:"short"})}}function zt(){const e=[],t=a.querySelector('input[name="image"]:checked');t&&e.push({name:"template",value:t.value}),["recipientName","senderName","message"].forEach(i=>{const r=a.querySelector(`#${i}`);r?.value&&e.push({name:i,value:r.value})});const n=a.querySelector('input[name="deliverymethod"]:checked');if(n){if(n.value==="email"){const i=a.querySelector("#email-text");i?.value&&e.push({name:"email",value:i.value})}else if(n.value==="phone"){const i=a.querySelector("#phone-number");i?.value&&e.push({name:"phoneNumber",value:i.value})}}const s=a.querySelector("#date");if(s?.value){let i;Yt?i=new Date(s.value):i=new Date(s.value+" 10:00");const r=i.toISOString().replace(/\d{1,3}Z$/,"000000Z");e.push({name:"date",value:r})}return e}async function Xt(){const e=zt();try{!await Ye({sku:document.querySelector(".variantinput:checked")?.value,quantity:1,personalisationValues:{fieldSubmissionList:e}})&&b&&(b.textContent=p(()=>B.altitude.giftcards.errors.submissionerror),b.classList.remove("hidden"))}catch(t){console.error(t.message),b&&(b.textContent=p(()=>B.altitude.giftcards.errors.submissionerror),b.classList.remove("hidden"))}}Ke?.subscribe(e=>{Le=e,E=Le?.filter(t=>t.product?.isGiftCard).reduce((t,o)=>t+Number(o.chargedPrice||0),0),D(E)});J&&(J.disabled=!0);if(_){_.checked=!0;const e=new Date,t=m.type==="datetime-local"?e.toISOString().slice(0,16):e.toISOString().split("T")[0];m.value=t}!te&&b&&(b.textContent=p(()=>B.altitude.giftcards.errors.invalidcurrency,Ne),b.classList.remove("hidden"));Jt();const _e=e=>e?.value?e.value<Ut.value?(Q?.classList.remove("hidden"),Q.textContent=p(()=>B.altitude.giftcards.errors.date),e?.classList.add("border-red-600"),!1):(Q?.classList.add("hidden"),e?.classList.remove("border-red-600"),!0):!1,Qt=(e,t)=>{const o=a?.querySelector(".variantinput:checked");if(!o)return!0;const n=o.dataset?.price;return!n||!n||!e?!0:Number(t)+Number(n)>e?(ee.textContent=p(()=>B.altitude.giftcards.errors.basketlimit,Kt),ee.classList.remove("hidden"),!1):!0},j=(e,t)=>{if(!e?.required)return!0;if(!e?.value||!t?.value)return!1;const o=g?.value===u?.value;return M&&(o?(M.classList.add("hidden"),u?.classList.remove("border-red-600"),u?.setAttribute("aria-invalid","false")):(M.textContent=p(()=>B.altitude.giftcards.errors.emails),M.classList.remove("hidden"),u?.classList.add("border-red-600"),u?.setAttribute("aria-invalid","true"))),o},de=e=>e?e.startsWith("+1")?_t.test(e)?{valid:!0,message:""}:{valid:!1,message:p(()=>B.altitude.giftcards.errors.phone.contain)}:{valid:!1,message:p(()=>B.altitude.giftcards.errors.phone.startwith)}:{valid:!1,message:p(()=>B.altitude.giftcards.errors.phone.required)},en=()=>{if(!a?.querySelector('input[name="image"]:checked')||!a?.querySelector(".variantinput:checked")||Array.from(a?.querySelectorAll('input[required][type="text"]')||[]).some(s=>!s.value))return!1;const n=a?.querySelector('input[name="deliverymethod"]:checked');return!(!n||n?.value==="email"&&!j(g,u)||n?.value==="phone"&&!de(x?.value).valid||!m?.value||!_e(m))};$t?.forEach(e=>{e.addEventListener("change",()=>{a?.querySelectorAll(".variantinput + .btn").forEach(t=>{t.classList.remove("outline","outline-2")}),e.checked&&e.parentElement?.querySelector(".btn")?.classList.add("outline","outline-2"),D(E)})});xt?.forEach(e=>{e.addEventListener("change",()=>{a.querySelectorAll(".template-input + img").forEach(t=>{t.classList.remove("outline","p-1","outline-2","outline-solid")}),e.checked&&e.parentElement?.querySelector("img")?.classList.add("outline","p-1","outline-2","outline-solid"),D(E)})});m?.addEventListener("change",()=>{m.value&&(ae.checked=!0,_.checked=!1,_e(m),D(E))});m?.addEventListener("click",()=>{ae.checked=!0,_.checked=!1});_?.addEventListener("change",()=>{if(_.checked){const e=new Date;m.type==="datetime-local"?m.value=e.toISOString().slice(0,16):m.value=e.toISOString().split("T")[0],m.setAttribute("value",m.value),ae.checked=!1}else m.value="",m.removeAttribute("value")});a?.addEventListener("change",()=>D(E));a?.addEventListener("input",()=>D(E));g?.addEventListener("input",()=>{j(g,u)});u?.addEventListener("input",()=>{j(g,u)});Wt?.addEventListener("change",()=>{const e=document.getElementById("email-inputs"),t=document.getElementById("phone-input");e?.classList.remove("hidden"),e?.classList.add("block"),t?.classList.add("hidden"),t?.classList.remove("block"),x&&(x.required=!1),g&&(g.required=!0),u&&(u.required=!0,u.classList.remove("border-red-600"),M?.classList.add("hidden")),D(E)});T?.addEventListener("input",e=>{const t=de(e.target.value);t.valid?(O&&O.classList.add("hidden"),T.setAttribute("aria-invalid","false"),e.target.classList.remove("border-red-600")):(O&&(O.textContent=t.message),O?.classList.remove("hidden"),T.setAttribute("aria-invalid","true"),e.target.classList.add("border-red-600"))});Rt?.addEventListener("change",()=>{const e=document.getElementById("email-inputs"),t=document.getElementById("phone-input");e?.classList.add("hidden"),e?.classList.remove("block"),t?.classList.remove("hidden"),t?.classList.add("block"),g&&(g.required=!1),u&&(u.value="",u.required=!1,u.classList.remove("border-red-600"),M?.classList.add("hidden")),x&&(x.required=!0),D(E)});a?.addEventListener("submit",e=>{if(e.preventDefault(),g?.required&&!j(g,u)){u?.focus();return}const t=de(T?.value);if(T?.required&&!t.valid){O&&(O.textContent=t.message,O.classList.remove("hidden")),T.setAttribute("aria-invalid","true"),T.classList.add("border-red-600"),T.focus();return}Xt()});X?.addEventListener("input",()=>{Ee&&(Ee.textContent=`${X.value.length}/${X.maxLength}`)});const ke=document.getElementById("provenance-trust-badge-container");ke&&ke.addEventListener("click",e=>{const t=document.getElementById("provenanceAccordion");t?.ariaExpanded==="false"&&t.click()});
